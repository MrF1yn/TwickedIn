{"version":3,"file":"choropleth-DdBUe80H.mjs","sources":["../../../node_modules/lodash-es/_arrayReduce.js","../../../node_modules/lodash-es/_basePropertyOf.js","../../../node_modules/lodash-es/_deburrLetter.js","../../../node_modules/lodash-es/deburr.js","../../../node_modules/lodash-es/_asciiWords.js","../../../node_modules/lodash-es/_hasUnicodeWord.js","../../../node_modules/lodash-es/_unicodeWords.js","../../../node_modules/lodash-es/words.js","../../../node_modules/lodash-es/_createCompounder.js","../../../node_modules/lodash-es/_baseClamp.js","../../../node_modules/lodash-es/clamp.js","../../../node_modules/lodash-es/_baseDelay.js","../../../node_modules/lodash-es/delay.js","../../../node_modules/lodash-es/_baseMap.js","../../../node_modules/lodash-es/map.js","../../../node_modules/lodash-es/flatMapDeep.js","../../../node_modules/lodash-es/isEqual.js","../../../node_modules/lodash-es/kebabCase.js","../../../node_modules/lodash-es/_baseSome.js","../../../node_modules/lodash-es/some.js","../src/components/component.ts","../../../node_modules/dompurify/dist/purify.es.mjs","../src/utils/sanitizeHtml.ts","../src/components/axes/toolbar.ts","../src/components/layout/layout.ts","../src/components/layout/spacer.ts","../../../node_modules/carbon-components/es/globals/js/settings.js","../../../node_modules/carbon-components/es/globals/js/misc/mixin.js","../../../node_modules/carbon-components/es/globals/js/mixins/create-component.js","../../../node_modules/carbon-components/es/globals/js/mixins/handles.js","../../../node_modules/carbon-components/es/globals/js/misc/on.js","../../../node_modules/carbon-components/es/globals/js/mixins/evented-state.js","../../../node_modules/carbon-components/es/globals/js/misc/event-matches.js","../../../node_modules/carbon-components/es/globals/js/misc/get-launching-details.js","../../../node_modules/carbon-components/es/globals/js/mixins/evented-show-hide-state.js","../../../node_modules/warning/browser.js","../../../node_modules/carbon-components/es/globals/js/mixins/init-component-by-launcher.js","../../../node_modules/carbon-components/es/components/modal/modal.js","../src/components/essentials/modal.ts","../src/components/essentials/title.ts","../src/components/essentials/legend.ts","../src/components/axes/chart-clip.ts","../src/components/essentials/canvas-chart-clip.ts","../../../node_modules/@carbon/utils-position/index.js","../src/components/essentials/tooltip.ts","../src/components/axes/grid-brush.ts","../src/components/axes/zoom-bar.ts","../src/components/essentials/threshold.ts","../src/components/essentials/highlights.ts","../src/components/essentials/tooltip-axis.ts","../src/components/graphs/alluvial.ts","../src/components/axes/grid.ts","../src/components/graphs/area.ts","../src/components/graphs/line.ts","../src/components/axes/ruler.ts","../src/components/graphs/scatter.ts","../src/components/axes/axis.ts","../src/components/axes/hover-axis.ts","../src/components/axes/two-dimensional-axes.ts","../src/components/graphs/skeleton.ts","../src/components/graphs/boxplot.ts","../src/components/axes/zero-line.ts","../src/components/graphs/bubble.ts","../src/components/graphs/bullet.ts","../../../node_modules/topojson-client/src/identity.js","../../../node_modules/topojson-client/src/transform.js","../../../node_modules/topojson-client/src/reverse.js","../../../node_modules/topojson-client/src/feature.js","../../../node_modules/topojson-client/src/stitch.js","../../../node_modules/topojson-client/src/merge.js","../src/components/axes/ruler-binned.ts","../src/components/axes/ruler-stacked.ts","../src/components/diagrams/buildPaths.ts","../src/components/diagrams/markerDefinitions.ts","../src/components/essentials/color-scale-legend.ts","../src/components/essentials/title-meter.ts","../src/components/graphs/bar.ts","../src/components/graphs/circle-pack.ts","../src/components/graphs/pie.ts","../src/components/graphs/donut.ts","../src/components/graphs/gauge.ts","../src/components/graphs/bar-grouped.ts","../src/components/graphs/heatmap.ts","../src/components/graphs/histogram.ts","../src/components/graphs/lollipop.ts","../src/components/graphs/meter.ts","../src/components/graphs/radar.ts","../src/components/graphs/bar-simple.ts","../src/components/graphs/skeleton-lines.ts","../src/components/graphs/area-stacked.ts","../src/components/graphs/bar-stacked.ts","../src/components/graphs/scatter-stacked.ts","../src/components/graphs/tree.ts","../../../node_modules/@carbon/colors/es/index.js","../src/components/graphs/treemap.ts","../src/components/graphs/wordcloud.ts","../src/components/essentials/geo-projection.ts","../src/components/graphs/choropleth.ts"],"sourcesContent":["/**\n * A specialized version of `_.reduce` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {*} [accumulator] The initial value.\n * @param {boolean} [initAccum] Specify using the first element of `array` as\n *  the initial value.\n * @returns {*} Returns the accumulated value.\n */\nfunction arrayReduce(array, iteratee, accumulator, initAccum) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  if (initAccum && length) {\n    accumulator = array[++index];\n  }\n  while (++index < length) {\n    accumulator = iteratee(accumulator, array[index], index, array);\n  }\n  return accumulator;\n}\n\nexport default arrayReduce;\n","/**\n * The base implementation of `_.propertyOf` without support for deep paths.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyOf(object) {\n  return function(key) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default basePropertyOf;\n","import basePropertyOf from './_basePropertyOf.js';\n\n/** Used to map Latin Unicode letters to basic Latin letters. */\nvar deburredLetters = {\n  // Latin-1 Supplement block.\n  '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n  '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n  '\\xc7': 'C',  '\\xe7': 'c',\n  '\\xd0': 'D',  '\\xf0': 'd',\n  '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n  '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n  '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n  '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n  '\\xd1': 'N',  '\\xf1': 'n',\n  '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n  '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n  '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n  '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n  '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n  '\\xc6': 'Ae', '\\xe6': 'ae',\n  '\\xde': 'Th', '\\xfe': 'th',\n  '\\xdf': 'ss',\n  // Latin Extended-A block.\n  '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n  '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n  '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n  '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n  '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n  '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n  '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n  '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n  '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n  '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n  '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n  '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n  '\\u0134': 'J',  '\\u0135': 'j',\n  '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n  '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n  '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n  '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n  '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n  '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n  '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n  '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n  '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n  '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n  '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n  '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n  '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n  '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n  '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n  '\\u0174': 'W',  '\\u0175': 'w',\n  '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n  '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n  '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n  '\\u0132': 'IJ', '\\u0133': 'ij',\n  '\\u0152': 'Oe', '\\u0153': 'oe',\n  '\\u0149': \"'n\", '\\u017f': 's'\n};\n\n/**\n * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n * letters to basic Latin letters.\n *\n * @private\n * @param {string} letter The matched letter to deburr.\n * @returns {string} Returns the deburred letter.\n */\nvar deburrLetter = basePropertyOf(deburredLetters);\n\nexport default deburrLetter;\n","import deburrLetter from './_deburrLetter.js';\nimport toString from './toString.js';\n\n/** Used to match Latin Unicode letters (excluding mathematical operators). */\nvar reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n/** Used to compose unicode character classes. */\nvar rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange;\n\n/** Used to compose unicode capture groups. */\nvar rsCombo = '[' + rsComboRange + ']';\n\n/**\n * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n */\nvar reComboMark = RegExp(rsCombo, 'g');\n\n/**\n * Deburrs `string` by converting\n * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n * letters to basic Latin letters and removing\n * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to deburr.\n * @returns {string} Returns the deburred string.\n * @example\n *\n * _.deburr('déjà vu');\n * // => 'deja vu'\n */\nfunction deburr(string) {\n  string = toString(string);\n  return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n}\n\nexport default deburr;\n","/** Used to match words composed of alphanumeric characters. */\nvar reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n/**\n * Splits an ASCII `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction asciiWords(string) {\n  return string.match(reAsciiWord) || [];\n}\n\nexport default asciiWords;\n","/** Used to detect strings that need a more robust regexp to match words. */\nvar reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n/**\n * Checks if `string` contains a word composed of Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a word is found, else `false`.\n */\nfunction hasUnicodeWord(string) {\n  return reHasUnicodeWord.test(string);\n}\n\nexport default hasUnicodeWord;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsDingbatRange = '\\\\u2700-\\\\u27bf',\n    rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n    rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n    rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n    rsPunctuationRange = '\\\\u2000-\\\\u206f',\n    rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n    rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n    rsVarRange = '\\\\ufe0e\\\\ufe0f',\n    rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\",\n    rsBreak = '[' + rsBreakRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsDigits = '\\\\d+',\n    rsDingbat = '[' + rsDingbatRange + ']',\n    rsLower = '[' + rsLowerRange + ']',\n    rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsUpper = '[' + rsUpperRange + ']',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n    rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n    rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n    rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n    reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n    rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq;\n\n/** Used to match complex or compound words. */\nvar reUnicodeWord = RegExp([\n  rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n  rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n  rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n  rsUpper + '+' + rsOptContrUpper,\n  rsOrdUpper,\n  rsOrdLower,\n  rsDigits,\n  rsEmoji\n].join('|'), 'g');\n\n/**\n * Splits a Unicode `string` into an array of its words.\n *\n * @private\n * @param {string} The string to inspect.\n * @returns {Array} Returns the words of `string`.\n */\nfunction unicodeWords(string) {\n  return string.match(reUnicodeWord) || [];\n}\n\nexport default unicodeWords;\n","import asciiWords from './_asciiWords.js';\nimport hasUnicodeWord from './_hasUnicodeWord.js';\nimport toString from './toString.js';\nimport unicodeWords from './_unicodeWords.js';\n\n/**\n * Splits `string` into an array of its words.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to inspect.\n * @param {RegExp|string} [pattern] The pattern to match words.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Array} Returns the words of `string`.\n * @example\n *\n * _.words('fred, barney, & pebbles');\n * // => ['fred', 'barney', 'pebbles']\n *\n * _.words('fred, barney, & pebbles', /[^, ]+/g);\n * // => ['fred', 'barney', '&', 'pebbles']\n */\nfunction words(string, pattern, guard) {\n  string = toString(string);\n  pattern = guard ? undefined : pattern;\n\n  if (pattern === undefined) {\n    return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n  }\n  return string.match(pattern) || [];\n}\n\nexport default words;\n","import arrayReduce from './_arrayReduce.js';\nimport deburr from './deburr.js';\nimport words from './words.js';\n\n/** Used to compose unicode capture groups. */\nvar rsApos = \"['\\u2019]\";\n\n/** Used to match apostrophes. */\nvar reApos = RegExp(rsApos, 'g');\n\n/**\n * Creates a function like `_.camelCase`.\n *\n * @private\n * @param {Function} callback The function to combine each word.\n * @returns {Function} Returns the new compounder function.\n */\nfunction createCompounder(callback) {\n  return function(string) {\n    return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n  };\n}\n\nexport default createCompounder;\n","/**\n * The base implementation of `_.clamp` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n */\nfunction baseClamp(number, lower, upper) {\n  if (number === number) {\n    if (upper !== undefined) {\n      number = number <= upper ? number : upper;\n    }\n    if (lower !== undefined) {\n      number = number >= lower ? number : lower;\n    }\n  }\n  return number;\n}\n\nexport default baseClamp;\n","import baseClamp from './_baseClamp.js';\nimport toNumber from './toNumber.js';\n\n/**\n * Clamps `number` within the inclusive `lower` and `upper` bounds.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Number\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n * @example\n *\n * _.clamp(-10, -5, 5);\n * // => -5\n *\n * _.clamp(10, -5, 5);\n * // => 5\n */\nfunction clamp(number, lower, upper) {\n  if (upper === undefined) {\n    upper = lower;\n    lower = undefined;\n  }\n  if (upper !== undefined) {\n    upper = toNumber(upper);\n    upper = upper === upper ? upper : 0;\n  }\n  if (lower !== undefined) {\n    lower = toNumber(lower);\n    lower = lower === lower ? lower : 0;\n  }\n  return baseClamp(toNumber(number), lower, upper);\n}\n\nexport default clamp;\n","/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * The base implementation of `_.delay` and `_.defer` which accepts `args`\n * to provide to `func`.\n *\n * @private\n * @param {Function} func The function to delay.\n * @param {number} wait The number of milliseconds to delay invocation.\n * @param {Array} args The arguments to provide to `func`.\n * @returns {number|Object} Returns the timer id or timeout object.\n */\nfunction baseDelay(func, wait, args) {\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  return setTimeout(function() { func.apply(undefined, args); }, wait);\n}\n\nexport default baseDelay;\n","import baseDelay from './_baseDelay.js';\nimport baseRest from './_baseRest.js';\nimport toNumber from './toNumber.js';\n\n/**\n * Invokes `func` after `wait` milliseconds. Any additional arguments are\n * provided to `func` when it's invoked.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to delay.\n * @param {number} wait The number of milliseconds to delay invocation.\n * @param {...*} [args] The arguments to invoke `func` with.\n * @returns {number} Returns the timer id.\n * @example\n *\n * _.delay(function(text) {\n *   console.log(text);\n * }, 1000, 'later');\n * // => Logs 'later' after one second.\n */\nvar delay = baseRest(function(func, wait, args) {\n  return baseDelay(func, toNumber(wait) || 0, args);\n});\n\nexport default delay;\n","import baseEach from './_baseEach.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nexport default baseMap;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport isArray from './isArray.js';\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nexport default map;\n","import baseFlatten from './_baseFlatten.js';\nimport map from './map.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * This method is like `_.flatMap` except that it recursively flattens the\n * mapped results.\n *\n * @static\n * @memberOf _\n * @since 4.7.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * function duplicate(n) {\n *   return [[[n, n]]];\n * }\n *\n * _.flatMapDeep([1, 2], duplicate);\n * // => [1, 1, 2, 2]\n */\nfunction flatMapDeep(collection, iteratee) {\n  return baseFlatten(map(collection, iteratee), INFINITY);\n}\n\nexport default flatMapDeep;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","import createCompounder from './_createCompounder.js';\n\n/**\n * Converts `string` to\n * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the kebab cased string.\n * @example\n *\n * _.kebabCase('Foo Bar');\n * // => 'foo-bar'\n *\n * _.kebabCase('fooBar');\n * // => 'foo-bar'\n *\n * _.kebabCase('__FOO_BAR__');\n * // => 'foo-bar'\n */\nvar kebabCase = createCompounder(function(result, word, index) {\n  return result + (index ? '-' : '') + word.toLowerCase();\n});\n\nexport default kebabCase;\n","import baseEach from './_baseEach.js';\n\n/**\n * The base implementation of `_.some` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction baseSome(collection, predicate) {\n  var result;\n\n  baseEach(collection, function(value, index, collection) {\n    result = predicate(value, index, collection);\n    return !result;\n  });\n  return !!result;\n}\n\nexport default baseSome;\n","import arraySome from './_arraySome.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseSome from './_baseSome.js';\nimport isArray from './isArray.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Checks if `predicate` returns truthy for **any** element of `collection`.\n * Iteration is stopped once `predicate` returns truthy. The predicate is\n * invoked with three arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n * @example\n *\n * _.some([null, 0, 'yes', false], Boolean);\n * // => true\n *\n * var users = [\n *   { 'user': 'barney', 'active': true },\n *   { 'user': 'fred',   'active': false }\n * ];\n *\n * // The `_.matches` iteratee shorthand.\n * _.some(users, { 'user': 'barney', 'active': false });\n * // => false\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.some(users, ['active', false]);\n * // => true\n *\n * // The `_.property` iteratee shorthand.\n * _.some(users, 'active');\n * // => true\n */\nfunction some(collection, predicate, guard) {\n  var func = isArray(collection) ? arraySome : baseSome;\n  if (guard && isIterateeCall(collection, predicate, guard)) {\n    predicate = undefined;\n  }\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nexport default some;\n","import { select, type Selection as D3Selection } from 'd3'\nimport { merge } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { carbonPrefix } from '@/configuration-non-customizable' // CSS prefix\nimport type { ChartModel } from '@/model/model'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { RenderTypes } from '@/interfaces/enums'\nimport { Services } from '@/interfaces/services'\n\nexport class Component {\n\tpublic type = ''\n\tpublic renderType = RenderTypes.HTML\n\n\tpublic id = ''\n\n\tprotected parent:\n\t\t| D3Selection<SVGGraphicsElement | HTMLDivElement, any, HTMLElement, any>\n\t\t| undefined = undefined\n\n\tprotected configs: any = {}\n\n\tprotected model: ChartModel\n\tprotected services: Services\n\n\tconstructor(model: ChartModel, services: Services, configs?: any) {\n\t\tthis.model = model\n\t\tthis.services = services\n\n\t\tif (configs) {\n\t\t\tthis.configs = configs\n\t\t\tif (this.configs.id) {\n\t\t\t\tconst chartprefix = getProperty(this.model.getOptions(), 'style', 'prefix')\n\t\t\t\tthis.id = `${chartprefix}--${this.configs.id}`\n\t\t\t}\n\t\t}\n\n\t\t// Set parent element to shell SVG if no parent exists for component\n\t\tif (!this.parent) {\n\t\t\tthis.setParent(\n\t\t\t\tselect<SVGGraphicsElement | HTMLDivElement, any>(\n\t\t\t\t\tthis.services.domUtils.getMainContainer() as HTMLDivElement\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t}\n\n\tinit() {\n\t\t// do nothing.\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true): void {\n\t\tconsole.error('Error: Component did not provide the required render function.')\n\t}\n\n\tdestroy() {\n\t\t// do nothing.\n\t}\n\n\t// Used to pass down information to the components\n\tsetModel(newObj: any) {\n\t\tthis.model = newObj\n\t}\n\n\t// Used to pass down information to the components\n\tsetServices(newObj: any) {\n\t\tthis.services = newObj\n\t}\n\n\tsetParent(parent: any) {\n\t\tconst oldParent = this.parent\n\t\tthis.parent = parent\n\n\t\tif (oldParent && oldParent.node() === parent.node()) {\n\t\t\treturn\n\t\t}\n\n\t\tif (this.type) {\n\t\t\tconst chartprefix = getProperty(this.model.getOptions(), 'style', 'prefix')\n\t\t\tthis.parent?.classed(`${carbonPrefix}--${chartprefix}--${this.type}`, true)\n\n\t\t\tif (oldParent) {\n\t\t\t\toldParent.classed(`${carbonPrefix}--${chartprefix}--${this.type}`, false)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetParent() {\n\t\treturn this.parent\n\t}\n\n\tgetComponentContainer(configs = { withinChartClip: false }) {\n\t\tif (this.type) {\n\t\t\tconst chartprefix = getProperty(this.model.getOptions(), 'style', 'prefix')\n\n\t\t\tconst idSelector = this.id ? `#${this.id}` : ''\n\t\t\tconst container = DOMUtils.appendOrSelect(\n\t\t\t\tthis.parent,\n\t\t\t\t`${\n\t\t\t\t\tthis.renderType === RenderTypes.SVG ? 'svg' : 'div'\n\t\t\t\t}${idSelector}.${carbonPrefix}--${chartprefix}--${this.type}`\n\t\t\t)\n\n\t\t\tif (configs.withinChartClip) {\n\t\t\t\t// get unique chartClipId int this chart from model\n\t\t\t\tconst chartClipId = this.model.get('chartClipId')\n\n\t\t\t\tif (chartClipId) {\n\t\t\t\t\tconst chartClipSelection = select(`#${chartClipId}`)\n\t\t\t\t\tconst chartClipRectSelection = chartClipSelection.select('rect')\n\n\t\t\t\t\t/*\n\t\t\t\t\t * these checks are needed because of a chrome bug\n\t\t\t\t\t * related to the rendering of the clip path\n\t\t\t\t\t */\n\t\t\t\t\tif (\n\t\t\t\t\t\tchartClipRectSelection.size() !== 0 &&\n\t\t\t\t\t\tparseFloat(chartClipRectSelection.attr('height')) > 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontainer.attr('clip-path', `url(#${chartClipId})`)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn container.attr('width', '100%').attr('height', '100%')\n\t\t}\n\t\treturn this.parent\n\t}\n\n\t/**\n\t * graphs used in combo charts share a model with global options but can receive their own local options.\n\t * this function retrieves the global options and merges it with any options passed into this\n\t * component's config.options object.\n\t */\n\tgetOptions() {\n\t\tif (this.configs.options) {\n\t\t\tconst options = merge({}, this.model.getOptions(), this.configs.options)\n\t\t\treturn options\n\t\t}\n\t\treturn this.model.getOptions()\n\t}\n}\n","/*! @license DOMPurify 3.1.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.0/LICENSE */\n\nconst {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor\n} = Object;\nlet {\n  freeze,\n  seal,\n  create\n} = Object; // eslint-disable-line import/no-mutable-exports\nlet {\n  apply,\n  construct\n} = typeof Reflect !== 'undefined' && Reflect;\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\nif (!apply) {\n  apply = function apply(fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\nif (!construct) {\n  construct = function construct(Func, args) {\n    return new Func(...args);\n  };\n}\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\nconst regExpTest = unapply(RegExp.prototype.test);\nconst typeErrorCreate = unconstruct(TypeError);\n\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param {Function} func - The function to be wrapped and called.\n * @returns {Function} A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return function (thisArg) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return apply(func, thisArg, args);\n  };\n}\n\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param {Function} func - The constructor function to be wrapped and called.\n * @returns {Function} A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(func) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    return construct(func, args);\n  };\n}\n\n/**\n * Add properties to a lookup table\n *\n * @param {Object} set - The set to which elements will be added.\n * @param {Array} array - The array containing elements to be added to the set.\n * @param {Function} transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns {Object} The modified set with added elements.\n */\nfunction addToSet(set, array) {\n  let transformCaseFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n        element = lcElement;\n      }\n    }\n    set[element] = true;\n  }\n  return set;\n}\n\n/**\n * Clean up an array to harden against CSPP\n *\n * @param {Array} array - The array to be cleaned.\n * @returns {Array} The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n  return array;\n}\n\n/**\n * Shallow clone an object\n *\n * @param {Object} object - The object to be cloned.\n * @returns {Object} A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (value && typeof value === 'object' && value.constructor === Object) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n  return newObject;\n}\n\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param {Object} object - The object to look up the getter function in its prototype chain.\n * @param {String} prop - The property name for which to find the getter function.\n * @returns {Function} The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n    object = getPrototypeOf(object);\n  }\n  function fallbackValue() {\n    return null;\n  }\n  return fallbackValue;\n}\n\nconst html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\n\n// SVG\nconst svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nconst svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nconst svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nconst mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']);\n\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nconst mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nconst text = freeze(['#text']);\n\nconst html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'wrap', 'xmlns', 'slot']);\nconst svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nconst mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nconst xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n// eslint-disable-next-line unicorn/better-regex\nconst MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nconst ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nconst TMPLIT_EXPR = seal(/\\${[\\w\\W]*}/gm);\nconst DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\nconst ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nconst IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\n\nconst IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nconst ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\n\nconst DOCTYPE_NAME = seal(/^html$/i);\nconst CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n\nvar EXPRESSIONS = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  MUSTACHE_EXPR: MUSTACHE_EXPR,\n  ERB_EXPR: ERB_EXPR,\n  TMPLIT_EXPR: TMPLIT_EXPR,\n  DATA_ATTR: DATA_ATTR,\n  ARIA_ATTR: ARIA_ATTR,\n  IS_ALLOWED_URI: IS_ALLOWED_URI,\n  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n  ATTR_WHITESPACE: ATTR_WHITESPACE,\n  DOCTYPE_NAME: DOCTYPE_NAME,\n  CUSTOM_ELEMENT: CUSTOM_ELEMENT\n});\n\nconst getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param {TrustedTypePolicyFactory} trustedTypes The policy factory.\n * @param {HTMLScriptElement} purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return {TrustedTypePolicy} The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  }\n\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\nfunction createDOMPurify() {\n  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n  const DOMPurify = root => createDOMPurify(root);\n\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n  DOMPurify.version = '3.1.0';\n\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n  DOMPurify.removed = [];\n  if (!window || !window.document || window.document.nodeType !== 9) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n  let {\n    document\n  } = window;\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes\n  } = window;\n  const ElementPrototype = Element.prototype;\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName\n  } = document;\n  const {\n    importNode\n  } = originalDocument;\n  let hooks = {};\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT\n  } = EXPRESSIONS;\n  let {\n    IS_ALLOWED_URI: IS_ALLOWED_URI$1\n  } = EXPRESSIONS;\n\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n\n  /*\n   * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n\n  const formElement = document.createElement('form');\n  const isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n\n  /**\n   * _parseConfig\n   *\n   * @param  {Object} cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function _parseConfig() {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE =\n    // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;\n\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS') ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR') ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES') ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR') ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),\n    // eslint-disable-line indent\n    cfg.ADD_URI_SAFE_ATTR,\n    // eslint-disable-line indent\n    transformCaseFunc // eslint-disable-line indent\n    ) // eslint-disable-line indent\n    : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS') ? addToSet(clone(DEFAULT_DATA_URI_TAGS),\n    // eslint-disable-line indent\n    cfg.ADD_DATA_URI_TAGS,\n    // eslint-disable-line indent\n    transformCaseFunc // eslint-disable-line indent\n    ) // eslint-disable-line indent\n    : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS') ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS') ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR') ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES') ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n      }\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n      }\n\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n      }\n\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n    CONFIG = cfg;\n  };\n  const MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  const HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']);\n\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);\n  const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);\n\n  /**\n   * @param  {Element} element a DOM element whose namespace is being checked\n   * @returns {boolean} Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function _checkValidNamespace(element) {\n    let parent = getParentNode(element);\n\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template'\n      };\n    }\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      }\n\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    }\n\n    // For XHTML and XML documents that support custom namespaces\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return true;\n    }\n\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n\n  /**\n   * _forceRemove\n   *\n   * @param  {Node} node a DOM node\n   */\n  const _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      node.parentNode.removeChild(node);\n    } catch (_) {\n      node.remove();\n    }\n  };\n\n  /**\n   * _removeAttribute\n   *\n   * @param  {String} name an Attribute name\n   * @param  {Node} node a DOM node\n   */\n  const _removeAttribute = function _removeAttribute(name, node) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: node.getAttributeNode(name),\n        from: node\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: node\n      });\n    }\n    node.removeAttribute(name);\n\n    // We void attribute values for unremovable \"is\"\" attributes\n    if (name === 'is' && !ALLOWED_ATTR[name]) {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(node);\n        } catch (_) {}\n      } else {\n        try {\n          node.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n\n  /**\n   * _initDocument\n   *\n   * @param  {String} dirty a string of dirty markup\n   * @return {Document} a DOM, filled with the dirty markup\n   */\n  const _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n    const body = doc.body || doc.documentElement;\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param  {Node} root The root element or node to start traversing on.\n   * @return {NodeIterator} The created NodeIterator\n   */\n  const _createNodeIterator = function _createNodeIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root,\n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION, null);\n  };\n\n  /**\n   * _isClobbered\n   *\n   * @param  {Node} elm element to check for clobbering attacks\n   * @return {Boolean} true if clobbered, false if safe\n   */\n  const _isClobbered = function _isClobbered(elm) {\n    return elm instanceof HTMLFormElement && (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function' || typeof elm.hasChildNodes !== 'function');\n  };\n\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param  {Node} object object to check whether it's a DOM node\n   * @return {Boolean} true is object is a DOM node\n   */\n  const _isNode = function _isNode(object) {\n    return typeof Node === 'function' && object instanceof Node;\n  };\n\n  /**\n   * _executeHook\n   * Execute user configurable hooks\n   *\n   * @param  {String} entryPoint  Name of the hook's entry point\n   * @param  {Node} currentNode node to work on with the hook\n   * @param  {Object} data additional hook parameters\n   */\n  const _executeHook = function _executeHook(entryPoint, currentNode, data) {\n    if (!hooks[entryPoint]) {\n      return;\n    }\n    arrayForEach(hooks[entryPoint], hook => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  };\n\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   *\n   * @param   {Node} currentNode to check for permission to exist\n   * @return  {Boolean} true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function _sanitizeElements(currentNode) {\n    let content = null;\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeElements', currentNode, null);\n\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n\n    /* Execute a hook if present */\n    _executeHook('uponSanitizeElement', currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\\w]/g, currentNode.innerHTML) && regExpTest(/<[/\\w]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any ocurrence of processing instructions */\n    if (currentNode.nodeType === 7) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any kind of possibly harmful comments */\n    if (SAFE_FOR_XML && currentNode.nodeType === 8 && regExpTest(/<[/\\w]/g, currentNode.data)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {\n          return false;\n        }\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {\n          return false;\n        }\n      }\n\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n          for (let i = childCount - 1; i >= 0; --i) {\n            parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));\n          }\n        }\n      }\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        content = stringReplace(content, expr, ' ');\n      });\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeElements', currentNode, null);\n    return false;\n  };\n\n  /**\n   * _isValidAttribute\n   *\n   * @param  {string} lcTag Lowercase tag name of containing element.\n   * @param  {string} lcName Lowercase attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n      // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) ||\n      // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n      return false;\n    } else ;\n    return true;\n  };\n\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param {string} tagName name of the tag of the node to sanitize\n   * @returns {boolean} Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function _isBasicCustomElement(tagName) {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param  {Node} currentNode to sanitize\n   */\n  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeAttributes', currentNode, null);\n    const {\n      attributes\n    } = currentNode;\n\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes) {\n      return;\n    }\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR\n    };\n    let l = attributes.length;\n\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const {\n        name,\n        namespaceURI,\n        value: attrValue\n      } = attr;\n      const lcName = transformCaseFunc(name);\n      let value = name === 'value' ? attrValue : stringTrim(attrValue);\n\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n\n      /* Remove attribute */\n      _removeAttribute(name, currentNode);\n\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        continue;\n      }\n\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        continue;\n      }\n\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n\n      /* Handle attributes that require Trusted Types */\n      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              {\n                value = trustedTypesPolicy.createHTML(value);\n                break;\n              }\n            case 'TrustedScriptURL':\n              {\n                value = trustedTypesPolicy.createScriptURL(value);\n                break;\n              }\n          }\n        }\n      }\n\n      /* Handle invalid data-* attribute set by try-catching it */\n      try {\n        if (namespaceURI) {\n          currentNode.setAttributeNS(namespaceURI, name, value);\n        } else {\n          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n          currentNode.setAttribute(name, value);\n        }\n        arrayPop(DOMPurify.removed);\n      } catch (_) {}\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeAttributes', currentNode, null);\n  };\n\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param  {DocumentFragment} fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n\n    /* Execute a hook if present */\n    _executeHook('beforeSanitizeShadowDOM', fragment, null);\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHook('uponSanitizeShadowNode', shadowNode, null);\n\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(shadowNode)) {\n        continue;\n      }\n\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(shadowNode);\n    }\n\n    /* Execute a hook if present */\n    _executeHook('afterSanitizeShadowDOM', fragment, null);\n  };\n\n  /**\n   * Sanitize\n   * Public method providing core sanitation functionality\n   *\n   * @param {String|Node} dirty string or DOM node\n   * @param {Object} cfg object\n   */\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty) {\n    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n      // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n\n    /* Now start iterating over the created document */\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Sanitize tags and elements */\n      if (_sanitizeElements(currentNode)) {\n        continue;\n      }\n\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n\n      /* Check attributes, sanitize if necessary */\n      _sanitizeAttributes(currentNode);\n    }\n\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n      return returnNode;\n    }\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n    /* Serialize doctype if allowed */\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n\n  /**\n   * Public method to set the configuration once\n   * setConfig\n   *\n   * @param {Object} cfg configuration object\n   */\n  DOMPurify.setConfig = function () {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n\n  /**\n   * Public method to remove the configuration\n   * clearConfig\n   *\n   */\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n\n  /**\n   * Public method to check if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   * isValidAttribute\n   *\n   * @param  {String} tag Tag name of containing element.\n   * @param  {String} attr Attribute name.\n   * @param  {String} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n   */\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n\n  /**\n   * AddHook\n   * Public method to add DOMPurify hooks\n   *\n   * @param {String} entryPoint entry point for the hook to add\n   * @param {Function} hookFunction function to execute\n   */\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n    hooks[entryPoint] = hooks[entryPoint] || [];\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n\n  /**\n   * RemoveHook\n   * Public method to remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if more are present)\n   *\n   * @param {String} entryPoint entry point for the hook to remove\n   * @return {Function} removed(popped) hook\n   */\n  DOMPurify.removeHook = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      return arrayPop(hooks[entryPoint]);\n    }\n  };\n\n  /**\n   * RemoveHooks\n   * Public method to remove all DOMPurify hooks at a given entryPoint\n   *\n   * @param  {String} entryPoint entry point for the hooks to remove\n   */\n  DOMPurify.removeHooks = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      hooks[entryPoint] = [];\n    }\n  };\n\n  /**\n   * RemoveAllHooks\n   * Public method to remove all DOMPurify hooks\n   */\n  DOMPurify.removeAllHooks = function () {\n    hooks = {};\n  };\n  return DOMPurify;\n}\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.mjs.map\n","import DOMPurify from 'dompurify'\n\nexport const sanitizeHtml = (html: string) => {\n\treturn DOMPurify.sanitize(html, {\n\t\tUSE_PROFILES: {\n\t\t\thtml: true,\n\t\t\tsvg: true,\n\t\t\tsvgFilters: true\n\t\t}\n\t})\n}\n\n// This is a more restrictive version of sanitizeHtml that focuses on SVGs\nexport const sanitizeSVG = (svgContent: string) => {\n\treturn DOMPurify.sanitize(svgContent, {\n\t\tNAMESPACE: 'http://www.w3.org/2000/svg',\n\t\tUSE_PROFILES: {\n\t\t\thtml: true,\n\t\t\tsvg: true,\n\t\t\tsvgFilters: true\n\t\t}\n\t})\n}\n\n// This is a more restrictive version of sanitizeHtml that only allows text\nexport const sanitizeText = (html: string) => {\n\treturn DOMPurify.sanitize(html, { ALLOWED_TAGS: [] })\n}\n","import { select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { Events, RenderTypes, ToolbarControlTypes } from '@/interfaces/enums'\nimport { sanitizeSVG, sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Toolbar extends Component {\n\tstatic buttonID = 0\n\ttype = 'toolbar'\n\trenderType = RenderTypes.HTML\n\n\t// overflow menu button to control background color\n\toverflowButton: any\n\n\t// div options list element\n\toverflowMenu: any\n\n\tinit() {\n\t\tconst bodyOnClickHandler = () => this.updateOverflowMenu(false)\n\n\t\t// Grab the tooltip element\n\t\tthis.services.events.addEventListener(Events.Toolbar.SHOW_OVERFLOW_MENU, () => {\n\t\t\tthis.renderOverflowMenu()\n\n\t\t\t// hide overflow menu if user clicks on somewhere in web page\n\t\t\tdocument.body.addEventListener('click', bodyOnClickHandler)\n\t\t})\n\n\t\t// listen to hide overflow menu event to hide the overflow menu\n\t\tthis.services.events.addEventListener(Events.Toolbar.HIDE_OVERFLOW_MENU, () => {\n\t\t\t// // hide overflow menu if user clicks on somewhere in web page\n\t\t\tdocument.body.removeEventListener('click', bodyOnClickHandler)\n\t\t})\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst container = this.getComponentContainer()\n\t\t\t.attr('role', 'toolbar')\n\t\t\t.attr('aria-label', `chart toolbar`)\n\n\t\tconst isDataLoading = getProperty(this.getOptions(), 'data', 'loading')\n\n\t\tif (isDataLoading) {\n\t\t\tcontainer.html('')\n\t\t\t// Set overflow menu to null if data is loading\n\t\t\t// This will render in a new overflow menu when data is done loading\n\t\t\tthis.overflowMenu = null\n\t\t} else {\n\t\t\tif (!this.overflowMenu) {\n\t\t\t\tthis.overflowMenu = container\n\t\t\t\t\t.append('div')\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'class',\n\t\t\t\t\t\t'cds--overflow-menu-options cds--overflow-menu--flip cds--overflow-menu-options cds--overflow-menu--flip'\n\t\t\t\t\t)\n\t\t\t\t\t.attr('tabindex', -1)\n\t\t\t\t\t.html(`<ul role='menu'></ul>`)\n\t\t\t}\n\n\t\t\t// get the toolbar buttons\n\t\t\tconst { buttonList, overflowMenuItemList } = this.getControlConfigs()\n\n\t\t\t// overflow button is required only if overflow menu item list is valid\n\t\t\tif (overflowMenuItemList) {\n\t\t\t\tbuttonList.push(this.getOverflowButtonConfig())\n\t\t\t}\n\n\t\t\tconst toolbarControls = container\n\t\t\t\t.selectAll('div.toolbar-control')\n\t\t\t\t.data(buttonList, (button: any) => button.id)\n\n\t\t\ttoolbarControls.exit().remove()\n\n\t\t\tconst enteringToolbarControls = toolbarControls\n\t\t\t\t.enter()\n\t\t\t\t.append('div')\n\t\t\t\t.attr('class', 'toolbar-control cds--overflow-menu cds--overflow-menu')\n\n\t\t\tconst self = this\n\t\t\tenteringToolbarControls\n\t\t\t\t.merge(toolbarControls as any)\n\t\t\t\t.classed('disabled', (d: any) => d.shouldBeDisabled())\n\t\t\t\t.attr('role', 'button')\n\t\t\t\t.attr('aria-disabled', (d: any) => d.shouldBeDisabled())\n\t\t\t\t.attr('aria-label', (d: any) => d.title)\n\t\t\t\t.html((d: any) => {\n\t\t\t\t\treturn `\n\t\t\t<button\n\t\t\t\tclass=\"cds--overflow-menu__trigger cds--overflow-menu__trigger\"\n\t\t\t\taria-haspopup=\"true\" aria-expanded=\"false\" id=\"${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`control-${sanitizeText(d.id)}`\n\t\t\t\t)}\" aria-label=\"${sanitizeText(d.title)}\">\n\t\t\t\t<svg focusable=\"false\" preserveAspectRatio=\"xMidYMid meet\" xmlns=\"http://www.w3.org/2000/svg\" class=\"cds--overflow-menu__icon cds--overflow-menu__icon\" viewBox=\"0 0 32 32\" aria-hidden=\"true\">\n\t\t\t\t\t${sanitizeSVG(d.iconSVG.content)}\n\t\t\t\t</svg>\n\t\t\t</button>`\n\t\t\t\t})\n\t\t\t\t.each(function (d: any, index: number) {\n\t\t\t\t\tselect(this)\n\t\t\t\t\t\t.select('svg')\n\t\t\t\t\t\t.style('pointer-events', 'none')\n\t\t\t\t\t\t.style('will-change', 'transform')\n\t\t\t\t\t\t.style('width', d.iconSVG.width !== undefined ? d.iconSVG.width : '20px')\n\t\t\t\t\t\t.style('height', d.iconSVG.height !== undefined ? d.iconSVG.height : '20px')\n\n\t\t\t\t\tselect(this)\n\t\t\t\t\t\t.select('button')\n\t\t\t\t\t\t.on('mouseover focus', function (event: MouseEvent) {\n\t\t\t\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\t\t\t\thoveredElement.classed('hovered', true)\n\t\t\t\t\t\t\tself.services.events.dispatchEvent(Events.Toolbar.SHOW_TOOLTIP, {\n\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\thoveredElement,\n\t\t\t\t\t\t\t\tcontent: d.title,\n\t\t\t\t\t\t\t\tnoWrap: true,\n\t\t\t\t\t\t\t\tplacements: ['top', 'bottom']\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('mouseout blur', function () {\n\t\t\t\t\t\t\tself.services.events.dispatchEvent(Events.Toolbar.HIDE_TOOLTIP)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('click', (event: CustomEvent<MouseEvent>) => {\n\t\t\t\t\t\t\tif (!d.shouldBeDisabled()) {\n\t\t\t\t\t\t\t\tself.triggerFunctionAndEvent(d, event, this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('keydown', (event: any) => {\n\t\t\t\t\t\t\tif ((event.key && event.key === 'Enter') || event.key === ' ') {\n\t\t\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\t\t\tself.triggerFunctionAndEvent(d, event, this)\n\t\t\t\t\t\t\t} else if (event.key && event.key === 'ArrowLeft') {\n\t\t\t\t\t\t\t\tself.focusOnPreviousEnabledToolbarItem(index)\n\t\t\t\t\t\t\t} else if (event.key && event.key === 'ArrowRight') {\n\t\t\t\t\t\t\t\tself.focusOnNextEnabledToolbarItem(index)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\tthis.overflowButton = this.getComponentContainer().select(\n\t\t\t\t`button.cds--overflow-menu__trigger#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t'control-toolbar-overflow-menu'\n\t\t\t\t)}`\n\t\t\t)\n\t\t}\n\t}\n\n\trenderOverflowMenu() {\n\t\tconst { overflowMenuItemList } = this.getControlConfigs()\n\n\t\tconst overflowMenuControls = this.overflowMenu\n\t\t\t.select('ul')\n\t\t\t.selectAll('li.cds--overflow-menu-options__option')\n\t\t\t.data(overflowMenuItemList, (button: any) => getProperty(button, 'id'))\n\n\t\toverflowMenuControls.exit().remove()\n\n\t\tconst enteringOverflowMenuControls = overflowMenuControls\n\t\t\t.enter()\n\t\t\t.append('li')\n\t\t\t.attr('id', (d: any) => this.services.domUtils.generateElementIDString(`control-${d.id}`))\n\t\t\t.attr('class', 'cds--overflow-menu-options__option cds--overflow-menu-options__option')\n\t\t\t.attr('role', 'menuitem')\n\t\t\t.attr('tabindex', 1)\n\n\t\tenteringOverflowMenuControls\n\t\t\t.append('button')\n\t\t\t.attr('class', 'cds--overflow-menu-options__btn cds--overflow-menu-options__btn')\n\n\t\tenteringOverflowMenuControls\n\t\t\t.merge(overflowMenuControls)\n\t\t\t.classed('cds--overflow-menu-options__option--disabled', (d: any) => d.shouldBeDisabled())\n\t\t\t.classed('cds--overflow-menu-options__option--disabled', (d: any) => d.shouldBeDisabled())\n\t\t\t.attr('aria-disabled', (d: any) => d.shouldBeDisabled())\n\t\t\t.selectAll('button')\n\t\t\t.text((d: any) => d.title)\n\t}\n\n\tisOverflowMenuOpen() {\n\t\treturn this.overflowMenu.classed('is-open')\n\t}\n\n\t// show/hide overflow menu\n\tupdateOverflowMenu(show: boolean) {\n\t\tif (!this.overflowMenu) {\n\t\t\treturn\n\t\t}\n\t\tthis.overflowMenu.classed('is-open', show)\n\n\t\t// update overflow button background\n\t\tif (this.overflowButton) {\n\t\t\tthis.overflowButton.attr('aria-expanded', show)\n\t\t\tselect(this.overflowButton.node().parentNode)\n\t\t\t\t.classed('cds--overflow-menu--open', show)\n\t\t\t\t.classed('cds--overflow-menu--open', show)\n\t\t}\n\n\t\tif (show) {\n\t\t\tthis.services.events.dispatchEvent(Events.Toolbar.SHOW_OVERFLOW_MENU)\n\t\t} else {\n\t\t\tthis.services.events.dispatchEvent(Events.Toolbar.HIDE_OVERFLOW_MENU)\n\t\t}\n\t}\n\n\t// Toolbar controllers\n\tfocusOnPreviousEnabledToolbarItem(currentItemIndex: number) {\n\t\tconst buttonList = this.getToolbarButtonItems()\n\t\tlet previousItemIndex = buttonList.length\n\n\t\tfor (let i = currentItemIndex - 1; i >= 0; i--) {\n\t\t\tconst previousButtonItem = buttonList[i]\n\t\t\tif (!previousButtonItem.shouldBeDisabled()) {\n\t\t\t\tpreviousItemIndex = i\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// only if previous enabled menu item found\n\t\tif (previousItemIndex < buttonList.length) {\n\t\t\tconst previousItemNode = select(\n\t\t\t\t`button#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`control-${buttonList[previousItemIndex].id}`\n\t\t\t\t)}`\n\t\t\t).node()\n\t\t\tif ('focus' in previousItemNode) {\n\t\t\t\tpreviousItemNode.focus()\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusOnNextEnabledToolbarItem(currentItemIndex: number) {\n\t\tconst buttonList = this.getToolbarButtonItems()\n\t\tlet nextItemIndex = -1\n\n\t\tfor (let i = currentItemIndex + 1; i < buttonList.length; i++) {\n\t\t\tconst nextOverflowMenuItem = buttonList[i]\n\t\t\tif (!nextOverflowMenuItem.shouldBeDisabled()) {\n\t\t\t\tnextItemIndex = i\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// only if next enabled menu item found\n\t\tif (nextItemIndex > -1) {\n\t\t\tconst nextItemNode = select(\n\t\t\t\t`button#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`control-${buttonList[nextItemIndex].id}`\n\t\t\t\t)}`\n\t\t\t).node()\n\n\t\t\tif ('focus' in nextItemNode) {\n\t\t\t\tnextItemNode.focus()\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusOnPreviousEnabledMenuItem(currentItemIndex: number) {\n\t\tconst overflowMenuItems = this.getOverflowMenuItems()\n\t\tlet previousItemIndex = overflowMenuItems.length\n\n\t\tfor (let i = currentItemIndex - 1; i >= 0; i--) {\n\t\t\tconst previousOverflowMenuItem = overflowMenuItems[i]\n\t\t\tif (!previousOverflowMenuItem.shouldBeDisabled()) {\n\t\t\t\tpreviousItemIndex = i\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// only if previous enabled menu item found\n\t\tif (previousItemIndex < overflowMenuItems.length) {\n\t\t\tconst previousItemNode = select(\n\t\t\t\t`#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`control-${overflowMenuItems[previousItemIndex].id}`\n\t\t\t\t)} button`\n\t\t\t).node()\n\t\t\tif ('focus' in previousItemNode) {\n\t\t\t\tpreviousItemNode.focus()\n\t\t\t}\n\t\t}\n\t}\n\n\tfocusOnNextEnabledMenuItem(currentItemIndex: number) {\n\t\tconst overflowMenuItems = this.getOverflowMenuItems()\n\t\tlet nextItemIndex = -1\n\n\t\tfor (let i = currentItemIndex + 1; i < overflowMenuItems.length; i++) {\n\t\t\tconst nextOverflowMenuItem = overflowMenuItems[i]\n\t\t\tif (!nextOverflowMenuItem.shouldBeDisabled()) {\n\t\t\t\tnextItemIndex = i\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// only if next enabled menu item found\n\t\tif (nextItemIndex > -1) {\n\t\t\tconst nextItemNode = select(\n\t\t\t\t`#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`control-${overflowMenuItems[nextItemIndex].id}`\n\t\t\t\t)} button`\n\t\t\t).node()\n\n\t\t\tif ('focus' in nextItemNode) {\n\t\t\t\tnextItemNode.focus()\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleOverflowMenu(event: any) {\n\t\tif (this.isOverflowMenuOpen()) {\n\t\t\t// hide overflow menu\n\t\t\tthis.updateOverflowMenu(false)\n\t\t} else {\n\t\t\t// show overflow menu\n\t\t\tthis.updateOverflowMenu(true)\n\n\t\t\t// setup overflow menu item event listener\n\t\t\tconst self = this\n\t\t\tconst overflowMenuItems = this.getOverflowMenuItems()\n\t\t\toverflowMenuItems.forEach((menuItem: any, index) => {\n\t\t\t\tconst element = select(\n\t\t\t\t\t`#${this.services.domUtils.generateElementIDString(`control-${menuItem.id}`)}`\n\t\t\t\t)\n\t\t\t\tif (element !== null) {\n\t\t\t\t\telement.on('click', () => {\n\t\t\t\t\t\tself.triggerFunctionAndEvent(menuItem, event, element.node())\n\n\t\t\t\t\t\t// hide overflow menu\n\t\t\t\t\t\tself.updateOverflowMenu(false)\n\t\t\t\t\t})\n\n\t\t\t\t\telement.on('keydown', (keyEvent: KeyboardEvent) => {\n\t\t\t\t\t\tif (keyEvent && keyEvent.key === 'Enter') {\n\t\t\t\t\t\t\tself.triggerFunctionAndEvent(menuItem, event, element.node())\n\t\t\t\t\t\t} else if (keyEvent && keyEvent.key === 'ArrowUp') {\n\t\t\t\t\t\t\t// focus on previous menu item\n\t\t\t\t\t\t\tself.focusOnPreviousEnabledMenuItem(index)\n\t\t\t\t\t\t} else if (keyEvent && keyEvent.key === 'ArrowDown') {\n\t\t\t\t\t\t\t// focus on next menu item\n\t\t\t\t\t\t\tself.focusOnNextEnabledMenuItem(index)\n\t\t\t\t\t\t} else if (keyEvent && keyEvent.key === 'Escape') {\n\t\t\t\t\t\t\tself.updateOverflowMenu(false)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Not hide overflow menu by keyboard arrow up/down event\n\t\t\t\t\t\t// Prevent page from scrolling up/down\n\t\t\t\t\t\tkeyEvent.preventDefault()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// default to focus on the first enabled menu item\n\t\t\tself.focusOnNextEnabledMenuItem(-1)\n\t\t}\n\n\t\t// propogation should not be stopped for keyboard events\n\t\tif (event) {\n\t\t\tevent.stopImmediatePropagation()\n\t\t}\n\t}\n\n\t// Calls passed function && dispatches event\n\ttriggerFunctionAndEvent(control: any, event: CustomEvent, element?: any) {\n\t\t// Check if trigger is disabled\n\t\tif (typeof control.shouldBeDisabled === 'function' && control.shouldBeDisabled()) {\n\t\t\treturn\n\t\t}\n\n\t\t// Call custom function only if it exists\n\t\tif (typeof control.clickFunction === 'function') {\n\t\t\tcontrol.clickFunction(event)\n\t\t}\n\n\t\t// Dispatch selection event\n\t\tthis.services.events.dispatchEvent(Events.Toolbar.BUTTON_CLICK, {\n\t\t\tcontrol,\n\t\t\tevent,\n\t\t\telement\n\t\t})\n\t}\n\n\tgetControlConfigs() {\n\t\tconst numberOfIcons = getProperty(this.getOptions(), 'toolbar', 'numberOfIcons') - 1\n\t\tconst controls = getProperty(this.getOptions(), 'toolbar', 'controls')\n\t\tconst overflowSpecificControls: any[] = []\n\t\tconst buttonList: any[] = []\n\t\tconst overflowList: any[] = []\n\n\t\tcontrols.forEach((control: any) => {\n\t\t\tlet controlConfig = null\n\t\t\t// check if button is custom or default control\n\t\t\tif (control.type === ToolbarControlTypes.CUSTOM) {\n\t\t\t\t// add generic id if missing\n\t\t\t\tif (getProperty(control, 'id') === null) {\n\t\t\t\t\t// add id directly to the data passed so that id isn't reassigned on rerender\n\t\t\t\t\tcontrol.id = `toolbar-button-${Toolbar.buttonID++}`\n\t\t\t\t}\n\t\t\t\t// define function if missing\n\t\t\t\tif (getProperty(control, 'shouldBeDisabled') === null) {\n\t\t\t\t\tcontrol.shouldBeDisabled = () => false\n\t\t\t\t}\n\n\t\t\t\tcontrolConfig = control\n\t\t\t} else {\n\t\t\t\tconst isFullScreenMode = this.services.domUtils.isFullScreenMode()\n\t\t\t\t// toggle fullscreen configs by current display modes\n\t\t\t\tif (control.type === ToolbarControlTypes.MAKE_FULLSCREEN && isFullScreenMode) {\n\t\t\t\t\tcontrol.type = ToolbarControlTypes.EXIT_FULLSCREEN\n\t\t\t\t} else if (control.type === ToolbarControlTypes.EXIT_FULLSCREEN && !isFullScreenMode) {\n\t\t\t\t\tcontrol.type = ToolbarControlTypes.MAKE_FULLSCREEN\n\t\t\t\t}\n\t\t\t\tcontrolConfig = this.getControlConfigByType(control.type)\n\t\t\t}\n\n\t\t\t// add to list if config is valid\n\t\t\tif (controlConfig) {\n\t\t\t\tcontrolConfig.text = control.text ? control.text : control.type\n\n\t\t\t\tif (controlConfig.id.indexOf('toolbar-export') !== -1) {\n\t\t\t\t\toverflowSpecificControls.push(controlConfig)\n\t\t\t\t} else if (buttonList.length < numberOfIcons) {\n\t\t\t\t\t// check if icon exists else assign to the overflow list\n\t\t\t\t\tif (getProperty(controlConfig, 'iconSVG', 'content') === null) {\n\t\t\t\t\t\toverflowList.push(controlConfig)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuttonList.push(controlConfig)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toverflowList.push(controlConfig)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\t// Ensures the `export` controls are always at the bottom\n\t\toverflowList.push(...overflowSpecificControls)\n\n\t\tif (!overflowList.length) {\n\t\t\treturn {\n\t\t\t\tbuttonList\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tbuttonList,\n\t\t\toverflowMenuItemList: overflowList\n\t\t}\n\t}\n\n\tgetToolbarButtonItems() {\n\t\tconst { buttonList, overflowMenuItemList } = this.getControlConfigs()\n\t\tif (overflowMenuItemList) {\n\t\t\tbuttonList.push(this.getOverflowButtonConfig())\n\t\t}\n\t\tif (buttonList) {\n\t\t\treturn buttonList\n\t\t}\n\n\t\treturn []\n\t}\n\n\tgetOverflowMenuItems() {\n\t\tconst { overflowMenuItemList } = this.getControlConfigs()\n\t\tif (overflowMenuItemList) {\n\t\t\treturn overflowMenuItemList\n\t\t} else {\n\t\t\treturn []\n\t\t}\n\t}\n\n\t// special button config for overflow button\n\tgetOverflowButtonConfig() {\n\t\tconst { moreOptions } = getProperty(this.model.getOptions(), 'locale', 'translations', 'toolbar')\n\t\treturn {\n\t\t\tid: 'toolbar-overflow-menu',\n\t\t\ttitle: moreOptions,\n\t\t\tshouldBeDisabled: () => false,\n\t\t\ticonSVG: {\n\t\t\t\tcontent: `<circle cx=\"16\" cy=\"8\" r=\"2\"></circle>\n\t\t\t\t<circle cx=\"16\" cy=\"16\" r=\"2\"></circle>\n\t\t\t\t<circle cx=\"16\" cy=\"24\" r=\"2\"></circle>`\n\t\t\t},\n\t\t\tclickFunction: (event: any) => this.toggleOverflowMenu(event)\n\t\t}\n\t}\n\n\tgetControlConfigByType(controlType: ToolbarControlTypes) {\n\t\tconst isZoomBarEnabled =\n\t\t\tthis.services.zoom &&\n\t\t\tthis.services.zoom.isZoomBarEnabled() &&\n\t\t\t!this.services.zoom.isEmptyState()\n\n\t\tconst displayData = this.model.getDisplayData()\n\t\tconst options = this.model.getOptions()\n\t\tconst {\n\t\t\texportAsCSV, exportAsJPG, exportAsPNG, zoomIn, zoomOut, resetZoom,\n\t\t\tmakeFullScreen, exitFullScreen, showAsTable\n\t\t} = getProperty(\n\t\t\toptions,\n\t\t\t'locale',\n\t\t\t'translations',\n\t\t\t'toolbar'\n\t\t)\n\n\t\tlet controlConfig: any\n\t\tswitch (controlType) {\n\t\t\tcase ToolbarControlTypes.ZOOM_IN:\n\t\t\t\tif (isZoomBarEnabled) {\n\t\t\t\t\tcontrolConfig = {\n\t\t\t\t\t\tid: 'toolbar-zoomIn',\n\t\t\t\t\t\ttitle: zoomIn,\n\t\t\t\t\t\tshouldBeDisabled: () => this.services.zoom.isMinZoomDomain(),\n\t\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclickFunction: () => this.services.zoom.zoomIn()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.ZOOM_OUT:\n\t\t\t\tif (isZoomBarEnabled) {\n\t\t\t\t\tcontrolConfig = {\n\t\t\t\t\t\tid: 'toolbar-zoomOut',\n\t\t\t\t\t\ttitle: zoomOut,\n\t\t\t\t\t\tshouldBeDisabled: () => this.services.zoom.isMaxZoomDomain(),\n\t\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclickFunction: () => this.services.zoom.zoomOut()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.RESET_ZOOM:\n\t\t\t\tif (isZoomBarEnabled) {\n\t\t\t\t\tcontrolConfig = {\n\t\t\t\t\t\tid: 'toolbar-resetZoom',\n\t\t\t\t\t\ttitle: resetZoom,\n\t\t\t\t\t\tshouldBeDisabled: () => this.services.zoom.isMaxZoomDomain(),\n\t\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclickFunction: () => this.services.zoom.resetZoomDomain()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.MAKE_FULLSCREEN:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-makefullscreen',\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType),\n\t\t\t\t\t\twidth: '15px',\n\t\t\t\t\t\theight: '15px'\n\t\t\t\t\t},\n\t\t\t\t\ttitle: makeFullScreen,\n\t\t\t\t\tshouldBeDisabled: () => false,\n\t\t\t\t\tclickFunction: () => {\n\t\t\t\t\t\tthis.services.domUtils.toggleFullscreen()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.EXIT_FULLSCREEN:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-exitfullscreen',\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType),\n\t\t\t\t\t\twidth: '15px',\n\t\t\t\t\t\theight: '15px'\n\t\t\t\t\t},\n\t\t\t\t\ttitle: exitFullScreen,\n\t\t\t\t\tshouldBeDisabled: () => false,\n\t\t\t\t\tclickFunction: () => {\n\t\t\t\t\t\tthis.services.domUtils.toggleFullscreen()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.SHOW_AS_DATATABLE:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-showasdatatable',\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t},\n\t\t\t\t\ttitle: showAsTable,\n\t\t\t\t\tshouldBeDisabled: () => displayData.length === 0,\n\t\t\t\t\tclickFunction: () => this.services.events.dispatchEvent(Events.Modal.SHOW)\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.EXPORT_CSV:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-export-CSV',\n\t\t\t\t\ttitle: exportAsCSV,\n\t\t\t\t\tshouldBeDisabled: () => false,\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t},\n\t\t\t\t\tclickFunction: () => this.model.exportToCSV()\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.EXPORT_PNG:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-export-PNG',\n\t\t\t\t\ttitle: exportAsPNG,\n\t\t\t\t\tshouldBeDisabled: () => false,\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t},\n\t\t\t\t\tclickFunction: () => this.services.domUtils.exportToPNG()\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\tcase ToolbarControlTypes.EXPORT_JPG:\n\t\t\t\tcontrolConfig = {\n\t\t\t\t\tid: 'toolbar-export-JPG',\n\t\t\t\t\ttitle: exportAsJPG,\n\t\t\t\t\tshouldBeDisabled: () => false,\n\t\t\t\t\ticonSVG: {\n\t\t\t\t\t\tcontent: this.getControlIconByType(controlType)\n\t\t\t\t\t},\n\t\t\t\t\tclickFunction: () => this.services.domUtils.exportToJPG()\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t// add more toolbar control configuration here\n\n\t\t\tdefault:\n\t\t\t\tthrow Error('Not supported toolbar control type: ' + controlType)\n\t\t}\n\t\treturn controlConfig\n\t}\n\n\tgetControlIconByType(controlType: ToolbarControlTypes) {\n\t\tswitch (controlType) {\n\t\t\tcase ToolbarControlTypes.ZOOM_IN:\n\t\t\t\treturn `<polygon points=\"19 13 15 13 15 9 13 9 13 13 9 13 9 15 13 15 13 19 15 19 15 15 19 15 19 13\"/>\n\t\t\t\t\t\t<path d=\"M22.45,21A10.87,10.87,0,0,0,25,14,11,11,0,1,0,14,25a10.87,10.87,0,0,0,7-2.55L28.59,30,30,28.59ZM14,23a9,9,0,1,1,9-9A9,9,0,0,1,14,23Z\"/>`\n\t\t\tcase ToolbarControlTypes.ZOOM_OUT:\n\t\t\t\treturn `<rect x=\"9\" y=\"13\" width=\"10\" height=\"2\"/>\n\t\t\t\t\t\t<path d=\"M22.45,21A10.87,10.87,0,0,0,25,14,11,11,0,1,0,14,25a10.87,10.87,0,0,0,7-2.55L28.59,30,30,28.59ZM14,23a9,9,0,1,1,9-9A9,9,0,0,1,14,23Z\"/>`\n\t\t\tcase ToolbarControlTypes.RESET_ZOOM:\n\t\t\t\treturn `<path d=\"M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z\"/>`\n\t\t\tcase ToolbarControlTypes.MAKE_FULLSCREEN:\n\t\t\t\treturn `<polygon points=\"21 2 21 4 26.59 4 17 13.58 18.41 15 28 5.41 28 11 30 11 30 2 21 2\"/><polygon points=\"15 18.42 13.59 17 4 26.59 4 21 2 21 2 30 11 30 11 28 5.41 28 15 18.42\"/>`\n\t\t\tcase ToolbarControlTypes.EXIT_FULLSCREEN:\n\t\t\t\treturn `<polygon points=\"4 18 4 20 10.586 20 2 28.582 3.414 30 12 21.414 12 28 14 28 14 18 4 18\"/><polygon points=\"30 3.416 28.592 2 20 10.586 20 4 18 4 18 14 28 14 28 12 21.414 12 30 3.416\"/>`\n\t\t\tcase ToolbarControlTypes.SHOW_AS_DATATABLE:\n\t\t\t\treturn `<rect x=\"4\" y=\"6\" width=\"18\" height=\"2\"/><rect x=\"4\" y=\"12\" width=\"18\" height=\"2\"/><rect x=\"4\" y=\"18\" width=\"18\" height=\"2\"/><rect x=\"4\" y=\"24\" width=\"18\" height=\"2\"/><rect x=\"26\" y=\"6\" width=\"2\" height=\"2\"/><rect x=\"26\" y=\"12\" width=\"2\" height=\"2\"/><rect x=\"26\" y=\"18\" width=\"2\" height=\"2\"/><rect x=\"26\" y=\"24\" width=\"2\" height=\"2\"/>`\n\t\t\tcase ToolbarControlTypes.EXPORT_CSV:\n\t\t\t\treturn `<path d=\"M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z\"/>`\n\t\t\tcase ToolbarControlTypes.EXPORT_JPG:\n\t\t\t\treturn `<path d=\"M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z\"/>`\n\t\t\tcase ToolbarControlTypes.EXPORT_PNG:\n\t\t\t\treturn `<path d=\"M22.4478,21A10.855,10.855,0,0,0,25,14,10.99,10.99,0,0,0,6,6.4658V2H4v8h8V8H7.332a8.9768,8.9768,0,1,1-2.1,8H3.1912A11.0118,11.0118,0,0,0,14,25a10.855,10.855,0,0,0,7-2.5522L28.5859,30,30,28.5859Z\"/>` // add more icons here\n\t\t\t// svg icon must be with 32x32 viewBox\n\n\t\t\tdefault:\n\t\t\t\tthrow Error('Not supported toolbar control type: ' + controlType)\n\t\t}\n\t}\n}\n","import { select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { carbonPrefix } from '@/configuration-non-customizable' // CSS prefix\nimport { Component } from '@/components/component'\nimport { LayoutDirection, LayoutGrowth, RenderTypes, LayoutAlignItems } from '@/interfaces/enums'\nimport { LayoutConfigs } from '@/interfaces/layout'\nimport { LayoutComponentChild } from '@/interfaces/components'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModel } from '@/model/model'\n\nexport class LayoutComponent extends Component {\n\t// Give every layout component a distinct ID\n\t// so they don't interfere when querying elements\n\tstatic instanceID = Math.floor(Math.random() * 99999999999)\n\n\ttype = 'layout'\n\n\tchildren: LayoutComponentChild[]\n\n\tprivate _instanceID: number\n\n\tconstructor(\n\t\tmodel: ChartModel,\n\t\tservices: any,\n\t\tchildren: LayoutComponentChild[],\n\t\tconfigs?: LayoutConfigs\n\t) {\n\t\tsuper(model, services, configs)\n\n\t\tthis.configs = configs\n\t\tthis.children = children\n\n\t\tthis._instanceID = LayoutComponent.instanceID++\n\n\t\tthis.init()\n\t}\n\n\tinit() {\n\t\tthis.children.forEach((child: any) => {\n\t\t\tchild.components.forEach((component: Component) => {\n\t\t\t\tcomponent.init()\n\t\t\t})\n\t\t})\n\t}\n\n\tgetPreferedAndFixedSizeSum(): number {\n\t\tconst svg = this.parent\n\t\tlet sum = 0\n\n\t\tsvg\n\t\t\t.selectAll(`div.layout-child-${this._instanceID}`)\n\t\t\t.filter((d: any) => {\n\t\t\t\tconst growth = getProperty(d, 'growth')\n\n\t\t\t\treturn growth === LayoutGrowth.PREFERRED || growth === LayoutGrowth.FIXED\n\t\t\t})\n\t\t\t.each(function (d: any) {\n\t\t\t\tsum += d.size\n\t\t\t})\n\n\t\treturn sum\n\t}\n\n\tgetNumOfStretchChildren(): number {\n\t\tconst svg = this.parent\n\n\t\treturn svg\n\t\t\t.selectAll(`div.layout-child-${this._instanceID}`)\n\t\t\t.filter((d: any) => getProperty(d, 'growth') === LayoutGrowth.STRETCH)\n\t\t\t.size()\n\t}\n\n\trender(animate = true) {\n\t\t// Get parent element to render inside of\n\t\tconst parent = this.parent\n\n\t\tconst { width, height } = DOMUtils.getHTMLElementSize(parent.node() as any)\n\n\t\tconst horizontal =\n\t\t\tthis.configs.direction === LayoutDirection.ROW ||\n\t\t\tthis.configs.direction === LayoutDirection.ROW_REVERSE\n\n\t\tconst chartprefix = getProperty(this.model.getOptions(), 'style', 'prefix')\n\n\t\t// Add new boxes to the DOM for each layout child\n\t\tconst updatedBoxes = parent\n\t\t\t.classed(\n\t\t\t\t`${carbonPrefix}--${chartprefix}--layout-row`,\n\t\t\t\tthis.configs.direction === LayoutDirection.ROW\n\t\t\t)\n\t\t\t.classed(\n\t\t\t\t`${carbonPrefix}--${chartprefix}--layout-row-reverse`,\n\t\t\t\tthis.configs.direction === LayoutDirection.ROW_REVERSE\n\t\t\t)\n\t\t\t.classed(\n\t\t\t\t`${carbonPrefix}--${chartprefix}--layout-column`,\n\t\t\t\tthis.configs.direction === LayoutDirection.COLUMN\n\t\t\t)\n\t\t\t.classed(\n\t\t\t\t`${carbonPrefix}--${chartprefix}--layout-column-reverse`,\n\t\t\t\tthis.configs.direction === LayoutDirection.COLUMN_REVERSE\n\t\t\t)\n\t\t\t.classed(\n\t\t\t\t`${carbonPrefix}--${chartprefix}--layout-alignitems-center`,\n\t\t\t\tthis.configs.alignItems === LayoutAlignItems.CENTER\n\t\t\t)\n\t\t\t.selectAll(`div.layout-child-${this._instanceID}`)\n\t\t\t.data(this.children, (d: any) => d.id)\n\n\t\tconst enteringBoxes = updatedBoxes.enter().append('div')\n\n\t\tenteringBoxes\n\t\t\t.merge(parent.selectAll(`div.layout-child-${this._instanceID}`))\n\t\t\t.attr('class', (d: any) => `layout-child layout-child-${this._instanceID} ${d.id}`)\n\t\t\t.each(function (d: any) {\n\t\t\t\t// Set parent component for each child\n\t\t\t\td.components.forEach((itemComponent: any) => {\n\t\t\t\t\tconst selection = select(this)\n\n\t\t\t\t\tconst renderType = getProperty(d, 'renderType')\n\t\t\t\t\tconst isRenderingSVG = renderType === RenderTypes.SVG\n\t\t\t\t\titemComponent.setParent(\n\t\t\t\t\t\tisRenderingSVG\n\t\t\t\t\t\t\t? DOMUtils.appendOrSelect(selection, 'svg.layout-svg-wrapper')\n\t\t\t\t\t\t\t\t\t.attr('width', '100%')\n\t\t\t\t\t\t\t\t\t.attr('height', '100%')\n\t\t\t\t\t\t\t: selection\n\t\t\t\t\t)\n\n\t\t\t\t\t// Render preffered & fixed items\n\t\t\t\t\tconst growth = getProperty(d, 'growth')\n\t\t\t\t\tif (growth === LayoutGrowth.PREFERRED || growth === LayoutGrowth.FIXED) {\n\t\t\t\t\t\titemComponent.render(animate)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\n\t\tparent\n\t\t\t.selectAll(`div.layout-child-${this._instanceID}`)\n\t\t\t.style('height', null)\n\t\t\t.style('width', null)\n\t\t\t.each(function (d: any) {\n\t\t\t\t// Calculate preffered children sizes after internal rendering\n\t\t\t\tconst growth = getProperty(d, 'growth')\n\n\t\t\t\tconst renderType = getProperty(d, 'renderType')\n\t\t\t\tconst matchingElementDimensions =\n\t\t\t\t\trenderType === RenderTypes.SVG\n\t\t\t\t\t\t? DOMUtils.getSVGElementSize(select(this).select('svg.layout-svg-wrapper'), {\n\t\t\t\t\t\t\t\tuseBBox: true\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t: DOMUtils.getHTMLElementSize(this as any)\n\n\t\t\t\tif (growth === LayoutGrowth.PREFERRED) {\n\t\t\t\t\tconst matchingElementWidth = horizontal\n\t\t\t\t\t\t? matchingElementDimensions.width\n\t\t\t\t\t\t: matchingElementDimensions.height\n\t\t\t\t\tconst elementWidth = horizontal ? width : height\n\n\t\t\t\t\td.size = (matchingElementWidth / elementWidth) * 100\n\t\t\t\t}\n\t\t\t})\n\n\t\tupdatedBoxes.exit().remove()\n\n\t\t// Run through stretch x-items\n\t\tthis.children\n\t\t\t.filter(child => {\n\t\t\t\tconst growth = getProperty(child, 'growth')\n\t\t\t\treturn growth === LayoutGrowth.STRETCH\n\t\t\t})\n\t\t\t.forEach((child: any) => {\n\t\t\t\tchild.size = (100 - +this.getPreferedAndFixedSizeSum()) / +this.getNumOfStretchChildren()\n\t\t\t})\n\n\t\t// Update all boxes with new sizing\n\t\tconst allUpdatedBoxes = parent\n\t\t\t.selectAll(`div.layout-child-${this._instanceID}`)\n\t\t\t.data(this.children, (d: any) => d.id)\n\n\t\tif (horizontal) {\n\t\t\tallUpdatedBoxes\n\t\t\t\t.style('width', (d: any) => `${(d.size / 100) * width}px`)\n\t\t\t\t.style('height', '100%')\n\t\t} else {\n\t\t\tallUpdatedBoxes\n\t\t\t\t.style('height', (d: any) => `${(d.size / 100) * height}px`)\n\t\t\t\t.style('width', '100%')\n\t\t}\n\n\t\tallUpdatedBoxes.each(function (d: any) {\n\t\t\td.components.forEach((itemComponent: any) => {\n\t\t\t\tconst growth = getProperty(d, 'growth')\n\t\t\t\tif (growth === LayoutGrowth.STRETCH) {\n\t\t\t\t\titemComponent.render(animate)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t// Pass on model to children as well\n\tsetModel(newObj: ChartModel) {\n\t\tsuper.setModel(newObj)\n\n\t\tthis.children.forEach((child: any) => {\n\t\t\tchild.components.forEach((component: Component) => component.setModel(newObj))\n\t\t})\n\t}\n\n\t// Pass on essentials to children as well\n\tsetServices(newObj: any) {\n\t\tsuper.setServices(newObj)\n\n\t\tthis.children.forEach((child: any) => {\n\t\t\tchild.components.forEach((component: Component) => component.setServices(newObj))\n\t\t})\n\t}\n\n\tdestroy() {\n\t\tthis.children.forEach((child: any) => {\n\t\t\tchild.components.forEach((component: Component) => component.destroy())\n\t\t})\n\t}\n}\n","import { spacers as spacerConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\n\nexport class Spacer extends Component {\n\ttype = 'spacer'\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tthis.getComponentContainer()\n\t\t\t.style('width', `${this.configs.size || spacerConfigs.default.size}px`)\n\t\t\t.style('height', `${this.configs.size || spacerConfigs.default.size}px`)\n\t\t\t.attr('opacity', 0)\n\t}\n}\n","/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * Settings.\n * @exports CarbonComponents.settings\n * @type Object\n * @property {boolean} [disableAutoInit]\n *   Disables automatic instantiation of components.\n *   By default (`CarbonComponents.disableAutoInit` is `false`),\n *   carbon-components attempts to instantiate components automatically\n *   by searching for elements with `data-component-name` (e.g. `data-loading`) attribute\n *   or upon DOM events (e.g. clicking) on such elements.\n *   See each components' static `.init()` methods for details.\n * @property {string} [prefix=bx]\n *   Brand prefix. Should be in sync with `$prefix` Sass variable in carbon-components/src/globals/scss/_vars.scss.\n * // @todo given that the default value is so long, is it appropriate to put in the JSDoc?\n * @property {string} [selectorTabbable]\n *   A selector selecting tabbable/focusable nodes.\n *   By default selectorTabbable references links, areas, inputs, buttons, selects, textareas,\n *   iframes, objects, embeds, or elements explicitly using tabindex or contenteditable attributes\n *   as long as the element is not `disabled` or the `tabindex=\"-1\"`.\n * @property {string} [selectorFocusable]\n *   CSS selector that selects major nodes that are click focusable\n *   This property is identical to selectorTabbable with the exception of\n *   the `:not([tabindex='-1'])` pseudo class\n */\nvar settings = {\n  prefix: 'bx',\n  selectorTabbable: \"\\n    a[href], area[href], input:not([disabled]):not([tabindex='-1']),\\n    button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']),\\n    textarea:not([disabled]):not([tabindex='-1']),\\n    iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]\\n  \",\n  selectorFocusable: \"\\n    a[href], area[href], input:not([disabled]),\\n    button:not([disabled]),select:not([disabled]),\\n    textarea:not([disabled]),\\n    iframe, object, embed, *[tabindex], *[contenteditable=true]\\n  \"\n};\nvar settings_1 = settings;\nexport { settings_1 as default };","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * @param {Array} a An array.\n * @returns {Array} The flattened version of the given array.\n */\n\n\nfunction flatten(a) {\n  return a.reduce(function (result, item) {\n    if (Array.isArray(item)) {\n      result.push.apply(result, _toConsumableArray(flatten(item)));\n    } else {\n      result.push(item);\n    }\n\n    return result;\n  }, []);\n}\n/**\n * An interface for defining mix-in classes. Used with {@link mixin}.\n * @function mixinfn\n * @param {Class} ToMix The class to mix.\n * @returns {Class} The class mixed-in with the given ToMix class.\n */\n\n/**\n * @function mixin\n * @param {...mixinfn} mixinfns The functions generating mix-ins.\n * @returns {Class} The class generated with the given mix-ins.\n */\n\n\nexport default function mixin() {\n  for (var _len = arguments.length, mixinfns = new Array(_len), _key = 0; _key < _len; _key++) {\n    mixinfns[_key] = arguments[_key];\n  }\n\n  return flatten(mixinfns).reduce(function (Class, mixinfn) {\n    return mixinfn(Class);\n  }, /*#__PURE__*/function () {\n    function _class() {\n      _classCallCheck(this, _class);\n    }\n\n    return _createClass(_class);\n  }());\n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nexport default function (ToMix) {\n  var CreateComponent = /*#__PURE__*/function (_ToMix) {\n    _inherits(CreateComponent, _ToMix);\n\n    var _super = _createSuper(CreateComponent);\n    /**\n     * The component instances managed by this component.\n     * Releasing this component also releases the components in `this.children`.\n     * @type {Component[]}\n     */\n\n    /**\n     * Mix-in class to manage lifecycle of component.\n     * The constructor sets up this component's effective options,\n     * and registers this component's instance associated to an element.\n     * @implements Handle\n     * @param {HTMLElement} element The element working as this component.\n     * @param {object} [options] The component options.\n     */\n\n\n    function CreateComponent(element) {\n      var _this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, CreateComponent);\n\n      _this = _super.call(this, element, options);\n      _this.children = [];\n\n      if (!element || element.nodeType !== Node.ELEMENT_NODE) {\n        throw new TypeError('DOM element should be given to initialize this widget.');\n      }\n      /**\n       * The element the component is of.\n       * @type {Element}\n       */\n\n\n      _this.element = element;\n      /**\n       * The component options.\n       * @type {object}\n       */\n\n      _this.options = Object.assign(Object.create(_this.constructor.options), options);\n\n      _this.constructor.components.set(_this.element, _assertThisInitialized(_this));\n\n      return _this;\n    }\n    /**\n     * Instantiates this component of the given element.\n     * @param {HTMLElement} element The element.\n     */\n\n\n    _createClass(CreateComponent, [{\n      key: \"release\",\n      value:\n      /**\n       * Releases this component's instance from the associated element.\n       */\n      function release() {\n        for (var child = this.children.pop(); child; child = this.children.pop()) {\n          child.release();\n        }\n\n        this.constructor.components.delete(this.element);\n        return null;\n      }\n    }], [{\n      key: \"create\",\n      value: function create(element, options) {\n        return this.components.get(element) || new this(element, options);\n      }\n    }]);\n\n    return CreateComponent;\n  }(ToMix);\n\n  return CreateComponent;\n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get.apply(this, arguments);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nexport default function (ToMix) {\n  /**\n   * Mix-in class to manage handles in component.\n   * Managed handles are automatically released when the component with this class mixed in is released.\n   * @class Handles\n   * @implements Handle\n   */\n  var Handles = /*#__PURE__*/function (_ToMix) {\n    _inherits(Handles, _ToMix);\n\n    var _super = _createSuper(Handles);\n\n    function Handles() {\n      var _this;\n\n      _classCallCheck(this, Handles);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _super.call.apply(_super, [this].concat(args));\n      _this.handles = new Set();\n      return _this;\n    }\n\n    _createClass(Handles, [{\n      key: \"manage\",\n      value:\n      /**\n       * Manages the given handle.\n       * @param {Handle} handle The handle to manage.\n       * @returns {Handle} The given handle.\n       */\n      function manage(handle) {\n        this.handles.add(handle);\n        return handle;\n      }\n      /**\n       * Stop managing the given handle.\n       * @param {Handle} handle The handle to stop managing.\n       * @returns {Handle} The given handle.\n       */\n\n    }, {\n      key: \"unmanage\",\n      value: function unmanage(handle) {\n        this.handles.delete(handle);\n        return handle;\n      }\n    }, {\n      key: \"release\",\n      value: function release() {\n        var _this2 = this;\n\n        this.handles.forEach(function (handle) {\n          handle.release();\n\n          _this2.handles.delete(handle);\n        });\n        return _get(_getPrototypeOf(Handles.prototype), \"release\", this).call(this);\n      }\n    }]);\n\n    return Handles;\n  }(ToMix);\n\n  return Handles;\n}","/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nexport default function on(element) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  element.addEventListener.apply(element, args);\n  return {\n    release: function release() {\n      element.removeEventListener.apply(element, args);\n      return null;\n    }\n  };\n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nexport default function (ToMix) {\n  /**\n   * Mix-in class to manage events associated with states.\n   * @class EventedState\n   */\n  var EventedState = /*#__PURE__*/function (_ToMix) {\n    _inherits(EventedState, _ToMix);\n\n    var _super = _createSuper(EventedState);\n\n    function EventedState() {\n      _classCallCheck(this, EventedState);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(EventedState, [{\n      key: \"_changeState\",\n      value:\n      /* eslint-disable jsdoc/check-param-names */\n\n      /**\n       * The internal implementation for {@link EventedState#changeState `.changeState()`}, performing actual change in state.\n       * @param {string} [state] The new state. Can be an omitted, which means toggling.\n       * @param {object} [detail]\n       *   The object that should be put to event details that is fired before/after changing state.\n       *   Can have a `group` property, which specifies what state to be changed.\n       * @param {EventedState~changeStateCallback} callback The callback called once changing state is finished or is canceled.\n       * @private\n       */\n      function _changeState() {\n        throw new Error('_changeState() should be overridden to perform actual change in state.');\n      }\n      /**\n       * Changes the state of this component.\n       * @param {string} [state] The new state. Can be an omitted, which means toggling.\n       * @param {object} [detail]\n       *   The object that should be put to event details that is fired before/after changing state.\n       *   Can have a `group` property, which specifies what state to be changed.\n       * @param {EventedState~changeStateCallback} [callback] The callback called once changing state is finished or is canceled.\n       */\n\n    }, {\n      key: \"changeState\",\n      value: function changeState() {\n        var _this = this;\n\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        var state = typeof args[0] === 'string' ? args.shift() : undefined;\n        var detail = Object(args[0]) === args[0] && typeof args[0] !== 'function' ? args.shift() : undefined;\n        var callback = typeof args[0] === 'function' ? args.shift() : undefined;\n\n        if (typeof this.shouldStateBeChanged === 'function' && !this.shouldStateBeChanged(state, detail)) {\n          if (callback) {\n            callback(null, true);\n          }\n\n          return;\n        }\n\n        var data = {\n          group: detail && detail.group,\n          state: state\n        };\n        var eventNameSuffix = [data.group, state].filter(Boolean).join('-').split('-') // Group or state may contain hyphen\n        .map(function (item) {\n          return item[0].toUpperCase() + item.substr(1);\n        }).join('');\n        var eventStart = new CustomEvent(this.options[\"eventBefore\".concat(eventNameSuffix)], {\n          bubbles: true,\n          cancelable: true,\n          detail: detail\n        });\n        var fireOnNode = detail && detail.delegatorNode || this.element;\n        var canceled = !fireOnNode.dispatchEvent(eventStart);\n\n        if (canceled) {\n          if (callback) {\n            var error = new Error(\"Changing state (\".concat(JSON.stringify(data), \") has been canceled.\"));\n            error.canceled = true;\n            callback(error);\n          }\n        } else {\n          var changeStateArgs = [state, detail].filter(Boolean);\n\n          this._changeState.apply(this, _toConsumableArray(changeStateArgs).concat([function () {\n            fireOnNode.dispatchEvent(new CustomEvent(_this.options[\"eventAfter\".concat(eventNameSuffix)], {\n              bubbles: true,\n              cancelable: true,\n              detail: detail\n            }));\n\n            if (callback) {\n              callback();\n            }\n          }]));\n        }\n      }\n      /* eslint-enable jsdoc/check-param-names */\n\n      /**\n       * Tests if change in state should happen or not.\n       * Classes inheriting {@link EventedState `EventedState`} should override this function.\n       * @function EventedState#shouldStateBeChanged\n       * @param {string} [state] The new state. Can be an omitted, which means toggling.\n       * @param {object} [detail]\n       *   The object that should be put to event details that is fired before/after changing state.\n       *   Can have a `group` property, which specifies what state to be changed.\n       * @returns {boolean}\n       *   `false` if change in state shouldn't happen, e.g. when the given new state is the same as the current one.\n       */\n\n    }]);\n\n    return EventedState;\n  }(ToMix);\n  /**\n   * The callback called once changing state is finished or is canceled.\n   * @callback EventedState~changeStateCallback\n   * @param {Error} error\n   *   An error object with `true` in its `canceled` property if changing state is canceled.\n   *   Cancellation happens if the handler of a custom event, that is fired before changing state happens,\n   *   calls `.preventDefault()` against the event.\n   * @param {boolean} keptState\n   *   `true` if the call to {@link EventedState#changeState `.changeState()`} didn't cause actual change in state.\n   */\n\n\n  return EventedState;\n}","/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * @param {Event} event The event.\n * @param {string} selector The selector.\n * @returns {Element}\n *   The closest ancestor of the event target (or the event target itself) which matches the selectors given in parameter.\n */\nexport default function eventMatches(event, selector) {\n  // <svg> in IE does not have `Element#msMatchesSelector()` (that should be copied to `Element#matches()` by a polyfill).\n  // Also a weird behavior is seen in IE where DOM tree seems broken when `event.target` is on <svg>.\n  // Therefore this function simply returns `undefined` when `event.target` is on <svg>.\n  var target = event.target,\n      currentTarget = event.currentTarget;\n\n  if (typeof target.matches === 'function') {\n    if (target.matches(selector)) {\n      // If event target itself matches the given selector, return it\n      return target;\n    }\n\n    if (target.matches(\"\".concat(selector, \" *\"))) {\n      var closest = target.closest(selector);\n\n      if ((currentTarget.nodeType === Node.DOCUMENT_NODE ? currentTarget.documentElement : currentTarget).contains(closest)) {\n        return closest;\n      }\n    }\n  }\n\n  return undefined;\n}","/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nexport default function getLaunchingDetails(evt) {\n  if (!evt || typeof evt === 'function') {\n    return {\n      launchingElement: null,\n      launchingEvent: null\n    };\n  }\n\n  var launchingElement = evt.delegateTarget || evt.currentTarget || evt;\n  var launchingEvent = evt.currentTarget && evt;\n\n  if (launchingElement && !launchingElement.nodeType) {\n    throw new TypeError('DOM Node should be given for launching element.');\n  }\n\n  if (launchingEvent && !launchingEvent.type) {\n    throw new TypeError('DOM event should be given for launching event.');\n  }\n\n  return {\n    launchingElement: launchingElement,\n    launchingEvent: launchingEvent\n  };\n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nimport eventedState from './evented-state';\nimport getLaunchingDetails from '../misc/get-launching-details';\n\nfunction eventedShowHideState(ToMix) {\n  /**\n   * Mix-in class to launch a floating menu.\n   * @class EventedShowHideState\n   */\n  var EventedShowHideState = /*#__PURE__*/function (_ToMix) {\n    _inherits(EventedShowHideState, _ToMix);\n\n    var _super = _createSuper(EventedShowHideState);\n\n    function EventedShowHideState() {\n      _classCallCheck(this, EventedShowHideState);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(EventedShowHideState, [{\n      key: \"show\",\n      value:\n      /**\n       */\n\n      /**\n       * Switch to 'shown' state.\n       * @param [evtOrElem] The launching event or element.\n       * @param {EventedState~changeStateCallback} [callback] The callback.\n       */\n      function show(evtOrElem, callback) {\n        if (!evtOrElem || typeof evtOrElem === 'function') {\n          callback = evtOrElem; // eslint-disable-line no-param-reassign\n        }\n\n        this.changeState('shown', getLaunchingDetails(evtOrElem), callback);\n      }\n      /**\n       * Switch to 'hidden' state.\n       * @param [evtOrElem] The launching event or element.\n       * @param {EventedState~changeStateCallback} [callback] The callback.\n       */\n\n    }, {\n      key: \"hide\",\n      value: function hide(evtOrElem, callback) {\n        if (!evtOrElem || typeof evtOrElem === 'function') {\n          callback = evtOrElem; // eslint-disable-line no-param-reassign\n        }\n\n        this.changeState('hidden', getLaunchingDetails(evtOrElem), callback);\n      }\n    }]);\n\n    return EventedShowHideState;\n  }(ToMix);\n\n  return EventedShowHideState;\n}\n\nvar exports = [eventedState, eventedShowHideState];\nexport default exports;","/**\n * Copyright 2014-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar warning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n        '`warning(condition, format, ...args)` requires a warning ' +\n        'message argument'\n      );\n    }\n\n    if (format.length < 10 || (/^[s\\W]*$/).test(format)) {\n      throw new Error(\n        'The warning format should be able to uniquely identify this ' +\n        'warning. Please, use a more descriptive format than: ' + format\n      );\n    }\n\n    if (!condition) {\n      var argIndex = 0;\n      var message = 'Warning: ' +\n        format.replace(/%s/g, function() {\n          return args[argIndex++];\n        });\n      if (typeof console !== 'undefined') {\n        console.error(message);\n      }\n      try {\n        // This error was thrown as a convenience so that you can use this stack\n        // to find the callsite that caused this warning to fire.\n        throw new Error(message);\n      } catch(x) {}\n    }\n  };\n}\n\nmodule.exports = warning;\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nimport eventMatches from '../misc/event-matches';\nimport on from '../misc/on';\nexport default function (ToMix) {\n  /**\n   * Mix-in class to instantiate components events on launcher button.\n   * @class InitComponentByLauncher\n   */\n  var InitComponentByLauncher = /*#__PURE__*/function (_ToMix) {\n    _inherits(InitComponentByLauncher, _ToMix);\n\n    var _super = _createSuper(InitComponentByLauncher);\n\n    function InitComponentByLauncher() {\n      _classCallCheck(this, InitComponentByLauncher);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(InitComponentByLauncher, null, [{\n      key: \"init\",\n      value:\n      /**\n       * `true` suggests that this component is lazily initialized upon an action/event, etc.\n       * @type {boolean}\n       */\n\n      /**\n       * Instantiates this component in the given element.\n       * If the given element indicates that it's an component of this class, instantiates it.\n       * Otherwise, instantiates this component by clicking on launcher buttons\n       * (buttons with attribute that `options.attribInitTarget` points to) of this component in the given node.\n       * @param {Node} target The DOM node to instantiate this component in. Should be a document or an element.\n       * @param {object} [options] The component options.\n       * @param {string} [options.selectorInit] The CSS selector to find this component.\n       * @param {string} [options.attribInitTarget] The attribute name in the launcher buttons to find target component.\n       * @returns {Handle} The handle to remove the event listener to handle clicking.\n       */\n      function init() {\n        var _this = this;\n\n        var target = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var effectiveOptions = Object.assign(Object.create(this.options), options);\n\n        if (!target || target.nodeType !== Node.ELEMENT_NODE && target.nodeType !== Node.DOCUMENT_NODE) {\n          throw new TypeError('DOM document or DOM element should be given to search for and initialize this widget.');\n        }\n\n        if (target.nodeType === Node.ELEMENT_NODE && target.matches(effectiveOptions.selectorInit)) {\n          this.create(target, options);\n        } else {\n          var handles = effectiveOptions.initEventNames.map(function (name) {\n            return on(target, name, function (event) {\n              var launcher = eventMatches(event, \"[\".concat(effectiveOptions.attribInitTarget, \"]\"));\n\n              if (launcher) {\n                event.delegateTarget = launcher; // eslint-disable-line no-param-reassign\n\n                // eslint-disable-line no-param-reassign\n                var elements = launcher.ownerDocument.querySelectorAll(launcher.getAttribute(effectiveOptions.attribInitTarget));\n\n                if (elements.length > 1) {\n                  throw new Error('Target widget must be unique.');\n                }\n\n                if (elements.length === 1) {\n                  if (launcher.tagName === 'A') {\n                    event.preventDefault();\n                  }\n\n                  var component = _this.create(elements[0], options);\n\n                  if (typeof component.createdByLauncher === 'function') {\n                    component.createdByLauncher(event);\n                  }\n                }\n              }\n            });\n          });\n          return {\n            release: function release() {\n              for (var handle = handles.pop(); handle; handle = handles.pop()) {\n                handle.release();\n              }\n            }\n          };\n        }\n\n        return '';\n      }\n    }]);\n\n    InitComponentByLauncher.forLazyInit = true;\n    return InitComponentByLauncher;\n  }(ToMix);\n\n  return InitComponentByLauncher;\n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * Copyright IBM Corp. 2016, 2018\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nimport warning from 'warning';\nimport settings from '../../globals/js/settings';\nimport mixin from '../../globals/js/misc/mixin';\nimport createComponent from '../../globals/js/mixins/create-component';\nimport initComponentByLauncher from '../../globals/js/mixins/init-component-by-launcher';\nimport eventedShowHideState from '../../globals/js/mixins/evented-show-hide-state';\nimport handles from '../../globals/js/mixins/handles';\nimport eventMatches from '../../globals/js/misc/event-matches';\nimport on from '../../globals/js/misc/on';\n\nvar Modal = /*#__PURE__*/function (_mixin) {\n  _inherits(Modal, _mixin);\n\n  var _super = _createSuper(Modal);\n  /**\n   * Modal dialog.\n   * @extends CreateComponent\n   * @extends InitComponentByLauncher\n   * @extends EventedShowHideState\n   * @extends Handles\n   * @param {HTMLElement} element The element working as a modal dialog.\n   * @param {object} [options] The component options.\n   * @param {string} [options.classVisible] The CSS class for the visible state.\n   * @param {string} [options.classBody] The CSS class for `<body>` with open modal.\n   * @param {string} [options.eventBeforeShown]\n   *   The name of the custom event fired before this modal is shown.\n   *   Cancellation of this event stops showing the modal.\n   * @param {string} [options.eventAfterShown]\n   *   The name of the custom event telling that modal is sure shown\n   *   without being canceled by the event handler named by `eventBeforeShown` option (`modal-beingshown`).\n   * @param {string} [options.eventBeforeHidden]\n   *   The name of the custom event fired before this modal is hidden.\n   *   Cancellation of this event stops hiding the modal.\n   * @param {string} [options.eventAfterHidden]\n   *   The name of the custom event telling that modal is sure hidden\n   *   without being canceled by the event handler named by `eventBeforeHidden` option (`modal-beinghidden`).\n   */\n\n\n  /**\n   * Modal dialog.\n   * @extends CreateComponent\n   * @extends InitComponentByLauncher\n   * @extends EventedShowHideState\n   * @extends Handles\n   * @param {HTMLElement} element The element working as a modal dialog.\n   * @param {object} [options] The component options.\n   * @param {string} [options.classVisible] The CSS class for the visible state.\n   * @param {string} [options.classBody] The CSS class for `<body>` with open modal.\n   * @param {string} [options.eventBeforeShown]\n   *   The name of the custom event fired before this modal is shown.\n   *   Cancellation of this event stops showing the modal.\n   * @param {string} [options.eventAfterShown]\n   *   The name of the custom event telling that modal is sure shown\n   *   without being canceled by the event handler named by `eventBeforeShown` option (`modal-beingshown`).\n   * @param {string} [options.eventBeforeHidden]\n   *   The name of the custom event fired before this modal is hidden.\n   *   Cancellation of this event stops hiding the modal.\n   * @param {string} [options.eventAfterHidden]\n   *   The name of the custom event telling that modal is sure hidden\n   *   without being canceled by the event handler named by `eventBeforeHidden` option (`modal-beinghidden`).\n   */\n  function Modal(element, options) {\n    var _this;\n\n    _classCallCheck(this, Modal);\n\n    _this = _super.call(this, element, options);\n    _this._handleFocusinListener = void 0;\n    _this._handleKeydownListener = void 0;\n\n    _this._handleFocusin = function (evt) {\n      var focusWrapNode = _this.element.querySelector(_this.options.selectorModalContainer) || _this.element;\n\n      if (_this.element.classList.contains(_this.options.classVisible) && !focusWrapNode.contains(evt.target) && _this.options.selectorsFloatingMenus.every(function (selector) {\n        return !eventMatches(evt, selector);\n      })) {\n        _this.element.querySelector(settings.selectorTabbable).focus();\n      }\n    };\n\n    _this._hookCloseActions();\n\n    return _this;\n  }\n  /**\n   * The handle for `focusin` event listener.\n   * Used for \"focus-wrap\" feature.\n   * @type {Handle}\n   * @private\n   */\n\n\n  /**\n   * The handle for `focusin` event listener.\n   * Used for \"focus-wrap\" feature.\n   * @type {Handle}\n   * @private\n   */\n  _createClass(Modal, [{\n    key: \"createdByLauncher\",\n    value:\n    /**\n     * A method that runs when `.init()` is called from `initComponentByLauncher`.\n     * @param {Event} evt The event fired on the launcher button.\n     */\n    function createdByLauncher(evt) {\n      this.show(evt);\n    }\n    /**\n     * Determines whether or not to emit events and callback function when `.changeState()` is called from `eventedState`.\n     * @param {string} state The new state.\n     * @returns {boolean} `true` if the given `state` is different from current state.\n     */\n\n  }, {\n    key: \"shouldStateBeChanged\",\n    value: function shouldStateBeChanged(state) {\n      if (state === 'shown') {\n        return !this.element.classList.contains(this.options.classVisible);\n      }\n\n      return this.element.classList.contains(this.options.classVisible);\n    }\n    /**\n     * Changes the shown/hidden state.\n     * @private\n     * @param {string} state The new state.\n     * @param {object} detail The detail data to be included in the event that will be fired.\n     * @param {Function} callback Callback called when change in state completes.\n     */\n\n  }, {\n    key: \"_changeState\",\n    value: function _changeState(state, detail, callback) {\n      var _this2 = this;\n\n      var handleTransitionEnd;\n\n      var transitionEnd = function transitionEnd() {\n        if (handleTransitionEnd) {\n          handleTransitionEnd = _this2.unmanage(handleTransitionEnd).release();\n        }\n\n        if (state === 'shown' && _this2.element.offsetWidth > 0 && _this2.element.offsetHeight > 0) {\n          _this2.previouslyFocusedNode = _this2.element.ownerDocument.activeElement;\n\n          var focusableItem = _this2.element.querySelector(_this2.options.selectorPrimaryFocus) || _this2.element.querySelector(settings.selectorTabbable);\n\n          focusableItem.focus();\n\n          if (process.env.NODE_ENV !== \"production\") {\n            process.env.NODE_ENV !== \"production\" ? warning(focusableItem, \"Modals need to contain a focusable element by either using \" + \"`\".concat(_this2.options.selectorPrimaryFocus, \"` or settings.selectorTabbable.\")) : void 0;\n          }\n        }\n\n        callback();\n      };\n\n      if (this._handleFocusinListener) {\n        this._handleFocusinListener = this.unmanage(this._handleFocusinListener).release();\n      }\n\n      if (state === 'shown') {\n        var hasFocusin = ('onfocusin' in this.element.ownerDocument.defaultView);\n        var focusinEventName = hasFocusin ? 'focusin' : 'focus';\n        this._handleFocusinListener = this.manage(on(this.element.ownerDocument, focusinEventName, this._handleFocusin, !hasFocusin));\n      }\n\n      if (state === 'hidden') {\n        this.element.classList.toggle(this.options.classVisible, false);\n        this.element.ownerDocument.body.classList.toggle(this.options.classBody, false);\n\n        if (this.options.selectorFocusOnClose || this.previouslyFocusedNode) {\n          (this.element.ownerDocument.querySelector(this.options.selectorFocusOnClose) || this.previouslyFocusedNode).focus();\n        }\n      } else if (state === 'shown') {\n        this.element.classList.toggle(this.options.classVisible, true);\n        this.element.ownerDocument.body.classList.toggle(this.options.classBody, true);\n      }\n\n      handleTransitionEnd = this.manage(on(this.element, 'transitionend', transitionEnd));\n    }\n  }, {\n    key: \"_hookCloseActions\",\n    value: function _hookCloseActions() {\n      var _this3 = this;\n\n      this.manage(on(this.element, 'click', function (evt) {\n        var closeButton = eventMatches(evt, _this3.options.selectorModalClose);\n\n        if (closeButton) {\n          evt.delegateTarget = closeButton; // eslint-disable-line no-param-reassign\n        }\n\n        if (closeButton || evt.target === _this3.element) {\n          _this3.hide(evt);\n        }\n      }));\n\n      if (this._handleKeydownListener) {\n        this._handleKeydownListener = this.unmanage(this._handleKeydownListener).release();\n      }\n\n      this._handleKeydownListener = this.manage(on(this.element.ownerDocument.body, 'keydown', function (evt) {\n        // Avoid running `evt.stopPropagation()` only when modal is shown\n        if (evt.which === 27 && _this3.shouldStateBeChanged('hidden')) {\n          evt.stopPropagation();\n\n          _this3.hide(evt);\n        }\n      }));\n    }\n    /**\n     * Handles `focusin` (or `focus` depending on browser support of `focusin`) event to do wrap-focus behavior.\n     * @param {Event} evt The event.\n     * @private\n     */\n\n  }], [{\n    key: \"options\",\n    get:\n    /**\n     * The component options.\n     * If `options` is specified in the constructor, {@linkcode Modal.create .create()}, or {@linkcode Modal.init .init()},\n     * properties in this object are overridden for the instance being create and how {@linkcode Modal.init .init()} works.\n     * @member Modal.options\n     * @type {object}\n     * @property {string} selectorInit The CSS class to find modal dialogs.\n     * @property {string} [selectorModalClose] The selector to find elements that close the modal.\n     * @property {string} [selectorPrimaryFocus] The CSS selector to determine the element to put focus when modal gets open.\n     * @property {string} [selectorFocusOnClose] The CSS selector to determine the element to put focus when modal closes.\n     *   If undefined, focus returns to the previously focused element prior to the modal opening.\n     * @property {string} [selectorModalContainer] The CSS selector for the content container of the modal for focus wrap feature.\n     * @property {string} attribInitTarget The attribute name in the launcher buttons to find target modal dialogs.\n     * @property {string[]} [selectorsFloatingMenu]\n     *   The CSS selectors of floating menus.\n     *   Used for detecting if focus-wrap behavior should be disabled temporarily.\n     * @property {string} [classVisible] The CSS class for the visible state.\n     * @property {string} [classBody] The CSS class for `<body>` with open modal.\n     * @property {string} [classNoScroll] The CSS class for hiding scroll bar in body element while modal is shown.\n     * @property {string} [eventBeforeShown]\n     *   The name of the custom event fired before this modal is shown.\n     *   Cancellation of this event stops showing the modal.\n     * @property {string} [eventAfterShown]\n     *   The name of the custom event telling that modal is sure shown\n     *   without being canceled by the event handler named by `eventBeforeShown` option (`modal-beingshown`).\n     * @property {string} [eventBeforeHidden]\n     *   The name of the custom event fired before this modal is hidden.\n     *   Cancellation of this event stops hiding the modal.\n     * @property {string} [eventAfterHidden]\n     *   The name of the custom event telling that modal is sure hidden\n     *   without being canceled by the event handler named by `eventBeforeHidden` option (`modal-beinghidden`).\n     */\n    function get() {\n      var prefix = settings.prefix;\n      return {\n        selectorInit: '[data-modal]',\n        selectorModalClose: '[data-modal-close]',\n        selectorPrimaryFocus: '[data-modal-primary-focus]',\n        selectorsFloatingMenus: [\".\".concat(prefix, \"--overflow-menu-options\"), \".\".concat(prefix, \"--tooltip\"), '.flatpickr-calendar'],\n        selectorModalContainer: \".\".concat(prefix, \"--modal-container\"),\n        classVisible: 'is-visible',\n        classBody: \"\".concat(prefix, \"--body--with-modal-open\"),\n        attribInitTarget: 'data-modal-target',\n        initEventNames: ['click'],\n        eventBeforeShown: 'modal-beingshown',\n        eventAfterShown: 'modal-shown',\n        eventBeforeHidden: 'modal-beinghidden',\n        eventAfterHidden: 'modal-hidden'\n      };\n    }\n  }]);\n\n  Modal.components = new WeakMap();\n  return Modal;\n}(mixin(createComponent, initComponentByLauncher, eventedShowHideState, handles));\n\nexport default Modal;","import { select, type Selection } from 'd3'\nimport { get } from 'lodash-es'\nimport { Modal as CarbonModalComponent } from 'carbon-components' // /es/components/modal\nimport { getProperty } from '@/tools'\nimport { carbonPrefix } from '@/configuration-non-customizable' // CSS prefix\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModel } from '@/model/model'\nimport type { ChartOptions } from '@/interfaces/charts'\nimport { Events } from '@/interfaces/enums'\nimport { sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Modal extends Component {\n\ttype = 'modal'\n\n\t// flag for checking whether tooltip event listener is added or not\n\tisEventListenerAdded = false\n\tmodal: any\n\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\n\t\tthis.init()\n\t}\n\n\thandleShowModal = () => {\n\t\tconst id = this.services.domUtils.getChartID()\n\t\tthis.modal\n\t\t\t.attr('data-modal', true)\n\t\t\t.attr('class', 'cds--modal')\n\t\t\t.attr('role', 'dialog')\n\t\t\t.attr('aria-modal', true)\n\t\t\t.attr('aria-labelledby', `${id}__modal-title`)\n\t\t\t.attr('aria-describedby', `${id}__modal-description`)\n\t\t\t.attr('tabindex', -1)\n\n\t\tthis.modal.html(this.getModalHTML())\n\t\tthis.modal\n\t\t\t.select('div.cds--modal-footer button.cds--btn')\n\t\t\t.on('click', () => this.model.exportToCSV())\n\n\t\tconst modalInstance = CarbonModalComponent.create(this.modal.node())\n\t\tmodalInstance.show()\n\n\t\t//catches when modal gets closed\n\t\tdocument.addEventListener('modal-hidden', this.handleHideModal)\n\t}\n\n\thandleHideModal = () => {\n\t\tthis.modal\n\t\t\t.attr('role', null)\n\t\t\t.attr('aria-modal', null)\n\t\t\t.attr('aria-labelledby', null)\n\t\t\t.attr('aria-describedby', null)\n\t\t\t.attr('tabindex', null)\n\n\t\t//removes event listener when modal is closed\n\t\tdocument.removeEventListener('modal-hidden', this.handleHideModal)\n\t}\n\n\taddEventListeners() {\n\t\t// listen to show-modal Custom Events to render the modal\n\t\tthis.services.events.addEventListener(Events.Modal.SHOW, this.handleShowModal)\n\t}\n\n\tremoveEventListeners() {\n\t\t// remove show-modal Custom Events\n\t\tthis.services.events.removeEventListener(Events.Modal.SHOW, this.handleShowModal)\n\t}\n\n\tgetModalHTML() {\n\t\tconst id = this.services.domUtils.getChartID()\n\n\t\tconst options = this.model.getOptions()\n\n\t\tconst { title, downloadAsCSV } = getProperty(options, 'locale', 'translations', 'tabularRep')\n\n\t\tconst chartprefix = getProperty(options, 'style', 'prefix')\n\n\t\tconst tableArray = this.model.getTabularDataArray()\n\n\t\treturn `\n\t\t<div class=\"cds--modal-container\">\n\t\t\t<div class=\"cds--modal-header\">\n\n\t\t\t\t<p class=\"cds--modal-header__label cds--type-delta\" id=\"modal-title\">${title}</p>\n\n\t\t\t\t<p class=\"cds--modal-header__heading cds--type-beta\" id=\"${id}__modal-description\">${sanitizeText(\n\t\t\t\t\toptions.title\n\t\t\t\t)}</p>\n\n\t\t\t\t<button class=\"cds--modal-close\" type=\"button\" data-modal-close aria-label=\"close modal\"  data-modal-primary-focus>\n\t\t\t\t\t<svg focusable=\"false\" preserveAspectRatio=\"xMidYMid meet\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" aria-label=\"Close\" width=\"20\" height=\"20\" viewBox=\"0 0 32 32\" role=\"img\" class=\"cds--modal-close__icon\">\n\t\t\t\t\t\t<path d=\"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z\"></path>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class=\"cds--modal-content\">\n\t\t\t\t<table class=\"cds--data-table cds--data-table--no-border\">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t${get(tableArray, 0)\n\t\t\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t\t\t(heading: any) => `<th scope=\"col\">\n\t\t\t\t\t\t\t\t<div class=\"cds--table-header-label\">${sanitizeText(heading)}</div>\n\t\t\t\t\t\t\t</th>`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join('')}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\n\t\t\t\t\t<tbody>${tableArray\n\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t.map(\n\t\t\t\t\t\t\t(row: any) => `\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t${row.map((column: any) => `<td>${sanitizeText(column)}</td>`).join('')}\n\t\t\t\t\t\t\t</tr>`\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.join('')}\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div class=\"cds--modal-footer\">\n\t\t\t  <div class=\"${carbonPrefix}--${chartprefix}-modal-footer-spacer\"></div>\n\t\t\t  <button class=\"cds--btn cds--btn--primary\" type=\"button\" data-modal-primary-focus>${downloadAsCSV}</button>\n\t\t\t</div>\n\t\t</div>`\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst options = this.model.getOptions() as ChartOptions\n\t\tif (!this.isEventListenerAdded) {\n\t\t\t// Grab the tooltip element\n\t\t\tconst holder = select(this.services.domUtils.getHolder()) as Selection<\n\t\t\t\tHTMLDivElement,\n\t\t\t\tany,\n\t\t\t\tElement,\n\t\t\t\tany\n\t\t\t>\n\t\t\tconst chartprefix = getProperty(options, 'style', 'prefix') as string\n\t\t\tthis.modal = DOMUtils.appendOrSelect(holder, `div.${carbonPrefix}--${chartprefix}--modal`)\n\n\t\t\tthis.addEventListeners()\n\t\t\tthis.isEventListenerAdded = true\n\t\t}\n\t}\n\n\tdestroy() {\n\t\t// remove tooltip eventListener\n\t\tthis.removeEventListeners()\n\t\tthis.isEventListenerAdded = false\n\t}\n}\n","import type { Selection } from 'd3'\nimport { getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, RenderTypes } from '@/interfaces/enums'\nimport { sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Title extends Component {\n\ttype = 'title'\n\trenderType = RenderTypes.HTML\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst title = getProperty(this.getOptions(), 'title')\n\n\t\tconst text = svg.selectAll('p.title').data([title]) as Selection<\n\t\t\tHTMLParagraphElement,\n\t\t\tany,\n\t\t\tElement,\n\t\t\tany\n\t\t>\n\n\t\ttext\n\t\t\t.enter()\n\t\t\t.append('p')\n\t\t\t.classed('title', true)\n\t\t\t.attr('role', 'heading')\n\t\t\t.attr('aria-level', 2)\n\t\t\t.merge(text as any)\n\t\t\t.html((d: any) => sanitizeText(d))\n\n\t\t// check if title needs truncation (and tooltip support)\n\t\tif (text.node() && text.node().offsetWidth < text.node().scrollWidth) {\n\t\t\t// add events for displaying the tooltip with the title\n\t\t\tconst self = this\n\t\t\ttext\n\t\t\t\t.on('mouseover', function (event: MouseEvent) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement: text,\n\t\t\t\t\t\tcontent: text.text()\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('mousemove', function (event: MouseEvent) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function () {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t})\n\t\t}\n\n\t\ttext.exit().remove()\n\t}\n\n\t/**\n\t * Truncates title creating ellipses and attaching tooltip for exposing full title.\n\t */\n\ttruncateTitle(title: any, maxWidth: number) {\n\t\t// sanity check to prevent stack overflow on binary search\n\t\tif (maxWidth <= 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst untruncatedTitle = title.text()\n\t\t// check if the title is too big for the containing svg\n\t\tif (title.node().getComputedTextLength() > maxWidth) {\n\t\t\t// append the ellipses to their own tspan to calculate the text length\n\t\t\ttitle.append('tspan').text('...')\n\n\t\t\t// get the bounding width including the elipses '...'\n\t\t\tconst tspanLength = DOMUtils.appendOrSelect(title, 'tspan').node().getComputedTextLength()\n\n\t\t\t// with elipses\n\t\t\tconst titleString = title.text()\n\n\t\t\t// get the index for creating the max length substring that fit within the svg\n\t\t\t// use one less than the index to avoid crowding (the elipsis)\n\t\t\tconst substringIndex = this.getSubstringIndex(\n\t\t\t\ttitle.node(),\n\t\t\t\t0,\n\t\t\t\ttitleString.length - 1,\n\t\t\t\tmaxWidth - tspanLength\n\t\t\t)\n\n\t\t\t// use the substring as the title\n\t\t\ttitle\n\t\t\t\t.html(titleString.substring(0, substringIndex - 1))\n\t\t\t\t.append('tspan')\n\t\t\t\t.text('...')\n\n\t\t\t// add events for displaying the tooltip with the title\n\t\t\tconst self = this\n\t\t\ttitle\n\t\t\t\t.on('mouseover', function (event: MouseEvent) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement: title,\n\t\t\t\t\t\tcontent: untruncatedTitle\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('mousemove', function (event: MouseEvent) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function () {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t})\n\t\t}\n\t}\n\n\t// computes the maximum space a title can take\n\tprotected getMaxTitleWidth() {\n\t\treturn DOMUtils.getSVGElementSize(this.parent.node() as any, {\n\t\t\tuseAttrs: true\n\t\t}).width\n\t}\n\n\t/**\n\t * Returns the index for a maximum length substring that is less than the width parameter.\n\t * @param title the title node used for getting the text lengths of substrings\n\t * @param start the start index for the binary search\n\t * @param end the end index for the binary search\n\t * @param width the width of the svg container that holds the title\n\t */\n\tprotected getSubstringIndex(title: any, start: number, end: number, width: number): number {\n\t\tconst mid = Math.floor((end + start) / 2)\n\t\tif (title.getSubStringLength(0, mid) > width) {\n\t\t\treturn this.getSubstringIndex(title, start, mid, width)\n\t\t} else if (title.getSubStringLength(0, mid) < width) {\n\t\t\tif (title.getSubStringLength(0, mid + 1) > width) {\n\t\t\t\treturn mid\n\t\t\t}\n\t\t\treturn this.getSubstringIndex(title, mid, end, width)\n\t\t} else {\n\t\t\treturn mid\n\t\t}\n\t}\n}\n","import { select } from 'd3'\nimport { getProperty, truncateLabel } from '@/tools'\nimport { legend as legendConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport {\n\tAlignments,\n\tColorClassNameTypes,\n\tLegendItemType,\n\tRenderTypes,\n\tEvents,\n\tTruncationTypes\n} from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport { sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Legend extends Component {\n\ttype = 'legend'\n\trenderType = RenderTypes.HTML\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst options = this.getOptions()\n\t\tconst legendOptions = getProperty(options, 'legend')\n\t\tconst alignment = getProperty(legendOptions, 'alignment')\n\n\t\tconst legendOrientation = getProperty(options, 'legend', 'orientation')\n\n\t\tlet dataGroups = this.model.getDataGroups()\n\n\t\t// Check if there are disabled legend items\n\t\tconst { DISABLED } = legendConfigs.items.status\n\t\tconst hasDeactivatedItems = dataGroups.some((dataGroup: any) => dataGroup.status === DISABLED)\n\t\tconst userProvidedOrder = getProperty(legendOptions, 'order')\n\n\t\tconst svg = this.getComponentContainer()\n\t\t\t.classed('center-aligned', alignment === Alignments.CENTER)\n\t\t\t.classed('right-aligned', alignment === Alignments.RIGHT)\n\t\t\t.classed(legendOrientation, true)\n\t\t\t.classed('has-deactivated-items', hasDeactivatedItems)\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('aria-label', 'Data groups')\n\t\t\t.attr('data-name', 'legend-items')\n\n\t\tif (userProvidedOrder) {\n\t\t\tdataGroups = this.sortDataGroups(dataGroups, userProvidedOrder)\n\t\t}\n\n\t\tconst legendItems = svg\n\t\t\t.selectAll('div.legend-item')\n\t\t\t.data(dataGroups, (dataGroup: any) => dataGroup.name)\n\n\t\tconst addedLegendItems = legendItems.enter().append('div').attr('class', 'legend-item')\n\n\t\taddedLegendItems.merge(svg.selectAll('div.legend-item')).classed('active', function (d: any) {\n\t\t\treturn d.status === legendConfigs.items.status.ACTIVE\n\t\t})\n\n\t\tconst legendClickable = getProperty(this.getOptions(), 'legend', 'clickable')\n\t\tsvg.classed('clickable', legendClickable && dataGroups.length > 1)\n\n\t\tconst checkboxRadius = legendConfigs.checkbox.radius\n\n\t\tconst addedCheckboxes = addedLegendItems.append('div').classed('checkbox', true)\n\n\t\tconst allCheckboxes = addedCheckboxes\n\t\t\t.merge(legendItems.select('div.checkbox'))\n\t\t\t.attr('role', Roles.CHECKBOX)\n\t\t\t.attr('tabindex', legendClickable ? 0 : -1)\n\t\t\t.attr('aria-labelledby', (_: any, i: number) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`legend-datagroup-${i}-title`)\n\t\t\t)\n\t\t\t.attr('aria-checked', ({ status }) => status === legendConfigs.items.status.ACTIVE)\n\t\t\t.attr('width', checkboxRadius * 2)\n\t\t\t.attr('height', checkboxRadius * 2)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.BACKGROUND],\n\t\t\t\t\tdataGroupName: d.name,\n\t\t\t\t\toriginalClassName: 'checkbox'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('background', (d: any) =>\n\t\t\t\td.status === legendConfigs.items.status.ACTIVE\n\t\t\t\t\t? this.model.getFillColor(d.name) || this.model.getStrokeColor(d.name)\n\t\t\t\t\t: null\n\t\t\t)\n\t\t\t.classed('active', function (d: any) {\n\t\t\t\treturn d.status === legendConfigs.items.status.ACTIVE\n\t\t\t})\n\n\t\taddedCheckboxes\n\t\t\t.append('svg')\n\t\t\t.attr('focusable', false)\n\t\t\t.attr('preserveAspectRatio', 'xMidYMid meet')\n\t\t\t.attr('xmlns', 'http://www.w3.org/2000/svg')\n\t\t\t.attr('width', '11')\n\t\t\t.attr('height', '11')\n\t\t\t.attr('viewBox', '0 0 31 28')\n\t\t\t.attr('aria-hidden', true)\n\t\t\t.style('will-change', 'transform')\n\t\t\t.append('path')\n\t\t\t.attr('d', 'M13 21.2l-7.1-7.1-1.4 1.4 7.1 7.1L13 24 27.1 9.9l-1.4-1.5z')\n\n\t\taddedLegendItems.append('p').merge(legendItems.select('p'))\n\n\t\tconst additionalItemsOption = getProperty(options, 'legend', 'additionalItems')\n\n\t\t// add additional legend items\n\t\tif (additionalItemsOption && dataGroups.length) {\n\t\t\tconst self = this\n\n\t\t\tconst additionalItems = svg.selectAll('div.additional-item').data(additionalItemsOption)\n\n\t\t\tadditionalItems.exit().remove()\n\n\t\t\tconst addedAdditionalItems = additionalItems\n\t\t\t\t.enter()\n\t\t\t\t.append('div')\n\t\t\t\t.merge(additionalItems as any)\n\t\t\t\t.classed('legend-item', true)\n\t\t\t\t.classed('additional', true)\n\t\t\t\t.attr('aria-labelledby', (_: any, i: number) =>\n\t\t\t\t\tthis.services.domUtils.generateElementIDString(\n\t\t\t\t\t\t`legend-datagroup-${allCheckboxes.size() + i}-title`\n\t\t\t\t\t)\n\t\t\t\t)\n\n\t\t\t// remove nested child elements that no longer needed\n\t\t\taddedAdditionalItems.selectAll('*').remove()\n\n\t\t\t// get index of item with same type to assign distinct classname\n\t\t\tlet previousType: any\n\t\t\tlet indexOfItem = 1\n\n\t\t\t// add different type of legend items\n\t\t\taddedAdditionalItems\n\t\t\t\t.append('svg')\n\t\t\t\t.classed('icon', true)\n\t\t\t\t.each(function (d: any) {\n\t\t\t\t\tconst additionalItem = select(this)\n\n\t\t\t\t\tif (!previousType || previousType != d.type) {\n\t\t\t\t\t\tpreviousType = d.type\n\t\t\t\t\t\tindexOfItem = 1\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindexOfItem++\n\t\t\t\t\t}\n\n\t\t\t\t\tself.addAdditionalItem(additionalItem, d, indexOfItem)\n\t\t\t\t})\n\n\t\t\taddedAdditionalItems.append('p').merge(addedAdditionalItems.select('p'))\n\n\t\t\tthis.truncateLegendText()\n\t\t}\n\n\t\t// Remove old elements as needed.\n\t\tlegendItems.exit().on('mouseover', null).on('click', null).on('mouseout', null).remove()\n\n\t\tif (legendClickable && addedLegendItems.size() > 1) {\n\t\t\tthis.addEventListeners()\n\t\t}\n\t}\n\n\tsortDataGroups(dataGroups: any, legendOrder: any) {\n\t\t// Sort data in user defined order\n\t\tdataGroups.sort(\n\t\t\t(dataA: { name: string }, dataB: { name: string }) =>\n\t\t\t\tlegendOrder.indexOf(dataA.name) - legendOrder.indexOf(dataB.name)\n\t\t)\n\n\t\t// If user only defined partial ordering, ordered items are placed before unordered ones\n\t\tif (legendOrder.length < dataGroups.length) {\n\t\t\tconst definedOrderIndex = dataGroups.length - legendOrder.length\n\t\t\tconst definedOrder = dataGroups.slice(definedOrderIndex)\n\n\t\t\treturn definedOrder.concat(dataGroups.slice(0, definedOrderIndex))\n\t\t}\n\t\treturn dataGroups\n\t}\n\n\taddAdditionalItem(additionalItem: any, itemConfig: any, indexOfItem: any) {\n\t\tconst { width, height } = legendConfigs.area\n\n\t\tif (itemConfig.type === LegendItemType.RADIUS) {\n\t\t\t// Circular icon\n\t\t\tadditionalItem.style('width', `${height}px`).style('height', `${height}px`)\n\t\t} else {\n\t\t\tadditionalItem.style('width', `${width}px`).style('height', `${height}px`)\n\t\t}\n\n\t\tif (itemConfig.type === LegendItemType.RADIUS) {\n\t\t\tconst { iconData, fill, stroke } = legendConfigs.radius\n\n\t\t\tconst circleEnter = additionalItem\n\t\t\t\t.attr('fill', 'none')\n\t\t\t\t.selectAll('circle')\n\t\t\t\t.data(iconData)\n\t\t\t\t.enter()\n\n\t\t\tcircleEnter\n\t\t\t\t.append('circle')\n\t\t\t\t.classed('radius', true)\n\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t.attr('aria-label', 'radius')\n\t\t\t\t.attr('cx', (d: any) => d.cx)\n\t\t\t\t.attr('cy', (d: any) => d.cy)\n\t\t\t\t.attr('r', (d: any) => d.r)\n\t\t\t\t.style('fill', itemConfig.fill ? itemConfig.fill : fill)\n\t\t\t\t.style('stroke', itemConfig.stroke ? itemConfig.stroke : stroke)\n\t\t} else if (itemConfig.type === LegendItemType.LINE) {\n\t\t\tconst lineConfig = legendConfigs.line\n\n\t\t\tif (additionalItem.select('line.line').empty()) {\n\t\t\t\tadditionalItem\n\t\t\t\t\t.append('line')\n\t\t\t\t\t.classed(`line-${indexOfItem}`, true)\n\t\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t\t.attr('aria-label', 'line')\n\t\t\t\t\t.attr('x1', 0)\n\t\t\t\t\t.attr('y1', lineConfig.yPosition)\n\t\t\t\t\t.attr('x2', width)\n\t\t\t\t\t.attr('y2', lineConfig.yPosition)\n\t\t\t\t\t.style('stroke', itemConfig.stroke ? itemConfig.stroke : lineConfig.stroke)\n\t\t\t\t\t.style('stroke-width', lineConfig.strokeWidth)\n\t\t\t}\n\t\t} else if (itemConfig.type === LegendItemType.AREA) {\n\t\t\tif (additionalItem.select('rect.area').empty()) {\n\t\t\t\tadditionalItem\n\t\t\t\t\t.append('rect')\n\t\t\t\t\t.classed(`area-${indexOfItem}`, true)\n\t\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t\t.attr('aria-label', 'area')\n\t\t\t\t\t.attr('width', width)\n\t\t\t\t\t.attr('height', height)\n\t\t\t\t\t.style(\n\t\t\t\t\t\t'fill',\n\t\t\t\t\t\tindexOfItem > 3 && !itemConfig.fill ? legendConfigs.area.fill : itemConfig.fill\n\t\t\t\t\t)\n\t\t\t\t\t.style('stroke', itemConfig.stroke)\n\t\t\t}\n\t\t} else if (itemConfig.type === LegendItemType.SIZE) {\n\t\t\tconst { iconData, fill, stroke } = legendConfigs.size\n\n\t\t\tconst sizeEnter = additionalItem\n\t\t\t\t.attr('fill', 'none')\n\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t.attr('aria-label', 'size')\n\t\t\t\t.selectAll('rect')\n\t\t\t\t.data(iconData)\n\t\t\t\t.enter()\n\n\t\t\tsizeEnter\n\t\t\t\t.append('rect')\n\t\t\t\t.classed('size', true)\n\t\t\t\t.attr('width', (d: any) => d.width)\n\t\t\t\t.attr('height', (d: any) => d.height)\n\t\t\t\t.attr('y', () => 0)\n\t\t\t\t.style('fill', itemConfig.fill ? itemConfig.fill : fill)\n\t\t\t\t.style('stroke', itemConfig.stroke ? itemConfig.stroke : stroke)\n\t\t\t\t.style('stroke-width', 1)\n\t\t} else if (itemConfig.type === LegendItemType.QUARTILE) {\n\t\t\tconst { iconData } = legendConfigs.quartile\n\n\t\t\tconst quartileEnter = additionalItem\n\t\t\t\t.selectAll('rect')\n\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t.attr('aria-label', 'quartile')\n\t\t\t\t.data(iconData)\n\t\t\t\t.enter()\n\n\t\t\tquartileEnter\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('class', (_: any, i: number) => `quartile-${i === 0 ? 'wrapper' : 'line'}`)\n\t\t\t\t.attr('x', (d: any) => d.x)\n\t\t\t\t.attr('y', (d: any) => d.y)\n\t\t\t\t.attr('width', (d: any) => d.width)\n\t\t\t\t.attr('height', (d: any) => d.height)\n\t\t} else if (itemConfig.type === LegendItemType.ZOOM) {\n\t\t\tconst { iconData, color } = getProperty(legendConfigs, 'zoom')\n\n\t\t\tconst zoomEnter = additionalItem\n\t\t\t\t.attr('role', Roles.IMG)\n\t\t\t\t.attr('aria-label', 'zoom')\n\t\t\t\t.selectAll('g.icon')\n\t\t\t\t.data(iconData)\n\t\t\t\t.enter()\n\n\t\t\t// add '+' for the magnifying icon\n\t\t\tzoomEnter\n\t\t\t\t.append('g')\n\t\t\t\t.attr('x', (d: any) => d.x)\n\t\t\t\t.attr('y', (d: any) => d.y)\n\t\t\t\t.attr('width', (d: any) => d.width)\n\t\t\t\t.attr('height', (d: any) => d.height)\n\t\t\t\t.append('polygon')\n\t\t\t\t.attr(\n\t\t\t\t\t'points',\n\t\t\t\t\t'7.7 4.82 5.78 4.82 5.78 2.89 4.82 2.89 4.82 4.82 2.89 4.82 2.89 5.78 4.82 5.78 4.82 7.7 5.78 7.7 5.78 5.78 7.7 5.78 7.7 4.82'\n\t\t\t\t)\n\t\t\t\t.attr('fill', () => (itemConfig.color ? itemConfig.color : color))\n\n\t\t\t// add the magnifying zoom icon handle/circle\n\t\t\tzoomEnter\n\t\t\t\t.append('path')\n\t\t\t\t.attr(\n\t\t\t\t\t'd',\n\t\t\t\t\t'M9.36,8.67A5.22,5.22,0,0,0,10.59,5.3,5.3,5.3,0,1,0,5.3,10.59,5.22,5.22,0,0,0,8.67,9.36L12.32,13l.68-.68Zm-4.06,1A4.34,4.34,0,1,1,9.63,5.3,4.33,4.33,0,0,1,5.3,9.63Z'\n\t\t\t\t)\n\t\t\t\t.attr('fill', () => (itemConfig.color ? itemConfig.color : color))\n\t\t}\n\t}\n\n\ttruncateLegendText() {\n\t\tconst svg = this.getComponentContainer()\n\n\t\tconst truncationOptions = getProperty(this.getOptions(), 'legend', 'truncation')\n\t\t// Truncation\n\t\t// get user provided custom values for truncation\n\t\tconst truncationType = getProperty(truncationOptions, 'type')\n\t\tconst truncationThreshold = getProperty(truncationOptions, 'threshold')\n\t\tconst truncationNumCharacter = getProperty(truncationOptions, 'numCharacter')\n\n\t\tconst addedLegendItemsText = svg.selectAll('div.legend-item p')\n\n\t\t// Add an ID for the checkbox to use through `aria-labelledby`\n\t\taddedLegendItemsText.attr('id', function () {\n\t\t\tconst elementToReference: any =\n\t\t\t\t(this as any).parentNode.querySelector('div.checkbox') || (this as any).parentNode\n\n\t\t\treturn elementToReference.getAttribute('aria-labelledby')\n\t\t})\n\n\t\t// truncate the legend label if it's too long\n\t\tif (truncationType !== TruncationTypes.NONE) {\n\t\t\taddedLegendItemsText.html(function (d: any) {\n\t\t\t\tconst _sanitizedLabel = sanitizeText(d.name)\n\t\t\t\tif (\n\t\t\t\t\t_sanitizedLabel.length > truncationThreshold &&\n\t\t\t\t\t_sanitizedLabel.length !== truncationNumCharacter\n\t\t\t\t) {\n\t\t\t\t\treturn truncateLabel(_sanitizedLabel, truncationType, truncationNumCharacter)\n\t\t\t\t} else {\n\t\t\t\t\treturn _sanitizedLabel\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\taddedLegendItemsText.html((d: any) => sanitizeText(d.name))\n\t\t}\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\t\tconst legendOptions = getProperty(options, 'legend')\n\t\tconst truncation = getProperty(legendOptions, 'truncation')\n\n\t\tsvg\n\t\t\t.selectAll('div.legend-item')\n\t\t\t.on('mouseover', function (event: MouseEvent) {\n\t\t\t\tself.services.events.dispatchEvent(Events.Legend.ITEM_HOVER, {\n\t\t\t\t\thoveredElement: select(this)\n\t\t\t\t})\n\n\t\t\t\tconst hoveredItem = select(this)\n\t\t\t\thoveredItem.select('div.checkbox').classed('hovered', true)\n\n\t\t\t\t// Show tooltip if character length is greater than threshold & there is no truncation\n\t\t\t\tconst hoveredItemData = hoveredItem.datum() as any\n\t\t\t\tif (\n\t\t\t\t\thoveredItemData.name.length > truncation.threshold &&\n\t\t\t\t\ttruncation.numCharacter < hoveredItemData.name.length &&\n\t\t\t\t\ttruncation.type !== TruncationTypes.NONE\n\t\t\t\t) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement: hoveredItem,\n\t\t\t\t\t\tcontent: hoveredItemData.name\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent) {\n\t\t\t\t// Emit tooltip move event only if tooltip is shown\n\t\t\t\tconst hoveredItemData = select(this).datum() as any\n\t\t\t\tif (\n\t\t\t\t\thoveredItemData.name.length > truncation.threshold &&\n\t\t\t\t\ttruncation.type !== TruncationTypes.NONE\n\t\t\t\t) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('click', function () {\n\t\t\t\tself.services.events.dispatchEvent(Events.Legend.ITEM_CLICK, {\n\t\t\t\t\tclickedElement: select(this)\n\t\t\t\t})\n\n\t\t\t\tconst clickedItem = select(this)\n\t\t\t\tconst clickedItemData = clickedItem.datum() as any\n\n\t\t\t\tself.model.toggleDataLabel(clickedItemData.name)\n\t\t\t})\n\t\t\t.on('mouseout', function () {\n\t\t\t\tconst hoveredItem = select(this)\n\t\t\t\thoveredItem.select('div.checkbox').classed('hovered', false)\n\n\t\t\t\t// Emit tooltip hide event only if tooltip is shown\n\t\t\t\tconst hoveredItemData = hoveredItem.datum() as any\n\t\t\t\tif (\n\t\t\t\t\thoveredItemData.name.length > truncation.threshold &&\n\t\t\t\t\ttruncation.type !== TruncationTypes.NONE\n\t\t\t\t) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t}\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Legend.ITEM_MOUSEOUT, {\n\t\t\t\t\thoveredElement: hoveredItem\n\t\t\t\t})\n\t\t\t})\n\n\t\tsvg.selectAll('div.legend-item div.checkbox').on('keyup', function (event: KeyboardEvent) {\n\t\t\tif (event.key && event.key === 'Tab') {\n\t\t\t\t// Higlight group\n\t\t\t\tself.services.events.dispatchEvent(Events.Legend.ITEM_HOVER, {\n\t\t\t\t\thoveredElement: select(this)\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\n\t\tsvg\n\t\t\t.selectAll('div.legend-item div.checkbox')\n\t\t\t.on('keydown', function (event: KeyboardEvent, d: any) {\n\t\t\t\tif (event.key && event.key === ' ') {\n\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\tself.model.toggleDataLabel(d.name)\n\t\t\t\t} else if (event.key && event.key === 'Tab') {\n\t\t\t\t\t// Unhiglight group\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Legend.ITEM_MOUSEOUT, {\n\t\t\t\t\t\thoveredElement: select(this)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\tsvg.selectAll('g.additional-item').on('mouseover', function (event: MouseEvent) {\n\t\t\tconst hoveredItem = select(this)\n\n\t\t\tconst hoveredItemData = hoveredItem.datum() as any\n\t\t\tif (hoveredItemData.name.length > truncation.threshold) {\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement: hoveredItem,\n\t\t\t\t\tcontent: hoveredItemData.name\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n}\n","import { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModel } from '@/model/model'\nimport { RenderTypes } from '@/interfaces/enums'\nimport type { Selection } from 'd3'\n\n// This class is used to create the clipPath to clip the chart components\n// It's necessary for zoom in/out behavior\nexport class ChartClip extends Component {\n\ttype = 'chart-clip'\n\trenderType = RenderTypes.SVG\n\n\t// Give every chart-clip a distinct ID\n\t// so they don't interfere each other in a page with multiple charts\n\tchartClipId = 'chart-clip-id-' + Math.floor(Math.random() * 99999999999)\n\n\tchartClipPath: any\n\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\t\tthis.init()\n\t}\n\n\tinit() {\n\t\t// set unique chartClipId in this chart to model\n\t\tthis.model.set({ chartClipId: this.chartClipId }, { skipUpdate: true })\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\t// Create the clipPath\n\t\tthis.createClipPath()\n\t}\n\n\tcreateClipPath() {\n\t\tconst svg = this.parent\n\t\tconst { cartesianScales } = this.services\n\t\tif (!cartesianScales) throw new Error('Service cartesianScales was undefined')\n\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\tconst mainYScale = cartesianScales.getMainYScale()\n\n\t\tconst [xScaleStart, xScaleEnd]: number[] = mainXScale.range()\n\t\tconst [yScaleEnd, yScaleStart]: number[] = mainYScale.range()\n\n\t\t// Get height\n\t\tif (!svg) {\n\t\t\tthrow new Error('svg is undefined')\n\t\t}\n\n\t\tthis.chartClipPath = DOMUtils.appendOrSelect(\n\t\t\tsvg as Selection<SVGGraphicsElement, any, HTMLElement, any>,\n\t\t\t`clipPath.${this.type}`\n\t\t).attr('id', this.chartClipId)\n\t\tconst clipRect = DOMUtils.appendOrSelect(this.chartClipPath, `rect.${this.type}`) as Selection<\n\t\t\tany,\n\t\t\tany,\n\t\t\tHTMLElement,\n\t\t\tany\n\t\t>\n\n\t\tif (xScaleEnd - xScaleStart > 0) {\n\t\t\tclipRect\n\t\t\t\t.attr('x', xScaleStart)\n\t\t\t\t.attr('y', yScaleStart)\n\t\t\t\t.attr('width', xScaleEnd - xScaleStart)\n\t\t\t\t.attr('height', yScaleEnd - yScaleStart)\n\t\t}\n\n\t\tthis.chartClipPath.merge(clipRect).lower()\n\t}\n}\n","// Internal Imports\nimport { ChartClip } from '@/components/axes/chart-clip'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\n\n// This class is used to create the clipPath to clip the chart components\n// It's necessary for zoom in/out behavior\nexport class CanvasChartClip extends ChartClip {\n\ttype = 'canvas-chart-clip'\n\n\t// Give every chart-clip a distinct ID\n\t// so they don't interfere each other in a page with multiple charts\n\tchartClipId = 'canvas-chart-clip-id-' + Math.floor(Math.random() * 99999999999)\n\n\tcreateClipPath() {\n\t\tconst svg = this.parent\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tthis.chartClipPath = DOMUtils.appendOrSelect(svg, `clipPath.${this.type}`).attr(\n\t\t\t'id',\n\t\t\tthis.chartClipId\n\t\t)\n\t\tconst clipRect = DOMUtils.appendOrSelect(this.chartClipPath, `rect.${this.type}`)\n\n\t\tclipRect.attr('x', 0).attr('y', 0).attr('width', width).attr('height', height)\n\n\t\tthis.chartClipPath.merge(clipRect).lower()\n\t}\n}\n","/**\n * Utilites to manipulate the position of elements relative to other elements\n */\nvar _a;\nexport var PLACEMENTS;\n(function (PLACEMENTS) {\n    PLACEMENTS[\"LEFT\"] = \"left\";\n    PLACEMENTS[\"RIGHT\"] = \"right\";\n    PLACEMENTS[\"TOP\"] = \"top\";\n    PLACEMENTS[\"BOTTOM\"] = \"bottom\";\n})(PLACEMENTS || (PLACEMENTS = {}));\nexport var defaultPositions = (_a = {},\n    _a[PLACEMENTS.LEFT] = function (referenceOffset, target, referenceRect) { return ({\n        top: referenceOffset.top - Math.round(target.offsetHeight / 2) + Math.round(referenceRect.height / 2),\n        left: Math.round(referenceOffset.left - target.offsetWidth)\n    }); },\n    _a[PLACEMENTS.RIGHT] = function (referenceOffset, target, referenceRect) { return ({\n        top: referenceOffset.top - Math.round(target.offsetHeight / 2) + Math.round(referenceRect.height / 2),\n        left: Math.round(referenceOffset.left + referenceRect.width)\n    }); },\n    _a[PLACEMENTS.TOP] = function (referenceOffset, target, referenceRect) { return ({\n        top: Math.round(referenceOffset.top - target.offsetHeight),\n        left: referenceOffset.left - Math.round(target.offsetWidth / 2) + Math.round(referenceRect.width / 2)\n    }); },\n    _a[PLACEMENTS.BOTTOM] = function (referenceOffset, target, referenceRect) { return ({\n        top: Math.round(referenceOffset.top + referenceRect.height),\n        left: referenceOffset.left - Math.round(target.offsetWidth / 2) + Math.round(referenceRect.width / 2)\n    }); },\n    _a);\nvar windowRef = typeof window !== \"undefined\" ? window : {\n    innerHeight: 0,\n    scrollY: 0,\n    innerWidth: 0,\n    scrollX: 0\n};\nvar Position = /** @class */ (function () {\n    function Position(positions) {\n        if (positions === void 0) { positions = {}; }\n        this.positions = defaultPositions;\n        this.positions = Object.assign({}, defaultPositions, positions);\n    }\n    Position.prototype.getRelativeOffset = function (target) {\n        // start with the initial element offsets\n        var offsets = {\n            left: target.offsetLeft,\n            top: target.offsetTop\n        };\n        // get each static (i.e. not absolute or relative) offsetParent and sum the left/right offsets\n        while (target.offsetParent && getComputedStyle(target.offsetParent).position === \"static\") {\n            offsets.left += target.offsetLeft;\n            offsets.top += target.offsetTop;\n            target = target.offsetParent;\n        }\n        return offsets;\n    };\n    Position.prototype.getAbsoluteOffset = function (target) {\n        var currentNode = target;\n        var margins = {\n            top: 0,\n            left: 0\n        };\n        // searches for containing elements with additional margins\n        while (currentNode.offsetParent) {\n            var computed = getComputedStyle(currentNode.offsetParent);\n            // find static elements with additional margins\n            // since they tend to throw off our positioning\n            // (usually this is just the body)\n            if (computed.position === \"static\" &&\n                computed.marginLeft &&\n                computed.marginTop) {\n                if (parseInt(computed.marginTop, 10)) {\n                    margins.top += parseInt(computed.marginTop, 10);\n                }\n                if (parseInt(computed.marginLeft, 10)) {\n                    margins.left += parseInt(computed.marginLeft, 10);\n                }\n            }\n            currentNode = currentNode.offsetParent;\n        }\n        var targetRect = target.getBoundingClientRect();\n        var relativeRect = document.body.getBoundingClientRect();\n        return {\n            top: targetRect.top - relativeRect.top + margins.top,\n            left: targetRect.left - relativeRect.left + margins.left\n        };\n    };\n    // finds the position relative to the `reference` element\n    Position.prototype.findRelative = function (reference, target, placement) {\n        var referenceOffset = this.getRelativeOffset(reference);\n        var referenceRect = reference.getBoundingClientRect();\n        return this.calculatePosition(referenceOffset, referenceRect, target, placement);\n    };\n    Position.prototype.findAbsolute = function (reference, target, placement) {\n        var referenceOffset = this.getAbsoluteOffset(reference);\n        var referenceRect = reference.getBoundingClientRect();\n        return this.calculatePosition(referenceOffset, referenceRect, target, placement);\n    };\n    Position.prototype.findPosition = function (reference, target, placement, offsetFunction) {\n        if (offsetFunction === void 0) { offsetFunction = this.getAbsoluteOffset.bind(this); }\n        var referenceOffset = offsetFunction(reference);\n        var referenceRect = reference.getBoundingClientRect();\n        return this.calculatePosition(referenceOffset, referenceRect, target, placement);\n    };\n    Position.prototype.findPositionAt = function (offset, target, placement) {\n        return this.calculatePosition(offset, { top: 0, left: 0, height: 0, width: 0 }, target, placement);\n    };\n    /**\n     * Get the dimensions of an element from an AbsolutePosition and a reference element\n     */\n    Position.prototype.getPlacementBox = function (target, position) {\n        var targetBottom = target.offsetHeight + position.top;\n        var targetRight = target.offsetWidth + position.left;\n        return {\n            top: position.top,\n            bottom: targetBottom,\n            left: position.left,\n            right: targetRight\n        };\n    };\n    Position.prototype.addOffset = function (position, top, left) {\n        if (top === void 0) { top = 0; }\n        if (left === void 0) { left = 0; }\n        return Object.assign({}, position, {\n            top: position.top + top,\n            left: position.left + left\n        });\n    };\n    Position.prototype.setElement = function (element, position) {\n        element.style.top = position.top + \"px\";\n        element.style.left = position.left + \"px\";\n    };\n    Position.prototype.findBestPlacement = function (reference, target, placements, containerFunction, positionFunction) {\n        var _this = this;\n        if (containerFunction === void 0) { containerFunction = this.defaultContainerFunction.bind(this); }\n        if (positionFunction === void 0) { positionFunction = this.findPosition.bind(this); }\n        /**\n         * map over the array of placements and weight them based on the percentage of visible area\n         * where visible area is defined as the area not obscured by the window borders\n         */\n        var weightedPlacements = placements.map(function (placement) {\n            var pos = positionFunction(reference, target, placement);\n            var box = _this.getPlacementBox(target, pos);\n            var hiddenHeight = 0;\n            var hiddenWidth = 0;\n            var container = containerFunction();\n            // the element is exceeding from top or bottom of its container\n            if (box.top < container.top) {\n                hiddenHeight = container.top - box.top;\n            }\n            else if (box.bottom > container.height) {\n                hiddenHeight = box.bottom - container.height;\n            }\n            // the element is exceeding from left or right of its container\n            if (box.left < container.left) {\n                hiddenWidth = container.left - box.left;\n            }\n            else if (box.right > container.width) {\n                hiddenWidth = box.right - container.width;\n            }\n            // if one of the hidden dimensions is 0 but the other is > 0\n            // we want to have a positive area, so setting the null one to 1\n            if (hiddenHeight && !hiddenWidth) {\n                hiddenWidth = 1;\n            }\n            else if (hiddenWidth && !hiddenHeight) {\n                hiddenHeight = 1;\n            }\n            var area = target.offsetHeight * target.offsetWidth;\n            var hiddenArea = hiddenHeight * hiddenWidth;\n            // if visibleArea is 0 it means the element is fully outside container bounds\n            // and visiblePercent will then be 0\n            var visibleArea = area - hiddenArea;\n            var visiblePercent = visibleArea / area;\n            return {\n                placement: placement,\n                weight: visiblePercent\n            };\n        });\n        // sort the placements from best to worst\n        weightedPlacements.sort(function (a, b) { return b.weight - a.weight; });\n        // pick the best!\n        return weightedPlacements[0].placement;\n    };\n    Position.prototype.findBestPlacementAt = function (offset, target, placements, containerFunction) {\n        var _this = this;\n        if (containerFunction === void 0) { containerFunction = this.defaultContainerFunction.bind(this); }\n        var positionAt = function (_, target, placement) {\n            return _this.findPositionAt(offset, target, placement);\n        };\n        return this.findBestPlacement(null, target, placements, containerFunction, positionAt);\n    };\n    Position.prototype.defaultContainerFunction = function () {\n        return {\n            // we go with window here, because that's going to be the simple/common case\n            top: 0,\n            left: 0,\n            height: windowRef.innerHeight,\n            width: windowRef.innerWidth\n        };\n    };\n    Position.prototype.calculatePosition = function (referenceOffset, referenceRect, target, placement) {\n        if (this.positions[placement]) {\n            return this.positions[placement](referenceOffset, target, referenceRect);\n        }\n        console.error(\"No function found for placement, defaulting to 0,0\");\n        return { left: 0, top: 0 };\n    };\n    return Position;\n}());\nexport { Position };\nexport var position = new Position();\nexport default Position;\n//# sourceMappingURL=../src/index.js.map","import { select, pointer } from 'd3'\nimport Position, { PLACEMENTS } from '@carbon/utils-position' // position service\nimport { getProperty, truncateLabel } from '@/tools'\nimport { zoomBar as zoomBarConfigs, tooltips as tooltipConfigs } from '@/configuration'\nimport { carbonPrefix } from '@/configuration-non-customizable' // CSS prefix\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModel } from '@/model/model'\nimport { Events, RenderTypes, TruncationTypes } from '@/interfaces/enums'\nimport { sanitizeHtml } from '@/utils/sanitizeHtml'\n\nexport class Tooltip extends Component {\n\ttype = 'tooltip'\n\trenderType = RenderTypes.HTML\n\n\t// flag for checking whether tooltip event listener is added or not\n\tisEventListenerAdded = false\n\tlastTriggeredEventType = ''\n\ttooltip: any\n\tpositionService = new Position()\n\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\n\t\tthis.init()\n\t}\n\n\thandleShowTooltip = (e: any) => {\n\t\tconst data = e.detail.data || e.detail.items\n\n\t\tlet defaultHTML: any\n\t\tconst formattedItems = this.formatItems(this.getItems(e))\n\n\t\tif (e.detail.content) {\n\t\t\tdefaultHTML = `<div class=\"title-tooltip\"><p>${sanitizeHtml(e.detail.content)}</p></div>`\n\t\t} else {\n\t\t\tdefaultHTML = sanitizeHtml(this.getTooltipHTML(formattedItems))\n\t\t}\n\n\t\tconst tooltipTextContainer = DOMUtils.appendOrSelect(this.tooltip, 'div.content-box')\n\n\t\t// if there is a provided tooltip HTML function call it\n\t\tif (getProperty(this.getOptions(), 'tooltip', 'customHTML')) {\n\t\t\tif (e.detail.content) {\n\t\t\t\tconst labelHTML = `<div class=\"title-tooltip\"><p>${sanitizeHtml(\n\t\t\t\t\te.detail.content\n\t\t\t\t)}</p></div>`\n\t\t\t\ttooltipTextContainer.html(labelHTML)\n\t\t\t} else {\n\t\t\t\ttooltipTextContainer.html(\n\t\t\t\t\t`<div class=\"title-tooltip\"><p>${sanitizeHtml(\n\t\t\t\t\t\tthis.model.getOptions().tooltip.customHTML(data, defaultHTML)\n\t\t\t\t\t)}</p></div>`\n\t\t\t\t)\n\t\t\t}\n\t\t} else {\n\t\t\t// Use default tooltip\n\t\t\ttooltipTextContainer.html(defaultHTML)\n\t\t}\n\n\t\t// Apply custom background colors\n\t\ttooltipTextContainer.selectAll('.datapoint-tooltip').each(function (_: any, i: number) {\n\t\t\tconst item = formattedItems[i]\n\n\t\t\tif (formattedItems[i] && formattedItems[i].color) {\n\t\t\t\tselect(this)\n\t\t\t\t\t.select('.tooltip-color')\n\t\t\t\t\t.attr('class', 'tooltip-color')\n\t\t\t\t\t.style('background-color', item.color)\n\t\t\t}\n\t\t})\n\n\t\t// Position the tooltip\n\t\tthis.positionTooltip(e)\n\n\t\t// Fade in\n\t\tthis.tooltip.classed('hidden', false).attr('aria-hidden', false)\n\n\t\t// Store the latest triggered custom event type\n\t\tthis.lastTriggeredEventType = e.type\n\t}\n\n\thandleHideTooltip = () => {\n\t\tthis.tooltip.classed('hidden', true).attr('aria-hidden', true)\n\t}\n\n\taddTooltipEventListener() {\n\t\t// listen to move-tooltip Custom Events to move the tooltip\n\t\tthis.services.events.addEventListener(Events.Tooltip.MOVE, (e: CustomEvent) => {\n\t\t\tif (this.lastTriggeredEventType !== Events.Toolbar.SHOW_TOOLTIP &&\n\t\t\t\tthis.tooltip.classed('hidden') === false\n\t\t\t) {\n\t\t\t\tthis.positionTooltip(e)\n\t\t\t}\n\t\t})\n\n\t\t// listen to show-tooltip Custom Events to render the tooltip\n\t\tthis.services.events.addEventListener(Events.Tooltip.SHOW, this.handleShowTooltip)\n\n\t\t// listen to hide-tooltip Custom Events to hide the tooltip\n\t\tthis.services.events.addEventListener(Events.Tooltip.HIDE, this.handleHideTooltip)\n\n\t\t// listen to chart-mouseout event to hide the tooltip\n\t\tthis.services.events.addEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip)\n\n\t\t// listen to toolbar events\n\t\tthis.services.events.addEventListener(Events.Toolbar.SHOW_TOOLTIP, this.handleShowTooltip)\n\t\tthis.services.events.addEventListener(Events.Toolbar.HIDE_TOOLTIP, this.handleHideTooltip)\n\t}\n\n\tremoveTooltipEventListener() {\n\t\t// remove move-tooltip Custom Events\n\t\tthis.services.events.removeEventListener(Events.Tooltip.MOVE, null)\n\n\t\t// remove show-tooltip Custom Events\n\t\tthis.services.events.removeEventListener(Events.Tooltip.SHOW, this.handleShowTooltip)\n\n\t\t// remove hide-tooltip Custom Events\n\t\tthis.services.events.removeEventListener(Events.Tooltip.HIDE, this.handleHideTooltip)\n\n\t\t// remove the listener on chart-mouseout\n\t\tthis.services.events.removeEventListener(Events.Chart.MOUSEOUT, this.handleHideTooltip)\n\n\t\t// remove the listener of the toolbar\n\t\tthis.services.events.removeEventListener(Events.Toolbar.SHOW_TOOLTIP, this.handleShowTooltip)\n\t\tthis.services.events.removeEventListener(Events.Toolbar.HIDE_TOOLTIP, this.handleHideTooltip)\n\t}\n\n\tgetItems(e: CustomEvent) {\n\t\tif (e.detail.items) {\n\t\t\treturn e.detail.items\n\t\t}\n\n\t\treturn []\n\t}\n\n\tformatItems(items: any) {\n\t\tconst options = this.getOptions()\n\n\t\t// get user provided custom values for truncation\n\t\tconst truncationType = getProperty(options, 'tooltip', 'truncation', 'type')\n\n\t\tconst truncationThreshold = getProperty(options, 'tooltip', 'truncation', 'threshold')\n\n\t\tconst truncationNumCharacter = getProperty(options, 'tooltip', 'truncation', 'numCharacter')\n\n\t\t// truncate the label if it's too long\n\t\t// only applies to discrete type\n\t\tif (truncationType !== TruncationTypes.NONE) {\n\t\t\treturn items.map((item: any) => {\n\t\t\t\t// get width of the label icon if it exists\n\t\t\t\tconst labelIconSize = item.labelIcon ? 12 : 0\n\n\t\t\t\titem.value = item.value ? this.valueFormatter(item.value, item.label) : item.value\n\t\t\t\tif (item.label && item.label.length + labelIconSize > truncationThreshold) {\n\t\t\t\t\titem.label = truncateLabel(item.label, truncationType, truncationNumCharacter)\n\t\t\t\t}\n\n\t\t\t\tif (item.value && item.value.length > truncationThreshold) {\n\t\t\t\t\titem.value = truncateLabel(item.value, truncationType, truncationNumCharacter)\n\t\t\t\t}\n\n\t\t\t\treturn item\n\t\t\t})\n\t\t} else {\n\t\t\treturn items.map((item: any) => {\n\t\t\t\titem.value = item.value ? this.valueFormatter(item.value, item.label) : item.value\n\t\t\t\treturn item\n\t\t\t})\n\t\t}\n\t}\n\n\tgetTooltipHTML(formattedItems: any) {\n\t\treturn (\n\t\t\t`<ul class=\"multi-tooltip\">` +\n\t\t\tformattedItems\n\t\t\t\t.map(\n\t\t\t\t\t(item: any) =>\n\t\t\t\t\t\t`<li>\n\t\t\t\t\t<div class=\"datapoint-tooltip${item.bold ? ' bold' : ''}\">\n\t\t\t\t\t\t${item.class || item.color ? `<div class=\"tooltip-color ${item.class}\"></div>` : ''}\n\t\t\t\t\t\t<div class=\"label\">\n\t\t\t\t\t\t<p>${item.label || ''}</p>\n\t\t\t\t\t\t${item.labelIcon ? `<span class=\"label-icon\"/>${item.labelIcon}</span>` : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${item.value === undefined || item.value === null ? '' : `<p class=\"value\"/>${item.value}</p>`}\n\t\t\t\t\t</div>\n\t\t\t\t</li>`\n\t\t\t\t)\n\t\t\t\t.join('') +\n\t\t\t`</ul>`\n\t\t)\n\t}\n\n\tvalueFormatter(value: any, label: string) {\n\t\tconst options = this.getOptions()\n\t\tconst valueFormatter = getProperty(options, 'tooltip', 'valueFormatter')\n\t\tconst {\n\t\t\tcode: localeCode,\n\t\t\tnumber: numberFormatter,\n\t\t\tdate: dateFormatter\n\t\t} = getProperty(options, 'locale')\n\n\t\tif (valueFormatter) {\n\t\t\treturn valueFormatter(value, label)\n\t\t}\n\n\t\tif (typeof value.getTime === 'function') {\n\t\t\treturn dateFormatter(value, localeCode, { month: 'short', day: 'numeric', year: 'numeric' })\n\t\t}\n\n\t\ttry {\n\t\t\t// it's a correct ISO format Date string\n\t\t\tif (typeof value === 'string' && /\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z/.test(value)) {\n\t\t\t\tconst newDate = new Date(value)\n\t\t\t\treturn dateFormatter(newDate, localeCode, {\n\t\t\t\t\tmonth: 'short',\n\t\t\t\t\tday: 'numeric',\n\t\t\t\t\tyear: 'numeric'\n\t\t\t\t})\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// not a valid ISO format string\n\t\t}\n\n\t\treturn numberFormatter(value, localeCode)\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst options = this.getOptions()\n\t\tconst isTooltipEnabled = getProperty(options, 'tooltip', 'enabled')\n\t\tif (isTooltipEnabled) {\n\t\t\t// Grab the tooltip element\n\t\t\tconst holder = select(this.services.domUtils.getHolder())\n\t\t\tconst chartprefix = getProperty(options, 'style', 'prefix')\n\t\t\tthis.tooltip = DOMUtils.appendOrSelect(holder, `div.${carbonPrefix}--${chartprefix}--tooltip`)\n\n\t\t\tthis.tooltip.style('max-width', null).attr('role', 'tooltip')\n\n\t\t\tif (!this.isEventListenerAdded) {\n\t\t\t\tthis.addTooltipEventListener()\n\t\t\t\tthis.isEventListenerAdded = true\n\t\t\t}\n\t\t\tthis.tooltip.classed('hidden', true)\n\t\t} else if (!isTooltipEnabled && this.isEventListenerAdded) {\n\t\t\t// remove tooltip eventListener\n\t\t\tthis.removeTooltipEventListener()\n\t\t\tthis.isEventListenerAdded = false\n\t\t}\n\t}\n\n\taddOffsetByPlacement(position: any, placement: string, offset: number) {\n\t\tconst newOffset = Object.assign({}, position)\n\t\tif (placement == PLACEMENTS.LEFT) {\n\t\t\tnewOffset.left -= offset\n\t\t} else if (placement == PLACEMENTS.RIGHT) {\n\t\t\tnewOffset.left += offset\n\t\t} else if (placement == PLACEMENTS.TOP) {\n\t\t\tnewOffset.top -= offset\n\t\t} else if (placement == PLACEMENTS.BOTTOM) {\n\t\t\tnewOffset.top += offset\n\t\t}\n\t\treturn newOffset\n\t}\n\n\tpositionTooltip(e: CustomEvent) {\n\t\tconst holder = this.services.domUtils.getHolder()\n\t\tconst holderWidth = holder.offsetWidth\n\t\tconst holderHeight = holder.offsetHeight\n\t\tconst target = this.tooltip.node()\n\t\tconst options = this.getOptions()\n\t\tconst isTopZoomBarEnabled = getProperty(options, 'zoomBar', 'top', 'enabled')\n\t\tconst noWrap = !!getProperty(e, 'detail', 'noWrap')\n\t\tconst hasCustomPlacements = Array.isArray(getProperty(e, 'detail', 'placements'))\n\t\tconst placements = hasCustomPlacements ?\n\t\t\tgetProperty(e, 'detail', 'placements') :\n\t\t\t[PLACEMENTS.RIGHT, PLACEMENTS.LEFT, PLACEMENTS.TOP, PLACEMENTS.BOTTOM]\n\n\t\tlet bestPlacementOption: any\n\t\tlet { horizontalOffset, defaultOffset } = tooltipConfigs\n\n\t\tthis.tooltip.select('div.title-tooltip').classed('title-tooltip-nowrap', noWrap)\n\n\t\t// set tooltip based on reference element with candidate placements\n\t\tif (hasCustomPlacements) {\n\t\t\tconst hoveredElement = getProperty(e, 'detail', 'event', 'target')\n\t\t\t// calculate the best placement from array \"placements\"\n\t\t\tconst hoveredPos = this.services.domUtils.getElementOffset(hoveredElement, true)\n\t\t\tbestPlacementOption = this.positionService.findBestPlacementAt(\n\t\t\t\thoveredPos,\n\t\t\t\ttarget,\n\t\t\t\tplacements,\n\t\t\t\t() => ({\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\twidth: holderWidth,\n\t\t\t\t\theight: holderHeight\n\t\t\t\t})\n\t\t\t)\n\t\t\tlet bestPos = this.positionService.findPosition(\n\t\t\t\thoveredElement,\n\t\t\t\ttarget,\n\t\t\t\tbestPlacementOption,\n\t\t\t\t() => this.services.domUtils.getElementOffset(hoveredElement)\n\t\t\t)\n\t\t\tbestPos = this.addOffsetByPlacement(\n\t\t\t\tbestPos,\n\t\t\t\tbestPlacementOption,\n\t\t\t\tdefaultOffset\n\t\t\t)\n\t\t\tthis.positionService.setElement(target, bestPos)\n\t\t\treturn ;\n\t\t}\n\n\t\t// set tooltip based on mouse positions\n\t\tlet mouseRelativePos = getProperty(e, 'detail', 'mousePosition')\n\t\tif (!mouseRelativePos) {\n\t\t\tmouseRelativePos = pointer(getProperty(e, 'detail', 'event'), holder)\n\t\t} else {\n\t\t\tconst zoombarType = getProperty(options, 'zoomBar', 'top', 'type') as\n\t\t\t\t| 'graph_view'\n\t\t\t\t| 'slider_view'\n\t\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\n\t\t\t// if the mouse position is from event (ruler)\n\t\t\t// we need add zoom bar height\n\t\t\tif (isTopZoomBarEnabled) {\n\t\t\t\tmouseRelativePos[1] += zoombarHeight + zoomBarConfigs.spacerHeight\n\n\t\t\t\t// TODO - we need to add toolbar height when toolbar is available\n\t\t\t}\n\t\t}\n\n\t\tif (mouseRelativePos[0] / holderWidth > 0.9) {\n\t\t\tbestPlacementOption = PLACEMENTS.LEFT\n\t\t} else if (mouseRelativePos[0] / holderWidth < 0.1) {\n\t\t\tbestPlacementOption = PLACEMENTS.RIGHT\n\t\t} else {\n\t\t\t// Find out whether tooltip should be shown on the left or right side\n\t\t\tbestPlacementOption = this.positionService.findBestPlacementAt(\n\t\t\t\t{\n\t\t\t\t\tleft: mouseRelativePos[0],\n\t\t\t\t\ttop: mouseRelativePos[1]\n\t\t\t\t},\n\t\t\t\ttarget,\n\t\t\t\tplacements,\n\t\t\t\t() => ({\n\t\t\t\t\ttop: undefined, // properties were never set to optional (probably should)\n\t\t\t\t\tleft: undefined, // ditto\n\t\t\t\t\twidth: holderWidth,\n\t\t\t\t\theight: holderHeight\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\n\t\tif (bestPlacementOption === PLACEMENTS.LEFT) {\n\t\t\thorizontalOffset *= -1\n\t\t}\n\n\t\t// Get coordinates to where tooltip should be positioned\n\t\tconst pos = this.positionService.findPositionAt(\n\t\t\t{\n\t\t\t\tleft: mouseRelativePos[0] + horizontalOffset,\n\t\t\t\ttop: mouseRelativePos[1]\n\t\t\t},\n\t\t\ttarget,\n\t\t\tbestPlacementOption\n\t\t)\n\n\t\tthis.positionService.setElement(target, pos)\n\t}\n}\n","import { brushX, pointer, scaleTime } from 'd3'\nimport { Component } from '@/components/component'\nimport { RenderTypes, ScaleTypes } from '@/interfaces/enums'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Selection } from 'd3'\n\n// This class is used for handle brush events in chart\nexport class ChartBrush extends Component {\n\tstatic DASH_LENGTH = 4\n\n\ttype = 'grid-brush'\n\trenderType = RenderTypes.SVG\n\n\tselectionSelector = 'rect.selection' // needs to match the class name in d3.brush\n\n\tfrontSelectionSelector = 'rect.frontSelection' // needs to match the class name in _grid-brush.scss\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst svg = this.parent\n\n\t\t// use this area to display selection above all graphs\n\t\tconst frontSelectionArea = this.getComponentContainer()\n\t\tif (!svg) throw new Error('SVG was not defined')\n\t\tconst backdrop = DOMUtils.appendOrSelect(\n\t\t\tsvg as Selection<SVGGraphicsElement, any, HTMLElement, any>,\n\t\t\t'svg.chart-grid-backdrop'\n\t\t)\n\t\t// use this area to handle d3 brush events\n\t\tconst brushArea = DOMUtils.appendOrSelect(backdrop, `g.${this.type}`)\n\n\t\t// set an id for rect.selection to be referred\n\t\tconst d3Selection = DOMUtils.appendOrSelect(brushArea, this.selectionSelector)\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(backdrop, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst { cartesianScales } = this.services\n\t\tconst mainXScaleType = cartesianScales.getMainXScaleType()\n\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\tconst [xScaleStart] = mainXScale.range()\n\t\tfrontSelectionArea.attr('transform', `translate(${xScaleStart},0)`)\n\t\tconst frontSelection = DOMUtils.appendOrSelect(frontSelectionArea, this.frontSelectionSelector)\n\n\t\tif (mainXScale && mainXScaleType === ScaleTypes.TIME) {\n\t\t\t// get current zoomDomain\n\t\t\tlet zoomDomain = this.model.get('zoomDomain')\n\t\t\tif (zoomDomain === undefined) {\n\t\t\t\t// default to full range with extended domain\n\t\t\t\tzoomDomain = this.services.zoom.getDefaultZoomBarDomain()\n\t\t\t\tif (zoomDomain) {\n\t\t\t\t\tthis.model.set({ zoomDomain: zoomDomain }, { animate: false })\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst updateSelectionDash = (selection: any) => {\n\t\t\t\t// set end drag point to dash\n\t\t\t\tconst selectionWidth = selection[1] - selection[0]\n\t\t\t\tlet dashArray = '0,' + selectionWidth.toString() // top (invisible)\n\n\t\t\t\t// right\n\t\t\t\tconst dashCount = Math.floor(height / ChartBrush.DASH_LENGTH)\n\t\t\t\tconst totalRightDash = dashCount * ChartBrush.DASH_LENGTH\n\t\t\t\tfor (let i = 0; i < dashCount; i++) {\n\t\t\t\t\tdashArray += ',' + ChartBrush.DASH_LENGTH // for each full length dash\n\t\t\t\t}\n\t\t\t\tdashArray += ',' + (height - totalRightDash) // for rest of the right height\n\t\t\t\t// if dash count is even, one more \",0\" is needed to make total right dash pattern even\n\t\t\t\tif (dashCount % 2 === 1) {\n\t\t\t\t\tdashArray += ',0'\n\t\t\t\t}\n\t\t\t\tdashArray += ',' + selectionWidth.toString() // bottom (invisible)\n\t\t\t\tdashArray += ',' + height.toString() // left\n\t\t\t\tfrontSelection.attr('stroke-dasharray', dashArray)\n\t\t\t}\n\n\t\t\tconst brushEventHandler = (event: any) => {\n\t\t\t\t// selection range: [0, width]\n\t\t\t\tconst selection = event.selection\n\t\t\t\tif (selection === null || selection[0] === selection[1]) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// copy the d3 selection attrs to front selection element\n\t\t\t\tfrontSelection\n\t\t\t\t\t.attr('x', parseFloat(d3Selection.attr('x')) + parseFloat(backdrop.attr('x')))\n\t\t\t\t\t.attr('y', d3Selection.attr('y'))\n\t\t\t\t\t.attr('width', d3Selection.attr('width'))\n\t\t\t\t\t.attr('height', d3Selection.attr('height'))\n\t\t\t\t\t.style('cursor', 'pointer')\n\t\t\t\t\t.style('display', null)\n\n\t\t\t\tupdateSelectionDash(selection)\n\t\t\t}\n\n\t\t\t// assume max range is [0, width]\n\t\t\tconst updateZoomDomain = (startPoint: any, endPoint: any) => {\n\t\t\t\t// create xScale based on current zoomDomain\n\t\t\t\tconst xScale = scaleTime().range([0, width]).domain(zoomDomain)\n\n\t\t\t\tlet newDomain = [xScale.invert(startPoint), xScale.invert(endPoint)]\n\t\t\t\t// if selected start time and end time are the same\n\t\t\t\t// reset to default full range\n\t\t\t\tif (newDomain[0].valueOf() === newDomain[1].valueOf()) {\n\t\t\t\t\t// same as d3 behavior and zoom bar behavior: set to default full range\n\t\t\t\t\tnewDomain = this.services.zoom.getDefaultZoomBarDomain()\n\t\t\t\t}\n\n\t\t\t\t// only if zoomDomain needs update\n\t\t\t\tif (\n\t\t\t\t\tzoomDomain[0].valueOf() !== newDomain[0].valueOf() ||\n\t\t\t\t\tzoomDomain[1].valueOf() !== newDomain[1].valueOf()\n\t\t\t\t) {\n\t\t\t\t\tthis.services.zoom.handleDomainChange(newDomain)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet brush: any\n\n\t\t\tconst brushed = (event: any) => {\n\t\t\t\t// max selection range: [0, width]\n\t\t\t\tconst selection = event.selection\n\n\t\t\t\tif (selection !== null) {\n\t\t\t\t\t// updateZoomDomain assumes max range is [0, width]\n\t\t\t\t\tupdateZoomDomain(selection[0], selection[1])\n\n\t\t\t\t\t// clear brush selection\n\t\t\t\t\tbrushArea.call(brush.move, null)\n\t\t\t\t\t// hide frontSelection\n\t\t\t\t\tfrontSelection.style('display', 'none')\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (height != 0 && width != 0) {\n\t\t\t\t// leave some space to display selection strokes beside axes\n\t\t\t\tbrush = brushX()\n\t\t\t\t\t.extent([\n\t\t\t\t\t\t[0, 0],\n\t\t\t\t\t\t[width - 1, height]\n\t\t\t\t\t])\n\t\t\t\t\t.on('start brush end', brushEventHandler)\n\t\t\t\t\t.on('end.brushed', brushed)\n\n\t\t\t\tbrushArea.call(brush)\n\t\t\t}\n\n\t\t\tconst zoomRatio: number = this.services.zoom.getZoomRatio()\n\t\t\tbackdrop.on('click', function (event: MouseEvent) {\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tconst holder = this.services.domUtils.getHolder()\n\n\t\t\t\t\t// clickedX range: [0, width]\n\t\t\t\t\tconst clickedX = pointer(brushArea.node(), holder)[0]\n\n\t\t\t\t\tlet leftPoint = clickedX - (width * zoomRatio) / 2\n\t\t\t\t\tif (leftPoint < 0) {\n\t\t\t\t\t\tleftPoint = 0\n\t\t\t\t\t}\n\t\t\t\t\tlet rightPoint = clickedX + (width * zoomRatio) / 2\n\t\t\t\t\tif (rightPoint > width) {\n\t\t\t\t\t\trightPoint = width\n\t\t\t\t\t}\n\t\t\t\t\t// updateZoomDomain assumes max range is [0, width]\n\t\t\t\t\tupdateZoomDomain(leftPoint, rightPoint)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n","import { cloneDeep, isEmpty, merge } from 'lodash-es'\nimport { area, brushX, extent, line } from 'd3'\nimport { getProperty } from '@/tools'\nimport { zoomBar as zoomBarConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport type { ChartModelCartesian } from '@/model/cartesian-charts'\nimport { AxisPositions, Events, RenderTypes, ScaleTypes, ZoomBarTypes } from '@/interfaces/enums'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\n\nexport class ZoomBar extends Component {\n\ttype = 'zoom-bar'\n\trenderType = RenderTypes.SVG\n\n\t// The minimum selection x range to trigger handler update\n\t// Smaller number may introduce a handler flash during initialization\n\t// Bigger number may not trigger handler update while selection area on chart is very small\n\tMIN_SELECTION_DIFF = 9e-10\n\n\t// needs to match the style in _zoom-bar.scss\n\tbrushSelector = 'g.zoom-bar-brush'\n\n\t// The max allowed selection range, will be updated soon in render()\n\tmaxSelectionRange: [0, 0]\n\n\t// Give every zoomBarClip a distinct ID\n\t// so they don't interfere the other zoom bars in a page\n\tclipId = 'zoomBarClip-' + Math.floor(Math.random() * 99999999999)\n\n\tbrush = brushX()\n\txScale: any\n\tyScale: any\n\n\thighlightStrokeWidth = 1\n\n\tprotected model: ChartModelCartesian\n\n\tinit() {\n\t\tthis.services.events.addEventListener(Events.ZoomBar.UPDATE, this.render.bind(this))\n\t\t// check if pre-defined zoom bar data exists\n\t\tconst definedZoomBarData = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'data')\n\n\t\t// load up the zoomBarData into this model\n\t\tthis.model.setZoomBarData(definedZoomBarData)\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer()\n\n\t\tconst isTopZoomBarLoading = this.services.zoom.isZoomBarLoading(AxisPositions.TOP)\n\t\tconst isTopZoomBarLocked = this.services.zoom.isZoomBarLocked(AxisPositions.TOP)\n\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type') as\n\t\t\t| 'graph_view'\n\t\t\t| 'slider_view'\n\n\t\t// As zoom current only available on top only highlights corresponding to bottom axis will be shown\n\t\tconst highlight = getProperty(this.getOptions(), 'axes', AxisPositions.BOTTOM, 'highlights')\n\n\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\n\t\tconst { width } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\t\t// initialization is not completed yet\n\t\tif (width === 0) {\n\t\t\treturn\n\t\t}\n\t\t// get axes margins\n\t\tlet axesLeftMargin = 0\n\t\tconst axesMargins = this.model.get('axesMargins')\n\t\tif (axesMargins && axesMargins.left) {\n\t\t\taxesLeftMargin = axesMargins.left\n\t\t}\n\n\t\tconst container = DOMUtils.appendOrSelect(svg, 'svg.zoom-container')\n\t\t\t.attr('width', '100%')\n\t\t\t.attr('height', zoombarHeight)\n\t\t\t.attr('opacity', 1)\n\n\t\tDOMUtils.appendOrSelect(svg, 'rect.zoom-spacer')\n\t\t\t.attr('x', 0)\n\t\t\t.attr('y', zoombarHeight)\n\t\t\t.attr('width', '100%')\n\t\t\t.attr('height', zoomBarConfigs.spacerHeight)\n\t\t\t.attr('opacity', 1)\n\t\t\t.attr('fill', 'none')\n\n\t\tif (zoombarType === ZoomBarTypes.GRAPH_VIEW) {\n\t\t\t// Draw zoombar background rectangle\n\t\t\tDOMUtils.appendOrSelect(container, 'rect.zoom-bg')\n\t\t\t\t.attr('x', axesLeftMargin)\n\t\t\t\t.attr('y', 0)\n\t\t\t\t.attr('width', width - axesLeftMargin)\n\t\t\t\t.attr('height', '100%')\n\t\t\t\t.classed('zoom-bg-skeleton', isTopZoomBarLoading)\n\t\t\t\t.style(\n\t\t\t\t\t'stroke',\n\t\t\t\t\tisTopZoomBarLoading\n\t\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t\t: null\n\t\t\t\t)\n\t\t} else if (zoombarType === ZoomBarTypes.SLIDER_VIEW) {\n\t\t\t// Draw zoombar background line\n\t\t\tDOMUtils.appendOrSelect(container, 'rect.zoom-slider-bg')\n\t\t\t\t.attr('x', axesLeftMargin)\n\t\t\t\t.attr('y', zoombarHeight / 2 - 1)\n\t\t\t\t.attr('width', width - axesLeftMargin)\n\t\t\t\t.attr('height', 2)\n\t\t\t\t.classed('zoom-slider-bg-skeleton', isTopZoomBarLoading)\n\t\t\t\t.style(\n\t\t\t\t\t'stroke',\n\t\t\t\t\tisTopZoomBarLoading\n\t\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t\t: null\n\t\t\t\t)\n\t\t}\n\n\t\tif (isTopZoomBarLoading) {\n\t\t\tthis.renderSkeleton(container, axesLeftMargin, width)\n\t\t\treturn\n\t\t}\n\n\t\tconst { cartesianScales } = this.services\n\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\tconst mainYScale = cartesianScales.getMainYScale()\n\t\tconst mainXScaleType = cartesianScales.getMainXScaleType()\n\n\t\tif (mainXScale && mainXScaleType === ScaleTypes.TIME) {\n\t\t\tlet zoomBarData = this.services.zoom.getZoomBarData()\n\n\t\t\t// if there's no zoom bar data we can't do anything (true, undefined, null...)\n\t\t\t// if zoom domain is based on a single data element\n\t\t\t// doesn't make sense to allow zooming in\n\t\t\tif (isEmpty(zoomBarData) || zoomBarData.length === 1) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.xScale = mainXScale.copy()\n\t\t\tthis.yScale = mainYScale.copy()\n\n\t\t\tconst defaultDomain = this.services.zoom.getDefaultZoomBarDomain(zoomBarData)\n\n\t\t\t// add value 0 to the extended domain for zoom bar area graph\n\t\t\tzoomBarData = this.compensateDataForDefaultDomain(zoomBarData, defaultDomain)\n\n\t\t\t// get old initialZoomDomain from model\n\t\t\tconst oldInitialZoomDomain = this.model.get('initialZoomDomain')\n\t\t\t// get new initialZoomDomain from option\n\t\t\tconst newInitialZoomDomain = getProperty(\n\t\t\t\tthis.getOptions(),\n\t\t\t\t'zoomBar',\n\t\t\t\tAxisPositions.TOP,\n\t\t\t\t'initialZoomDomain'\n\t\t\t)\n\t\t\t// change string date to Date object if necessary\n\t\t\tif (newInitialZoomDomain && newInitialZoomDomain[0] && newInitialZoomDomain[1]) {\n\t\t\t\tnewInitialZoomDomain[0] = new Date(newInitialZoomDomain[0])\n\t\t\t\tnewInitialZoomDomain[1] = new Date(newInitialZoomDomain[1])\n\t\t\t}\n\t\t\t// update initialZoomDomain and set zoomDomain in model only if the option is changed\n\t\t\t// not the same object, and both start date and end date are not equal\n\t\t\tif (\n\t\t\t\tnewInitialZoomDomain &&\n\t\t\t\t!(\n\t\t\t\t\toldInitialZoomDomain &&\n\t\t\t\t\toldInitialZoomDomain[0].valueOf() === newInitialZoomDomain[0].valueOf() &&\n\t\t\t\t\toldInitialZoomDomain[1].valueOf() === newInitialZoomDomain[1].valueOf()\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthis.model.set(\n\t\t\t\t\t{\n\t\t\t\t\t\t// use a new object instead of newInitialZoomDomain\n\t\t\t\t\t\tinitialZoomDomain: merge([], newInitialZoomDomain),\n\t\t\t\t\t\tzoomDomain: newInitialZoomDomain ? merge([], newInitialZoomDomain) : defaultDomain\n\t\t\t\t\t},\n\t\t\t\t\t{ skipUpdate: true }\n\t\t\t\t)\n\t\t\t} else if (newInitialZoomDomain === null && oldInitialZoomDomain !== null) {\n\t\t\t\t// if newInitialZoomDomain is set to null (when oldInitialZoomDomain is not null)\n\t\t\t\t// save initialZoomDomain and reset zoom domain to default domain\n\t\t\t\tthis.model.set(\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialZoomDomain: null,\n\t\t\t\t\t\tzoomDomain: merge([], defaultDomain)\n\t\t\t\t\t},\n\t\t\t\t\t{ skipUpdate: true }\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tthis.xScale.range([axesLeftMargin, width]).domain(defaultDomain)\n\n\t\t\t// keep max selection range\n\t\t\tthis.maxSelectionRange = this.xScale.range()\n\n\t\t\tthis.yScale.range([0, zoombarHeight - 6]).domain(extent(zoomBarData, (d: any) => d.value))\n\n\t\t\tconst zoomDomain = this.model.get('zoomDomain')\n\n\t\t\tif (zoombarType === ZoomBarTypes.GRAPH_VIEW) {\n\t\t\t\tthis.renderZoomBarArea(container, 'path.zoom-graph-area-unselected', zoomBarData, null)\n\t\t\t\tthis.updateClipPath(svg, this.clipId, 0, 0, 0, 0)\n\t\t\t\tthis.renderZoomBarArea(container, 'path.zoom-graph-area', zoomBarData, this.clipId)\n\t\t\t\t// Draw the zoom bar base line\n\t\t\t\tthis.renderZoomBarBaseline(container as any, axesLeftMargin, width)\n\n\t\t\t\tif (highlight) {\n\t\t\t\t\tconst startHighlight = highlight.highlightStartMapsTo\n\t\t\t\t\tconst endHighlight = highlight.highlightEndMapsTo\n\t\t\t\t\tconst color = highlight.color\n\t\t\t\t\tconst labelMapTo = highlight.labelMapsTo\n\n\t\t\t\t\thighlight.data.forEach((element: any, index: number) => {\n\t\t\t\t\t\tDOMUtils.appendOrSelect(container, `rect.highlight-${index}`)\n\t\t\t\t\t\t\t.attr('height', zoombarHeight - 2 * this.highlightStrokeWidth)\n\t\t\t\t\t\t\t.attr('y', this.highlightStrokeWidth)\n\t\t\t\t\t\t\t.attr('x', this.xScale(element[startHighlight]))\n\t\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t\t'width',\n\t\t\t\t\t\t\t\tthis.xScale(element[endHighlight]) - this.xScale(element[startHighlight])\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.style(\n\t\t\t\t\t\t\t\t'fill',\n\t\t\t\t\t\t\t\tcolor && color.scale[element[labelMapTo]] ? color.scale[element[labelMapTo]] : null\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.style('fill-opacity', 0.1)\n\t\t\t\t\t\t\t.style(\n\t\t\t\t\t\t\t\t'stroke',\n\t\t\t\t\t\t\t\tcolor && color.scale[element[labelMapTo]] ? color.scale[element[labelMapTo]] : null\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.style('stroke-dasharray', '2, 2')\n\t\t\t\t\t\t\t.attr('stroke-width', 1 + 'px')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Attach brushing event listeners\n\t\t\tthis.addBrushEventListener(zoomDomain, axesLeftMargin, width)\n\n\t\t\t// Draw the brushing area\n\t\t\tconst brushArea = DOMUtils.appendOrSelect(svg, this.brushSelector).call(this.brush)\n\n\t\t\tif (zoomDomain === undefined) {\n\t\t\t\t// do nothing, initialization not completed yet\n\t\t\t\t// don't update brushHandle to avoid flash\n\t\t\t} else if (zoomDomain[0].valueOf() === zoomDomain[1].valueOf()) {\n\t\t\t\tbrushArea.call(this.brush.move, this.xScale.range()) // default to full range\n\t\t\t\tthis.updateBrushHandle(this.getComponentContainer(), this.xScale.range())\n\t\t\t} else {\n\t\t\t\tconst selected = zoomDomain.map((domain: any) => this.xScale(domain))\n\t\t\t\tif (selected[1] - selected[0] < this.MIN_SELECTION_DIFF) {\n\t\t\t\t\t// initialization not completed yet\n\t\t\t\t\t// don't update brushHandle to avoid flash\n\t\t\t\t} else {\n\t\t\t\t\tbrushArea.call(this.brush.move, selected) // set brush to correct position\n\t\t\t\t\tthis.updateBrushHandle(this.getComponentContainer(), selected)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isTopZoomBarLocked) {\n\t\t\t\tthis.brush.filter(() => {\n\t\t\t\t\treturn false\n\t\t\t\t})\n\t\t\t\t// reset all cursor to auto\n\t\t\t\tbrushArea.selectAll('rect').attr('cursor', 'auto')\n\t\t\t}\n\t\t}\n\t}\n\n\taddBrushEventListener(zoomDomain: any, axesLeftMargin: any, width: any) {\n\t\tconst brushEventListener = (event: any) => {\n\t\t\tconst selection = event.selection\n\t\t\t// follow d3 behavior: when selection is null, reset default full range\n\t\t\t// select behavior is completed, but nothing selected\n\t\t\tif (selection === null) {\n\t\t\t\tthis.handleBrushedEvent(event, zoomDomain, this.xScale, this.xScale.range())\n\t\t\t} else if (selection[0] === selection[1]) {\n\t\t\t\t// select behavior is not completed yet, do nothing\n\t\t\t} else {\n\t\t\t\tthis.handleBrushedEvent(event, zoomDomain, this.xScale, selection)\n\t\t\t}\n\t\t}\n\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type') as\n\t\t\t| 'graph_view'\n\t\t\t| 'slider_view'\n\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\n\t\t// Initialize the d3 brush\n\t\tthis.brush\n\t\t\t.extent([\n\t\t\t\t[axesLeftMargin, 0],\n\t\t\t\t[width, zoombarHeight]\n\t\t\t])\n\t\t\t.on('start brush end', null) // remove old listener first\n\t\t\t.on('start brush end', brushEventListener)\n\t}\n\n\t// brush event listener\n\thandleBrushedEvent(event: any, zoomDomain: any, scale: any, selection: any) {\n\t\tconst newDomain = [scale.invert(selection[0]), scale.invert(selection[1])]\n\n\t\t// update brush handle position\n\t\tthis.updateBrushHandle(this.getComponentContainer(), selection)\n\n\t\t// be aware that the value of d3.event changes during an event!\n\t\t// update zoomDomain only if the event comes from mouse/touch event\n\t\tif (\n\t\t\tevent.sourceEvent != null &&\n\t\t\t(event.sourceEvent.type === 'mousemove' ||\n\t\t\t\tevent.sourceEvent.type === 'mouseup' ||\n\t\t\t\tevent.sourceEvent.type === 'mousedown' ||\n\t\t\t\tevent.sourceEvent.type === 'touchstart' ||\n\t\t\t\tevent.sourceEvent.type === 'touchmove' ||\n\t\t\t\tevent.sourceEvent.type === 'touchend')\n\t\t) {\n\t\t\t// only if zoomDomain is never set or needs update\n\t\t\tif (\n\t\t\t\tzoomDomain === undefined ||\n\t\t\t\tzoomDomain[0] !== newDomain[0] ||\n\t\t\t\tzoomDomain[1] !== newDomain[1]\n\t\t\t) {\n\t\t\t\t// don't dispatch event for all event types\n\t\t\t\t// let the following code to dispatch necessary events\n\t\t\t\tthis.services.zoom.handleDomainChange(newDomain, {\n\t\t\t\t\tdispatchEvent: false\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// dispatch selection events\n\t\t\tlet zoomBarEventType\n\t\t\tif (event.type === 'start') {\n\t\t\t\tzoomBarEventType = Events.ZoomBar.SELECTION_START\n\t\t\t} else if (event.type === 'brush') {\n\t\t\t\tzoomBarEventType = Events.ZoomBar.SELECTION_IN_PROGRESS\n\t\t\t} else if (event.type === 'end') {\n\t\t\t\tzoomBarEventType = Events.ZoomBar.SELECTION_END\n\t\t\t\t// only dispatch zoom domain change event for triggering api call when event type equals to end\n\t\t\t\tthis.services.events.dispatchEvent(Events.ZoomDomain.CHANGE, {\n\t\t\t\t\tnewDomain\n\t\t\t\t})\n\t\t\t}\n\t\t\tthis.services.events.dispatchEvent(zoomBarEventType, {\n\t\t\t\tselection,\n\t\t\t\tnewDomain\n\t\t\t})\n\t\t}\n\t}\n\n\tupdateBrushHandle(svg: any, selection: any) {\n\t\tconst self = this\n\t\tconst handleWidth = zoomBarConfigs.handleWidth\n\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type') as\n\t\t\t| 'graph_view'\n\t\t\t| 'slider_view'\n\t\tconst handleHeight = zoomBarConfigs.height[zoombarType]\n\t\tconst handleXDiff = -handleWidth / 2\n\n\t\tconst handleBarWidth = zoomBarConfigs.handleBarWidth\n\t\tconst handleBarHeight =\n\t\t\tzoombarType === ZoomBarTypes.GRAPH_VIEW ? zoomBarConfigs.handleBarHeight : 6\n\t\tconst handleBarXDiff = -handleBarWidth / 2\n\t\tconst handleYBarDiff = (handleHeight - handleBarHeight) / 2\n\n\t\t// handle\n\t\tsvg\n\t\t\t.select(this.brushSelector)\n\t\t\t.selectAll('rect.handle')\n\t\t\t.data([{ type: 'w' }, { type: 'e' }])\n\t\t\t.attr('x', function (d: any) {\n\t\t\t\tif (d.type === 'w') {\n\t\t\t\t\t// handle should not exceed zoom bar range\n\t\t\t\t\treturn Math.max(selection[0] + handleXDiff, self.maxSelectionRange[0])\n\t\t\t\t} else if (d.type === 'e') {\n\t\t\t\t\t// handle should not exceed zoom bar range\n\t\t\t\t\treturn Math.min(selection[1] + handleXDiff, self.maxSelectionRange[1] - handleWidth)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('y', 0)\n\t\t\t.attr('width', handleWidth)\n\t\t\t.attr('height', handleHeight)\n\t\t\t.attr('cursor', 'ew-resize')\n\t\t\t.style('display', null) // always display\n\n\t\t// handle-bar\n\t\tconst handleBars = svg\n\t\t\t.select(this.brushSelector)\n\t\t\t.selectAll('rect.handle-bar')\n\t\t\t.data([{ type: 'w' }, { type: 'e' }])\n\t\t// create rect if not exists\n\t\thandleBars\n\t\t\t.enter()\n\t\t\t.append('rect')\n\t\t\t.attr('class', function (d: any) {\n\t\t\t\treturn 'handle-bar handle-bar--' + d.type\n\t\t\t})\n\t\t// update positions\n\t\thandleBars\n\t\t\t.attr('x', function (d: any) {\n\t\t\t\tif (d.type === 'w') {\n\t\t\t\t\treturn Math.max(\n\t\t\t\t\t\tselection[0] + handleBarXDiff,\n\t\t\t\t\t\tself.maxSelectionRange[0] - handleXDiff + handleBarXDiff\n\t\t\t\t\t)\n\t\t\t\t} else if (d.type === 'e') {\n\t\t\t\t\treturn Math.min(\n\t\t\t\t\t\tselection[1] + handleBarXDiff,\n\t\t\t\t\t\tself.maxSelectionRange[1] + handleXDiff + handleBarXDiff\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.attr('y', handleYBarDiff)\n\t\t\t.attr('width', handleBarWidth)\n\t\t\t.attr('height', handleBarHeight)\n\t\t\t.attr('cursor', 'ew-resize')\n\n\t\t// Update slider selected area\n\t\tif (zoombarType === ZoomBarTypes.SLIDER_VIEW) {\n\t\t\tthis.updateSliderSelectedArea(selection)\n\t\t}\n\n\t\tthis.updateClipPath(\n\t\t\tsvg,\n\t\t\tthis.clipId,\n\t\t\tselection[0],\n\t\t\t0,\n\t\t\tselection[1] - selection[0],\n\t\t\thandleHeight\n\t\t)\n\t}\n\n\tupdateSliderSelectedArea(selection: any) {\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type') as\n\t\t\t| 'graph_view'\n\t\t\t| 'slider_view'\n\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\n\t\tconst svg = this.getComponentContainer()\n\t\tconst container = svg.select('svg.zoom-container')\n\n\t\t// Draw zoombar background line\n\t\tDOMUtils.appendOrSelect(container as any, 'rect.zoom-slider-selected-area')\n\t\t\t.attr('x', selection[0])\n\t\t\t.attr('y', zoombarHeight / 2 - 1)\n\t\t\t.attr('width', selection[1] - selection[0])\n\t\t\t.attr('height', 2)\n\t}\n\n\trenderZoomBarArea(container: any, querySelector: any, data: any, clipId: any) {\n\t\tconst { cartesianScales } = this.services\n\t\tconst mainXAxisPosition = cartesianScales.getMainXAxisPosition()\n\t\tconst mainYAxisPosition = cartesianScales.getMainYAxisPosition()\n\t\tconst mainXScaleType = cartesianScales.getMainXScaleType()\n\t\tconst mainYScaleType = cartesianScales.getMainYScaleType()\n\n\t\tconst accessorFunction = (scale: any, scaleType: any, axisPosition: any) => {\n\t\t\treturn (d: any) => {\n\t\t\t\treturn cartesianScales.getValueFromScale(scale, scaleType, axisPosition, d)\n\t\t\t}\n\t\t}\n\n\t\tconst xAccessor = accessorFunction(this.xScale, mainXScaleType, mainXAxisPosition)\n\t\tconst yAccessor = accessorFunction(this.yScale, mainYScaleType, mainYAxisPosition)\n\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type') as\n\t\t\t| 'graph_view'\n\t\t\t| 'slider_view'\n\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\t\tconst areaGenerator = area()\n\t\t\t.x((d: any) => xAccessor(d))\n\t\t\t.y0(zoombarHeight)\n\t\t\t.y1((d: any) => zoombarHeight - yAccessor(d))\n\n\t\tconst areaGraph = DOMUtils.appendOrSelect(container, querySelector)\n\t\t\t.datum(data)\n\t\t\t.attr('d', areaGenerator)\n\n\t\tif (clipId) {\n\t\t\tareaGraph.attr('clip-path', `url(#${clipId})`)\n\t\t}\n\t}\n\n\tupdateClipPath(\n\t\tsvg: any,\n\t\tclipId: string,\n\t\tx: number | string,\n\t\ty: number | string,\n\t\twidth: number | string,\n\t\theight: number | string\n\t) {\n\t\tconst zoomBarClipPath = DOMUtils.appendOrSelect(svg, `clipPath`).attr('id', clipId)\n\t\tDOMUtils.appendOrSelect(zoomBarClipPath, 'rect')\n\t\t\t.attr('x', x)\n\t\t\t.attr('y', y)\n\t\t\t.attr('width', width)\n\t\t\t.attr('height', height)\n\t}\n\n\t// assume the domains in data are already sorted\n\tcompensateDataForDefaultDomain(data: any, defaultDomain: any) {\n\t\tif (!data || data.length < 2) {\n\t\t\treturn\n\t\t}\n\t\tconst zoomBarData = cloneDeep(data)\n\n\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier()\n\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier()\n\n\t\t// if min domain is extended\n\t\tif (Number(defaultDomain[0]) < Number(zoomBarData[0][domainIdentifier])) {\n\t\t\tconst newDatum: any = {}\n\t\t\tnewDatum[domainIdentifier] = defaultDomain[0]\n\t\t\tnewDatum[rangeIdentifier] = 0\n\t\t\tzoomBarData.unshift(newDatum)\n\t\t}\n\t\t// if max domain is extended\n\t\tif (Number(defaultDomain[1]) > Number(zoomBarData[zoomBarData.length - 1][domainIdentifier])) {\n\t\t\tconst newDatum: any = {}\n\t\t\tnewDatum[domainIdentifier] = defaultDomain[1]\n\t\t\tnewDatum[rangeIdentifier] = 0\n\t\t\tzoomBarData.push(newDatum)\n\t\t}\n\t\treturn zoomBarData\n\t}\n\n\trenderZoomBarBaseline(\n\t\tcontainer: HTMLElement,\n\t\tstartX: number,\n\t\tendX: number,\n\t\tskeletonClass = false\n\t) {\n\t\tconst zoombarType = getProperty(\n\t\t\tthis.model.getOptions(),\n\t\t\t'zoomBar',\n\t\t\tAxisPositions.TOP,\n\t\t\t'type'\n\t\t) as 'graph_view' | 'slider_view'\n\t\tconst zoombarHeight = zoomBarConfigs.height[zoombarType]\n\t\tconst baselineGenerator = line()([\n\t\t\t[startX, zoombarHeight],\n\t\t\t[endX, zoombarHeight]\n\t\t])\n\t\tDOMUtils.appendOrSelect(container as any, 'path.zoom-bg-baseline')\n\t\t\t.attr('d', baselineGenerator)\n\t\t\t.classed('zoom-bg-baseline-skeleton', skeletonClass)\n\t\t\t.style(\n\t\t\t\t'stroke',\n\t\t\t\tskeletonClass\n\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t: null\n\t\t\t)\n\t}\n\n\trenderSkeleton(container: any, startX: number, endX: number) {\n\t\t// need to clear current zoom bar area\n\t\tthis.renderZoomBarArea(container, 'path.zoom-graph-area-unselected', [], null)\n\t\tthis.renderZoomBarArea(container, 'path.zoom-graph-area', [], this.clipId)\n\t\t// remove brush listener\n\t\tthis.brush.on('start brush end', null)\n\t\t// clear d3 brush\n\t\tDOMUtils.appendOrSelect(this.getComponentContainer(), this.brushSelector).html(null)\n\n\t\t// re-render baseline because no axis labels in skeleton so the baseline length needs to change\n\t\tconst zoombarType = getProperty(this.getOptions(), 'zoomBar', AxisPositions.TOP, 'type')\n\t\tif (zoombarType === ZoomBarTypes.GRAPH_VIEW) {\n\t\t\tthis.renderZoomBarBaseline(container, startX, endX, true)\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.brush.on('start brush end', null) // remove event listener\n\t\tthis.services.events.removeEventListener(Events.ZoomBar.UPDATE, this.render.bind(this))\n\t}\n}\n","import { select, pointer, type ScaleBand } from 'd3'\nimport Position, { PLACEMENTS } from '@carbon/utils-position' // position services\nimport { flipDomainAndRangeBasedOnOrientation, getProperty } from '@/tools'\nimport { carbonPrefix } from '@/configuration-non-customizable' // CSS prefix\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModel } from '@/model/model'\nimport { AxisPositions, Events, RenderTypes, ScaleTypes } from '@/interfaces/enums'\nimport { formatTick, computeTimeIntervalName } from '@/services/time-series'\nimport { sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Threshold extends Component {\n\ttype = 'threshold'\n\trenderType = RenderTypes.SVG\n\n\tlabel: any\n\n\tpositionService = new Position()\n\n\tconstructor(model: ChartModel, services: any) {\n\t\tsuper(model, services)\n\t}\n\n\trender(animate = false) {\n\t\tconst axesOptions = getProperty(this.getOptions(), 'axes')\n\n\t\tconst thresholdData: any[] = []\n\n\t\tObject.keys(axesOptions).forEach(axisPosition => {\n\t\t\tif (Object.values(AxisPositions).includes(axisPosition as any)) {\n\t\t\t\tconst axisOptions = axesOptions[axisPosition]\n\n\t\t\t\tif (axisOptions.thresholds && axisOptions.thresholds.length > 0) {\n\t\t\t\t\tthresholdData.push({\n\t\t\t\t\t\taxisPosition,\n\t\t\t\t\t\tthresholds: axisOptions.thresholds,\n\t\t\t\t\t\tcorrespondingDatasets: axisOptions?.correspondingDatasets,\n\t\t\t\t\t\tmapsTo: axisOptions?.mapsTo\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\t// Update data on all axis threshold groups\n\t\tconst thresholdAxisGroups = svg\n\t\t\t.selectAll('g.axis-thresholds')\n\t\t\t.data(thresholdData, (d: any) => d.axisPosition)\n\n\t\t// Remove axis threshold groups that are no longer needed\n\t\tthresholdAxisGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the axis threshold groups that need to be introduced\n\t\tconst thresholdAxisGroupsEnter = thresholdAxisGroups.enter().append('g')\n\n\t\tconst thresholdAxisGroupsMerge = thresholdAxisGroupsEnter.merge(thresholdAxisGroups as any)\n\t\tthresholdAxisGroupsMerge.attr('class', (d: any) => `axis-thresholds ${d.axisPosition}`)\n\n\t\tconst thresholdGroups = thresholdAxisGroupsMerge.selectAll('g.threshold-group').data((d: any) =>\n\t\t\td.thresholds.map((threshold: any) => {\n\t\t\t\t// Merge relevant keys into the threshold object\n\t\t\t\tthreshold.axisPosition = d.axisPosition\n\t\t\t\tthreshold.datum = this.constructDatumObj(d, threshold)\n\t\t\t\treturn threshold\n\t\t\t})\n\t\t)\n\n\t\t// Remove threshold groups that are no longer needed\n\t\tthresholdGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the threshold groups that need to be introduced\n\t\tconst thresholdGroupsEnter = thresholdGroups.enter().append('g')\n\n\t\tthresholdGroupsEnter.append('line').attr('class', 'threshold-line')\n\t\tthresholdGroupsEnter.append('rect').attr('class', 'threshold-hoverable-area')\n\n\t\tconst thresholdGroupsMerge = thresholdGroupsEnter.merge(thresholdGroups as any)\n\t\tthresholdGroupsMerge.attr('class', 'threshold-group')\n\n\t\tconst self = this\n\t\tthresholdAxisGroupsMerge.each(function ({ axisPosition }: { axisPosition: AxisPositions }) {\n\t\t\tconst scale = self.services.cartesianScales.getScaleByPosition(\n\t\t\t\taxisPosition\n\t\t\t) as unknown as ScaleBand<string>\n\t\t\tconst scaleType = self.services.cartesianScales.getScaleTypeByPosition(axisPosition)\n\n\t\t\tlet xScale = null\n\t\t\tlet yScale = null\n\n\t\t\t// Depending on type of axis position, assign scale and main perpendicular axis\n\t\t\tif (axisPosition === AxisPositions.LEFT || axisPosition === AxisPositions.RIGHT) {\n\t\t\t\tyScale = scale\n\t\t\t\txScale = self.services.cartesianScales.getMainXScale()\n\t\t\t} else {\n\t\t\t\txScale = scale\n\t\t\t\tyScale = self.services.cartesianScales.getMainYScale()\n\t\t\t}\n\n\t\t\tconst isScaleTypeLabels = scaleType === ScaleTypes.LABELS\n\t\t\tconst [xScaleStart, xScaleEnd] = xScale.range()\n\t\t\tconst [yScaleEnd, yScaleStart] = yScale.range()\n\n\t\t\tconst { cartesianScales } = self.services\n\t\t\tconst orientation = cartesianScales.getOrientation()\n\t\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d) as number\n\t\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d) as number\n\t\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\t\tgetDomainValue,\n\t\t\t\tgetRangeValue,\n\t\t\t\torientation\n\t\t\t)\n\n\t\t\tconst group = select(this)\n\t\t\tif (axisPosition === AxisPositions.TOP || axisPosition === AxisPositions.BOTTOM) {\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('line.threshold-line')\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'threshold-line-update',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.attr('y1', yScaleStart)\n\t\t\t\t\t.attr('y2', yScaleEnd)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'x1',\n\t\t\t\t\t\t({ datum }: { datum: any }) =>\n\t\t\t\t\t\t\tgetXValue(datum) + (isScaleTypeLabels ? scale.step() / 2 : 0)\n\t\t\t\t\t)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'x2',\n\t\t\t\t\t\t({ datum }: { datum: any }) =>\n\t\t\t\t\t\t\tgetXValue(datum) + (isScaleTypeLabels ? scale.step() / 2 : 0)\n\t\t\t\t\t)\n\t\t\t\t\t.style('stroke', ({ fillColor }: { fillColor: string }) => fillColor)\n\n\t\t\t\t// Set hoverable area width and rotate it\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('rect.threshold-hoverable-area')\n\t\t\t\t\t.attr('x', 0)\n\t\t\t\t\t.attr('y', ({ datum }: { datum: any }) => -getXValue(datum))\n\t\t\t\t\t.attr('width', Math.abs(yScaleEnd - yScaleStart))\n\t\t\t\t\t.classed('rotate', true)\n\t\t\t} else {\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('line.threshold-line')\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'threshold-line-update',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.attr('x1', xScaleStart)\n\t\t\t\t\t.attr('x2', xScaleEnd)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'y1',\n\t\t\t\t\t\t({ datum }: { datum: any }) =>\n\t\t\t\t\t\t\tgetYValue(datum) + (isScaleTypeLabels ? scale.step() / 2 : 0)\n\t\t\t\t\t)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'y2',\n\t\t\t\t\t\t({ datum }: { datum: any }) =>\n\t\t\t\t\t\t\tgetYValue(datum) + (isScaleTypeLabels ? scale.step() / 2 : 0)\n\t\t\t\t\t)\n\t\t\t\t\t.style('stroke', ({ fillColor }: { fillColor: string }) => fillColor)\n\n\t\t\t\t// Set hoverable area width\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('rect.threshold-hoverable-area')\n\t\t\t\t\t.attr('x', xScaleStart)\n\t\t\t\t\t.attr('y', ({ datum }: { datum: any }) => getYValue(datum))\n\t\t\t\t\t.attr('width', Math.abs(xScaleEnd - xScaleStart))\n\t\t\t\t\t.classed('rotate', false)\n\t\t\t}\n\t\t})\n\n\t\t// Add event listener for showing the threshold tooltip\n\t\tthis.services.events.addEventListener(Events.Threshold.SHOW, (e: any) => {\n\t\t\tthis.setThresholdLabelPosition(e.detail)\n\n\t\t\tthis.label.classed('hidden', false)\n\t\t})\n\n\t\t// Add event listener for hiding the threshold tooltip\n\t\tthis.services.events.addEventListener(Events.Threshold.HIDE, () => {\n\t\t\tthis.label.classed('hidden', true)\n\t\t})\n\n\t\tthis.appendThresholdLabel()\n\n\t\tthis.addEventListeners()\n\t}\n\n\tgetFormattedValue(datum: any) {\n\t\tconst { value, axisPosition } = datum\n\t\tconst options = this.getOptions()\n\t\tconst scaleType = this.services.cartesianScales.getScaleTypeByPosition(axisPosition)\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\t// If scale is time, format the threshold date as the ticks format\n\t\tif (scaleType === ScaleTypes.TIME) {\n\t\t\tconst isVertical = [AxisPositions.LEFT, AxisPositions.RIGHT].includes(axisPosition)\n\t\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\t\tconst mainYScale = this.services.cartesianScales.getMainYScale()\n\t\t\tconst scale = isVertical ? mainYScale : mainXScale\n\n\t\t\tconst timeScaleOptions = getProperty(options, 'timeScale')\n\t\t\tconst timeInterval = computeTimeIntervalName(\n\t\t\t\tscale.ticks(),\n\t\t\t\tgetProperty(timeScaleOptions, 'timeInterval')\n\t\t\t)\n\n\t\t\treturn formatTick(value, 0, scale.ticks(), timeInterval, timeScaleOptions, options.locale)\n\t\t}\n\n\t\treturn numberFormatter(value, localeCode)\n\t}\n\n\tappendThresholdLabel() {\n\t\tconst holder = select(this.services.domUtils.getHolder())\n\n\t\tconst chartprefix = getProperty(this.getOptions(), 'style', 'prefix')\n\n\t\tthis.label = DOMUtils.appendOrSelect(\n\t\t\tholder,\n\t\t\t`div.${carbonPrefix}--${chartprefix}--threshold--label`\n\t\t).classed('hidden', true)\n\t}\n\n\tsetThresholdLabelPosition({ event, datum }: { event: CustomEvent; datum: any }) {\n\t\tconst holder = this.services.domUtils.getHolder()\n\t\tconst mouseRelativePos = pointer(event, holder)\n\n\t\t// Format the threshold value using valueFormatter if defined in user-provided options\n\t\tconst formattedValue = datum.valueFormatter\n\t\t\t? datum.valueFormatter(datum.value)\n\t\t\t: this.getFormattedValue(datum)\n\n\t\tthis.label\n\t\t\t.html(sanitizeText(`${datum.label || 'Threshold'}: ${formattedValue}`))\n\t\t\t.style('background-color', datum.fillColor)\n\n\t\tconst target = this.label.node()\n\t\t// Find out whether threshold label should be shown on the left or right side\n\t\tconst bestPlacementOption = this.positionService.findBestPlacementAt(\n\t\t\t{\n\t\t\t\tleft: mouseRelativePos[0],\n\t\t\t\ttop: mouseRelativePos[1]\n\t\t\t},\n\t\t\ttarget,\n\t\t\t[PLACEMENTS.RIGHT, PLACEMENTS.LEFT, PLACEMENTS.TOP, PLACEMENTS.BOTTOM],\n\t\t\t() => ({\n\t\t\t\ttop: undefined, // other package lists this as non-optional\n\t\t\t\tleft: undefined, // ditto\n\t\t\t\twidth: holder.offsetWidth,\n\t\t\t\theight: holder.offsetHeight\n\t\t\t})\n\t\t)\n\n\t\t// Get coordinates to where label should be positioned\n\t\tconst pos = this.positionService.findPositionAt(\n\t\t\t{\n\t\t\t\tleft: mouseRelativePos[0],\n\t\t\t\ttop: mouseRelativePos[1]\n\t\t\t},\n\t\t\ttarget,\n\t\t\tbestPlacementOption\n\t\t)\n\n\t\tthis.positionService.setElement(target, pos)\n\t}\n\n\t// Constructs object to pass in scale functions\n\tconstructDatumObj(d: any, element: any) {\n\t\tconst datum: any = {}\n\n\t\t// We only need to specify group only if correpsonding dataset is defined\n\t\tif (d.correspondingDatasets) {\n\t\t\tdatum['group'] = getProperty(d, 'correspondingDatasets', 0)\n\t\t}\n\n\t\t// Add attribute with the mapsTo value as key\n\t\tdatum[d['mapsTo']] = element.value\n\n\t\treturn datum\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\t// Add events to the threshold hoverable area\n\t\tsvg\n\t\t\t.selectAll('rect.threshold-hoverable-area')\n\t\t\t.on('mouseover mousemove', function (event: MouseEvent) {\n\t\t\t\tselect((this as any).parentNode)\n\t\t\t\t\t.select('line.threshold-line')\n\t\t\t\t\t.classed('active', true)\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Threshold.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement: select(this),\n\t\t\t\t\tdatum: select(this).datum()\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent) {\n\t\t\t\tselect((this as any).parentNode)\n\t\t\t\t\t.select('line.threshold-line')\n\t\t\t\t\t.classed('active', false)\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Threshold.HIDE, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement: select(this),\n\t\t\t\t\tdatum: select(this).datum()\n\t\t\t\t})\n\t\t\t})\n\t}\n}\n","import { select } from 'd3'\nimport Position from '@carbon/utils-position' // position service\nimport { flipDomainAndRangeBasedOnOrientation, getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport type { ChartModel } from '@/model/model'\nimport { AxisPositions, type CartesianOrientations, RenderTypes } from '@/interfaces/enums'\n\nexport class Highlight extends Component {\n\ttype = 'highlight'\n\trenderType = RenderTypes.SVG\n\n\tlabel: any\n\n\tpositionService = new Position()\n\thighlightStrokeWidth = 1\n\n\tconstructor(model: ChartModel, services: any) {\n\t\tsuper(model, services)\n\t}\n\n\trender(animate = false) {\n\t\tconst axesOptions = getProperty(this.getOptions(), 'axes')\n\t\tconst highlightData: any[] = []\n\n\t\tObject.keys(axesOptions).forEach((axisPosition: any) => {\n\t\t\tif (Object.values(AxisPositions).includes(axisPosition as any)) {\n\t\t\t\tconst axisOptions = axesOptions[axisPosition]\n\t\t\t\tif (axisOptions.highlights && axisOptions.highlights.data.length > 0) {\n\t\t\t\t\thighlightData.push({\n\t\t\t\t\t\taxisPosition,\n\t\t\t\t\t\thighlightStartMapsTo: axisOptions.highlights.highlightStartMapsTo,\n\t\t\t\t\t\thighlightEndMapsTo: axisOptions.highlights.highlightEndMapsTo,\n\t\t\t\t\t\tlabelMapsTo: axisOptions.highlights.labelMapsTo,\n\t\t\t\t\t\thighlight: axisOptions.highlights.data,\n\t\t\t\t\t\tcolor: axisOptions.highlights.color\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\t// Update data on all axis highlight groups\n\t\tconst highlightAxisGroups = svg\n\t\t\t.selectAll('g.axis-highlight')\n\t\t\t.data(highlightData, (d: any) => d.axisPosition)\n\n\t\t// Remove axis highlight groups that are no longer needed\n\t\thighlightAxisGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the axis highlight groups that need to be introduced\n\t\tconst highlightAxisGroupsEnter = highlightAxisGroups.enter().append('g')\n\n\t\tconst highlightAxisGroupsMerge = highlightAxisGroupsEnter.merge(highlightAxisGroups as any)\n\t\thighlightAxisGroupsMerge.attr('class', (d: any) => `axis-highlight ${d.axisPosition}`)\n\n\t\tconst highlightGroups = highlightAxisGroupsMerge.selectAll('g.highlight-group').data((d: any) =>\n\t\t\td.highlight.map((highlight: any) => {\n\t\t\t\thighlight.axisPosition = d.axisPosition\n\t\t\t\thighlight.highlightStartMapsTo = d.highlightStartMapsTo\n\t\t\t\thighlight.labelMapsTo = d.labelMapsTo\n\t\t\t\thighlight.color = d.color\n\t\t\t\thighlight.highlightEndMapsTo = d.highlightEndMapsTo\n\t\t\t\treturn highlight\n\t\t\t})\n\t\t)\n\n\t\t// Remove highlight groups that are no longer needed\n\t\thighlightGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the highlight groups that need to be introduced\n\t\tconst highlightGroupsEnter = highlightGroups.enter().append('g')\n\n\t\thighlightGroupsEnter.append('rect').attr('class', 'highlight-bar')\n\t\thighlightGroupsEnter.append('line').attr('class', 'highlight-line')\n\n\t\tconst highlightGroupsMerge = highlightGroupsEnter.merge(highlightGroups as any)\n\t\thighlightGroupsMerge.attr('class', 'highlight-group')\n\n\t\tconst self = this\n\t\thighlightAxisGroupsMerge.each(function ({ axisPosition }) {\n\t\t\tconst mainXScale = self.services.cartesianScales.getMainXScale()\n\t\t\tconst mainYScale = self.services.cartesianScales.getMainYScale()\n\t\t\tconst [xScaleStart, xScaleEnd] = mainXScale.range()\n\t\t\tconst [yScaleEnd, yScaleStart] = mainYScale.range()\n\n\t\t\tconst { cartesianScales } = self.services\n\t\t\tconst orientation = cartesianScales.getOrientation() as CartesianOrientations\n\t\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d) as number\n\t\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d) as number\n\t\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\t\tgetDomainValue,\n\t\t\t\tgetRangeValue,\n\t\t\t\torientation\n\t\t\t)\n\n\t\t\tconst group = select(this)\n\t\t\tif (axisPosition === AxisPositions.TOP || axisPosition === AxisPositions.BOTTOM) {\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('rect.highlight-bar')\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'highlight-bar-update',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t// Stroke width added to stop overflow of highlight\n\t\t\t\t\t.attr('y', Math.max(yScaleStart + self.highlightStrokeWidth, 0))\n\t\t\t\t\t// Stroke width subtracted to stop overflow of highlight\n\t\t\t\t\t.attr('height', Math.max(yScaleEnd - 2 * self.highlightStrokeWidth, 0))\n\t\t\t\t\t.attr('x', ({ highlightStartMapsTo, ...d }) => getXValue(d[highlightStartMapsTo]))\n\t\t\t\t\t.attr('width', ({ highlightStartMapsTo, highlightEndMapsTo, ...d }) =>\n\t\t\t\t\t\tMath.max(getXValue(d[highlightEndMapsTo]) - getXValue(d[highlightStartMapsTo]), 0)\n\t\t\t\t\t)\n\t\t\t\t\t.style('stroke', ({ color, labelMapsTo, ...data }) => {\n\t\t\t\t\t\treturn color && color.scale[data[labelMapsTo]] ? color.scale[data[labelMapsTo]] : null\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-dasharray', '2, 2')\n\t\t\t\t\t.attr('stroke-width', self.highlightStrokeWidth + 'px')\n\t\t\t\t\t.style('fill-opacity', 0.1)\n\t\t\t\t\t.style('fill', ({ color, labelMapsTo, ...data }) => {\n\t\t\t\t\t\treturn color && color.scale[data[labelMapsTo]] ? color.scale[data[labelMapsTo]] : null\n\t\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tgroup\n\t\t\t\t\t.selectAll('rect.highlight-bar')\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'highlight-bar-update',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.attr('x', xScaleStart)\n\t\t\t\t\t.attr('width', Math.max(xScaleEnd - xScaleStart, 0))\n\t\t\t\t\t.attr('y', ({ highlightEndMapsTo, ...d }) => getYValue(d[highlightEndMapsTo]))\n\t\t\t\t\t.attr('height', ({ highlightStartMapsTo, highlightEndMapsTo, ...d }) =>\n\t\t\t\t\t\tMath.max(getYValue(d[highlightStartMapsTo]) - getYValue(d[highlightEndMapsTo]), 0)\n\t\t\t\t\t)\n\t\t\t\t\t.style('stroke', ({ color, labelMapsTo, ...data }) => {\n\t\t\t\t\t\treturn color && color.scale[data[labelMapsTo]] ? color.scale[data[labelMapsTo]] : null\n\t\t\t\t\t})\n\t\t\t\t\t.style('stroke-dasharray', '2, 2')\n\t\t\t\t\t.attr('stroke-width', self.highlightStrokeWidth + 'px')\n\t\t\t\t\t.style('fill-opacity', 0.1)\n\t\t\t\t\t.style('fill', ({ color, labelMapsTo, ...data }) => {\n\t\t\t\t\t\treturn color && color.scale[data[labelMapsTo]] ? color.scale[data[labelMapsTo]] : null\n\t\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n}\n","import { get } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { Tooltip } from './tooltip'\nimport { ColorClassNameTypes } from '@/interfaces/enums'\n\nexport class AxisChartsTooltip extends Tooltip {\n\tgetItems(e: CustomEvent) {\n\t\tif (e.detail.items) {\n\t\t\treturn e.detail.items\n\t\t}\n\n\t\tconst { data } = e.detail\n\t\tif (!data || !data.length || !data[0]) {\n\t\t\treturn []\n\t\t}\n\n\t\tconst options = this.getOptions()\n\t\tconst { cartesianScales } = this.services\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier()\n\t\tconst dualAxes = cartesianScales.isDualAxes()\n\n\t\t// Generate default tooltip\n\t\tconst { groupMapsTo } = options.data\n\t\tconst domainLabel = cartesianScales.getDomainLabel()\n\t\tlet rangeLabel = cartesianScales.getRangeLabel()\n\n\t\tconst domainValue = data[0][domainIdentifier]\n\t\tlet items: any[]\n\t\tif (data.length === 1) {\n\t\t\tconst datum = data[0]\n\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier(datum)\n\n\t\t\tif (dualAxes) {\n\t\t\t\tconst position = cartesianScales.getRangeAxisPosition({\n\t\t\t\t\tdatum,\n\t\t\t\t\tgroups: [datum[groupMapsTo]]\n\t\t\t\t})\n\t\t\t\trangeLabel = cartesianScales.getScaleLabel(position)\n\t\t\t}\n\t\t\tconst value = datum[rangeIdentifier]\n\n\t\t\titems = [\n\t\t\t\t{\n\t\t\t\t\tlabel: domainLabel,\n\t\t\t\t\tvalue: domainValue\n\t\t\t\t},\n\t\t\t\t...(Array.isArray(value) && value.length === 2\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Start',\n\t\t\t\t\t\t\t\tvalue: value[0]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'End',\n\t\t\t\t\t\t\t\tvalue: value[1]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: rangeLabel,\n\t\t\t\t\t\t\t\tvalue: datum[rangeIdentifier]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t])\n\t\t\t]\n\n\t\t\tif (e.detail.additionalItems) {\n\t\t\t\te.detail.additionalItems.forEach((additionalItem: any) =>\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: additionalItem.label,\n\t\t\t\t\t\tvalue: additionalItem.value\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\n\t\t\titems.push({\n\t\t\t\tlabel: get(options, 'locale.translations.group') || get(options, 'tooltip.groupLabel'),\n\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\tcolor: this.model.getFillColor(datum[groupMapsTo]),\n\t\t\t\tclass: this.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\tdataGroupName: datum[groupMapsTo]\n\t\t\t\t})\n\t\t\t})\n\t\t} else if (data.length > 1) {\n\t\t\titems = [\n\t\t\t\t{\n\t\t\t\t\tlabel: domainLabel,\n\t\t\t\t\tvalue: domainValue\n\t\t\t\t}\n\t\t\t]\n\n\t\t\titems = items.concat(\n\t\t\t\tdata\n\t\t\t\t\t.map((datum: any) => {\n\t\t\t\t\t\t// Format value if is array\n\t\t\t\t\t\tconst value = datum[cartesianScales.getRangeIdentifier(datum)]\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tlabel: datum[groupMapsTo],\n\t\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\t\tArray.isArray(value) && value.length === 2 ? `${value[0]} - ${value[1]}` : value,\n\t\t\t\t\t\t\tcolor: this.model.getFillColor(datum[groupMapsTo]),\n\t\t\t\t\t\t\tclass: this.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\t\t\tdataGroupName: datum[groupMapsTo]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.sort((a: any, b: any) => b.value - a.value)\n\t\t\t)\n\n\t\t\tif (!dualAxes && getProperty(options, 'tooltip', 'showTotal') === true) {\n\t\t\t\t// use the primary/only range id\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier()\n\t\t\t\titems.push({\n\t\t\t\t\tlabel:\n\t\t\t\t\t\tget(options, 'locale.translations.total') ||\n\t\t\t\t\t\tget(options, 'tooltip.totalLabel') ||\n\t\t\t\t\t\t'Total',\n\t\t\t\t\tvalue: data.reduce(\n\t\t\t\t\t\t(accumulator: number, datum: any) => accumulator + datum[rangeIdentifier],\n\t\t\t\t\t\t0\n\t\t\t\t\t),\n\t\t\t\t\tbold: true\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\treturn items\n\t}\n}\n","import { select } from 'd3'\nimport {\n\tsankey as d3Sankey,\n\tsankeyLinkHorizontal,\n\tsankeyLeft,\n\tsankeyRight,\n\tsankeyJustify\n} from 'd3-sankey'\nimport { debounce } from 'lodash-es'\nimport { getProperty, getTransformOffsets } from '@/tools'\nimport { alluvial as alluvialConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, ColorClassNameTypes, RenderTypes, Alignments } from '@/interfaces/enums'\n\n// BUG: Typing is not working for this.services.domUtils from the base class Component.\n// DOMUtils is already imported directly to this module so why bother using this.services.domUtils?\n\nexport class Alluvial extends Component {\n\ttype = 'alluvial'\n\trenderType = RenderTypes.SVG\n\n\tprivate graph: any\n\tgradient_id = 'gradient-id-' + Math.floor(Math.random() * 99999999999)\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\t// svg and container widths\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tsvg.html('')\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// Because of a Firefox bug with regards to sizing & d3 packs,\n\t\t// rather than checking if height or width aren't 0,\n\t\t// we have to make sure they're not smaller than 1\n\t\tif (width < 1 || height < 1) {\n\t\t\treturn\n\t\t}\n\t\tconst options = this.model.getOptions()\n\t\tconst data = this.model.getDisplayData()\n\n\t\t// Is gradient enabled or not\n\t\tconst isGradientAllowed: boolean = getProperty(\n\t\t\tthis.getOptions(),\n\t\t\t'color',\n\t\t\t'gradient',\n\t\t\t'enabled'\n\t\t)\n\n\t\t// Set the custom node padding if provided\n\t\tlet nodePadding = alluvialConfigs.minNodePadding\n\t\tif (options.alluvial.nodePadding > alluvialConfigs.minNodePadding) {\n\t\t\tnodePadding = options.alluvial.nodePadding\n\t\t}\n\n\t\tconst alignment = getProperty(options, 'alluvial', 'nodeAlignment')\n\n\t\tlet nodeAlignment = sankeyJustify\n\n\t\tif (alignment === Alignments.LEFT) {\n\t\t\tnodeAlignment = sankeyLeft\n\t\t} else if (alignment === Alignments.RIGHT) {\n\t\t\tnodeAlignment = sankeyRight\n\t\t}\n\n\t\tconst sankey = d3Sankey()\n\t\t\t.nodeId((node: any) => node.name)\n\t\t\t.nodeWidth(alluvialConfigs.nodeWidth)\n\t\t\t// Distance nodes are apart from each other\n\t\t\t.nodePadding(nodePadding)\n\t\t\t// Alignment of nodes within chart\n\t\t\t.nodeAlign(nodeAlignment)\n\t\t\t// Size of the chart and its padding\n\t\t\t// Chart starts at 2 and ends at width - 2 so the outer nodes can expand from center\n\t\t\t// Chart starts from 30 so node categories can be displayed\n\t\t\t.extent([\n\t\t\t\t[2, 30],\n\t\t\t\t[width - 2, height]\n\t\t\t])\n\n\t\t// Construct a graph with the provided user data\n\t\t// Data must be deep cloned to ensure user passed data isn't deleted when themes change\n\t\tthis.graph = sankey({\n\t\t\tnodes: options.alluvial.nodes.map((d: any) => Object.assign({}, d)),\n\t\t\tlinks: data.map((d: any) => Object.assign({}, d))\n\t\t})\n\n\t\t// Filter out unused nodes so they are not rendered\n\t\tthis.graph.nodes = this.graph.nodes.filter((node: any) => node.value !== 0)\n\n\t\t// Determine the category name placement x position\n\t\tconst nodeCoordinates: any = {}\n\t\tthis.graph.nodes.forEach((element: any) => {\n\t\t\tconst point = element.x0\n\n\t\t\t// Only 1 category per x-value\n\t\t\tif (element.category) {\n\t\t\t\tnodeCoordinates[point] = element?.category\n\t\t\t}\n\t\t})\n\n\t\t// Add node category text\n\t\tconst alluvialCategory = svg\n\t\t\t.append('g')\n\t\t\t.classed('header-arrows', true)\n\t\t\t.selectAll('g')\n\t\t\t.data(Object.keys(nodeCoordinates))\n\t\t\t.join('g')\n\t\t\t.attr('transform', (d: any) => {\n\t\t\t\treturn `translate(${d}, 0)`\n\t\t\t})\n\n\t\t// Add the category text\n\t\talluvialCategory\n\t\t\t.append('text')\n\t\t\t.attr('id', (_: any, i: number) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`alluvial-category-${i}`)\n\t\t\t)\n\t\t\t.style('font-size', '14px')\n\t\t\t.text((d: any) => {\n\t\t\t\tif (nodeCoordinates[d]) {\n\t\t\t\t\treturn nodeCoordinates[d]\n\t\t\t\t}\n\t\t\t\treturn ''\n\t\t\t})\n\t\t\t.attr('y', 20)\n\t\t\t.attr('x', (d: any, i: number) => {\n\t\t\t\tconst elementID = this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`alluvial-category-${i}`\n\t\t\t\t) as string\n\n\t\t\t\tconst { width: textWidth } = DOMUtils.getSVGElementSize(select(`text#${elementID}`), {\n\t\t\t\t\tuseBBox: true\n\t\t\t\t})\n\n\t\t\t\t// Make the text on the left on node group (except first column)\n\t\t\t\tlet x = 0\n\t\t\t\tif (d + x >= textWidth) {\n\t\t\t\t\tx = -textWidth + 4\n\t\t\t\t}\n\t\t\t\treturn x\n\t\t\t})\n\n\t\t// Draws the links (Waves)\n\t\tconst links = svg.append('g').attr('fill', 'none').selectAll('g').data(this.graph.links)\n\n\t\t// Exit so we can have multiple appends in group\n\t\tlinks.exit().remove()\n\n\t\t// Add gradient if requsted\n\t\tif (isGradientAllowed) {\n\t\t\tconst scale = getProperty(this.getOptions(), 'color', 'scale')\n\n\t\t\tif (scale) {\n\t\t\t\tlinks\n\t\t\t\t\t.enter()\n\t\t\t\t\t.append('linearGradient')\n\t\t\t\t\t.attr('id', (d: any) => `${this.gradient_id}-link-${d.index}`)\n\t\t\t\t\t.attr('gradientUnits', 'userSpaceOnUse')\n\t\t\t\t\t.call((gradient: any) =>\n\t\t\t\t\t\tgradient\n\t\t\t\t\t\t\t.append('stop')\n\t\t\t\t\t\t\t.attr('offset', '0%')\n\t\t\t\t\t\t\t.attr('stop-color', (d: any) => {\n\t\t\t\t\t\t\t\treturn scale[d.source.name]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.call((gradient: any) =>\n\t\t\t\t\t\tgradient\n\t\t\t\t\t\t\t.append('stop')\n\t\t\t\t\t\t\t.attr('offset', '100%')\n\t\t\t\t\t\t\t.attr('stop-color', (d: any) => {\n\t\t\t\t\t\t\t\treturn scale[d.target.name]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t}\n\t\t\t// Exit so path can be appended to the group\n\t\t\tlinks.exit().remove()\n\t\t}\n\n\t\tlinks\n\t\t\t.enter()\n\t\t\t.append('path')\n\t\t\t.classed('link', true)\n\t\t\t.attr('d', sankeyLinkHorizontal())\n\t\t\t.attr('id', (d: any) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`alluvial-line-${d.index}`)\n\t\t\t)\n\t\t\t.attr('class', (d: any) => {\n\t\t\t\t// Use a single color for the lines\n\t\t\t\tif (options.alluvial.monochrome) {\n\t\t\t\t\treturn this.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\t\tdataGroupName: 0,\n\t\t\t\t\t\toriginalClassName: 'link'\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn this.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\tdataGroupName: d.source.index,\n\t\t\t\t\toriginalClassName: 'link'\n\t\t\t\t})\n\t\t\t})\n\t\t\t.style('stroke', (d: any) => {\n\t\t\t\tif (isGradientAllowed) {\n\t\t\t\t\treturn `url(#${this.gradient_id}-link-${d.index})`\n\t\t\t\t}\n\t\t\t\treturn this.model.getFillColor(d.source.name, null, {\n\t\t\t\t\t...d,\n\t\t\t\t\tsource: d.source.name,\n\t\t\t\t\ttarget: d.target.name\n\t\t\t\t})\n\t\t\t})\n\t\t\t.attr('stroke-width', (d: any) => Math.max(1, d.width))\n\t\t\t.style('stroke-opacity', alluvialConfigs.opacity.default)\n\t\t\t.attr(\n\t\t\t\t'aria-label',\n\t\t\t\t(d: any) =>\n\t\t\t\t\t`${d.source.name} → ${d.target.name} (${d.value}${\n\t\t\t\t\t\toptions.alluvial.units ? ' ' + options.alluvial.units : ''\n\t\t\t\t\t})`\n\t\t\t)\n\n\t\t// Creating the groups\n\t\tconst node = svg\n\t\t\t.append('g')\n\t\t\t.selectAll('g')\n\t\t\t.data(this.graph.nodes)\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.attr('id', (d: any) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`alluvial-node-${d.index}`)\n\t\t\t)\n\t\t\t.classed('node-group', true)\n\t\t\t.attr('transform', (d: any) => `translate(${d.x0}, ${d.y0})`)\n\n\t\t// Creating the nodes\n\t\tnode\n\t\t\t.append('rect')\n\t\t\t.classed('node', true)\n\t\t\t.attr('height', (d: any) => d.y1 - d.y0)\n\t\t\t.attr('width', (d: any) => d.x1 - d.x0)\n\t\t\t.attr('fill', 'black')\n\n\t\t// Group to hold the text & rectangle background\n\t\tconst textNode = node\n\t\t\t.append('g')\n\t\t\t.attr('id', (d: any) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`alluvial-node-title-${d.index}`)\n\t\t\t)\n\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\t// Node title - text\n\t\ttextNode\n\t\t\t.append('text')\n\t\t\t.attr('id', (d: any) =>\n\t\t\t\tthis.services.domUtils.generateElementIDString(`alluvial-node-text-${d.index}`)\n\t\t\t)\n\t\t\t.attr('class', 'node-text')\n\t\t\t.style('font-size', '12px')\n\t\t\t.attr('text-anchor', 'start')\n\t\t\t.attr('fill', 'white')\n\t\t\t// Padding to text\n\t\t\t.attr('x', 4)\n\t\t\t// shift 13 pixels down to fit background container\n\t\t\t.attr('dy', 13)\n\t\t\t.text((d: any) => {\n\t\t\t\treturn `${d.name} (${numberFormatter(d.value, localeCode)})`\n\t\t\t})\n\t\t\t.attr('aria-label', (d: any) => {\n\t\t\t\treturn `${d.name} (${d.value})`\n\t\t\t})\n\n\t\t// Text background\n\t\ttextNode\n\t\t\t.append('rect')\n\t\t\t.classed('node-text-bg', true)\n\t\t\t.attr('width', (_: any, i: number) => {\n\t\t\t\tconst elementID = this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`alluvial-node-text-${i}`\n\t\t\t\t) as string\n\n\t\t\t\t// Determine rectangle width based on text width\n\t\t\t\tconst { width: textWidth } = DOMUtils.getSVGElementSize(select(`text#${elementID}`), {\n\t\t\t\t\tuseBBox: true\n\t\t\t\t})\n\n\t\t\t\treturn textWidth + 8\n\t\t\t})\n\t\t\t.attr('height', 18)\n\t\t\t.attr('stroke-width', 2)\n\t\t\t.lower()\n\n\t\t// Position group based on text width\n\t\ttextNode.attr('transform', (d: any, i: number) => {\n\t\t\tconst elementID = this.services.domUtils.generateElementIDString(\n\t\t\t\t`alluvial-node-text-${i}`\n\t\t\t) as string\n\n\t\t\tconst { width: textWidth } = DOMUtils.getSVGElementSize(select(`text#${elementID}`), {\n\t\t\t\tuseBBox: true\n\t\t\t})\n\n\t\t\t// Subtracting 9 since text background is 18 to center\n\t\t\tconst y = (d.y1 - d.y0) / 2 - 9\n\t\t\t// Node width\n\t\t\tlet x = d.x1 - d.x0\n\n\t\t\t// Display bars on the right instead of left of the node\n\t\t\tif (d.x1 >= textWidth) {\n\t\t\t\t// 16 = node width (4) + text container padding (8) + distance between node and text container (4)\n\t\t\t\tx = x - (textWidth + 16)\n\t\t\t} else {\n\t\t\t\t// Add padding to text containers\n\t\t\t\tx += 4\n\t\t\t}\n\n\t\t\treturn `translate(${x}, ${y})`\n\t\t})\n\n\t\tthis.addLineEventListener()\n\t\tthis.addNodeEventListener()\n\t}\n\n\taddLineEventListener() {\n\t\tconst options = this.getOptions()\n\t\tconst self = this\n\t\tconst { number: numberFormatter, code: localeCode } = getProperty(this.getOptions(), 'locale')\n\n\t\t// Set delay to counter flashy behaviour\n\t\tconst debouncedLineHighlight = debounce((link, event = 'mouseover') => {\n\t\t\tconst allLinks = self.parent\n\t\t\t\t.selectAll('path.link')\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'alluvial-links-mouse-highlight'\n\t\t\t\t\t})\n\t\t\t\t)\n\n\t\t\tif (event === 'mouseout') {\n\t\t\t\tselect(link).lower()\n\t\t\t\tallLinks.style('stroke-opacity', alluvialConfigs.opacity.default)\n\t\t\t} else {\n\t\t\t\tallLinks.style('stroke-opacity', function () {\n\t\t\t\t\t// highlight and raise if link is this\n\t\t\t\t\tif (link === this) {\n\t\t\t\t\t\tselect(this).raise()\n\t\t\t\t\t\treturn alluvialConfigs.opacity.selected\n\t\t\t\t\t}\n\n\t\t\t\t\treturn alluvialConfigs.opacity.unfocus\n\t\t\t\t})\n\t\t\t}\n\t\t}, 33)\n\n\t\tthis.parent\n\t\t\t.selectAll('path.link')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tdebouncedLineHighlight(this, 'mouseover')\n\t\t\t\thoveredElement.classed('link-hovered', true)\n\n\t\t\t\tconst strokeColor = getComputedStyle(this as Element).getPropertyValue('stroke')\n\n\t\t\t\t// Dispatch mouse over event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.LINE_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Dispatch tooltip show event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: datum.target.name,\n\t\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\t\t(numberFormatter(datum.value, localeCode)\n\t\t\t\t\t\t\t\t\t? `${numberFormatter(datum.value, localeCode)}`\n\t\t\t\t\t\t\t\t\t: '-') + (options.alluvial.units ? ` ${options.alluvial.units}` : ''),\n\t\t\t\t\t\t\tcolor: strokeColor,\n\t\t\t\t\t\t\tlabelIcon: self.getRightArrowIcon()\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.LINE_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t\t// Dispatch tooltip move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse click event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.LINE_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tdebouncedLineHighlight(this, 'mouseout')\n\t\t\t\thoveredElement.classed('link-hovered', false)\n\n\t\t\t\t// Dispatch mouse out event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.LINE_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Dispatch hide tooltip event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\taddNodeEventListener() {\n\t\tconst self = this\n\n\t\t// Set delay to counter flashy behaviour\n\t\tconst debouncedLineHighlight = debounce((links = [], event = 'mouseover') => {\n\t\t\tif (event === 'mouseout' || links.length === 0) {\n\t\t\t\t// set all links to default opacity & corret link order\n\t\t\t\tself.parent\n\t\t\t\t\t.selectAll('path.link')\n\t\t\t\t\t.classed('link-hovered', false)\n\t\t\t\t\t.data(this.graph.links, (d: any) => d.index)\n\t\t\t\t\t.order()\n\t\t\t\t\t.style('stroke-opacity', alluvialConfigs.opacity.default)\n\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Highlight all nodes\n\t\t\tconst allLinks = self.parent\n\t\t\t\t.selectAll('path.link')\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'alluvial-link-mouse-highlight'\n\t\t\t\t\t})\n\t\t\t\t)\n\n\t\t\tallLinks.style('stroke-opacity', function (d: any) {\n\t\t\t\t// Raise the links & increase stroke-opacity to selected\n\t\t\t\tif (links.some((element: any) => element === d.index)) {\n\t\t\t\t\tselect(this).classed('link-hovered', true).raise()\n\t\t\t\t\treturn alluvialConfigs.opacity.selected\n\t\t\t\t}\n\n\t\t\t\treturn alluvialConfigs.opacity.unfocus\n\t\t\t})\n\t\t}, 66)\n\n\t\tself.parent\n\t\t\t.selectAll('.node-group')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Highlight all links that pass through node\n\t\t\t\tconst paths: any[] = []\n\n\t\t\t\t// Outgoing links\n\t\t\t\tself.traverse({ link: 'sourceLinks', node: 'target' }, datum, paths)\n\n\t\t\t\t//Incoming links\n\t\t\t\tself.traverse({ link: 'targetLinks', node: 'source' }, datum, paths)\n\n\t\t\t\t// Highlight all linked lines in the graph data structure\n\t\t\t\tif (paths.length) {\n\t\t\t\t\t// Get transformation value of node\n\t\t\t\t\tconst nodeMatrix = getTransformOffsets(hoveredElement.attr('transform'))\n\n\t\t\t\t\t// Move node to the left by 2 to grow node from the center\n\t\t\t\t\thoveredElement.attr('transform', `translate(${nodeMatrix.x - 2}, ${nodeMatrix.y})`)\n\n\t\t\t\t\thoveredElement.classed('node-hovered', true).selectAll('rect.node').attr('width', 8)\n\n\t\t\t\t\t// Translate first column text container to the\n\t\t\t\t\t// right so it doesn't clash with expanding node\n\t\t\t\t\tif (datum.x0 - 2 === 0) {\n\t\t\t\t\t\tconst elementID = self.services.domUtils.generateElementIDString(\n\t\t\t\t\t\t\t`alluvial-node-title-${datum.index}`\n\t\t\t\t\t\t)\n\n\t\t\t\t\t\tconst titleContainer = self.parent.select(`g#${elementID}`)\n\t\t\t\t\t\tconst titleMatrix = getTransformOffsets(titleContainer.attr('transform'))\n\n\t\t\t\t\t\ttitleContainer.attr('transform', `translate(${titleMatrix.x + 4},${titleMatrix.y})`)\n\t\t\t\t\t}\n\n\t\t\t\t\tconst elementID = self.services.domUtils.generateElementIDString(\n\t\t\t\t\t\t`alluvial-node-text-${datum.index}`\n\t\t\t\t\t)\n\n\t\t\t\t\tself.parent.select(`text#${elementID}`).style('font-weight', 'bold')\n\n\t\t\t\t\tdebouncedLineHighlight(paths, 'mouseover')\n\n\t\t\t\t\t// Dispatch mouse over event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.NODE_MOUSEOVER, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\t\tdatum\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.NODE_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Dispatch tooltip move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse click event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.NODE_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Set the node position to initial state (unexpanded)\n\t\t\t\tconst nodeMatrix = getTransformOffsets(hoveredElement.attr('transform'))\n\n\t\t\t\thoveredElement\n\t\t\t\t\t.classed('node-hovered', false)\n\t\t\t\t\t.attr('transform', `translate(${nodeMatrix.x + 2}, ${nodeMatrix.y})`)\n\t\t\t\t\t.select('rect.node')\n\t\t\t\t\t.attr('width', alluvialConfigs.nodeWidth)\n\n\t\t\t\t// Translate text container back to initial state\n\t\t\t\tif (datum.x0 - 2 === 0) {\n\t\t\t\t\tconst elementID = self.services.domUtils.generateElementIDString(\n\t\t\t\t\t\t`alluvial-node-title-${datum.index}`\n\t\t\t\t\t)\n\n\t\t\t\t\tconst titleContainer = self.parent.select(`g#${elementID}`)\n\t\t\t\t\tconst titleMatrix = getTransformOffsets(titleContainer.attr('transform'))\n\n\t\t\t\t\ttitleContainer.attr('transform', `translate(${titleMatrix.x - 4},${titleMatrix.y})`)\n\t\t\t\t}\n\n\t\t\t\tconst elementID = self.services.domUtils.generateElementIDString(\n\t\t\t\t\t`alluvial-node-text-${datum.index}`\n\t\t\t\t)\n\n\t\t\t\tself.parent.select(`text#${elementID}`).style('font-weight', 'normal')\n\n\t\t\t\tdebouncedLineHighlight([], 'mouseout')\n\n\t\t\t\t// Dispatch mouse out event\n\t\t\t\tself.services.events.dispatchEvent(Events.Alluvial.NODE_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Dispatch hide tooltip event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\t// Traverse graph and get all connected links to node\n\tprivate traverse(\n\t\tdirection: { link: 'sourceLinks'; node: 'target' } | { link: 'targetLinks'; node: 'source' },\n\t\tnode: any,\n\t\tvisited: any[] = []\n\t) {\n\t\tconst links = node[direction.link].map((element: any) => {\n\t\t\tvisited.push(element.index)\n\t\t\treturn element[direction.node]\n\t\t})\n\n\t\t// Retrieve the child nodes\n\t\tlinks.forEach((element: any) => this.traverse(direction, element, visited))\n\t}\n\n\tgetRightArrowIcon() {\n\t\treturn `\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"arrow-right\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n\t\t\t<polygon points=\"18 6 16.57 7.393 24.15 15 4 15 4 17 24.15 17 16.57 24.573 18 26 28 16 18 6\"/>\n\t\t\t<rect width=\"32\" height=\"32\"/>\n\t\t</svg>`\n\t}\n\n\t// Remove event listeners\n\tdestroy() {\n\t\tthis.parent\n\t\t\t.selectAll('path.line,.node-group')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('click', null)\n\t\t\t.on('mouseout', null)\n\t}\n}\n","import { axisBottom, axisLeft } from 'd3'\nimport { getProperty, getTranslationValues } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { RenderTypes } from '@/interfaces/enums'\n\nexport class Grid extends Component {\n\ttype = 'grid'\n\trenderType = RenderTypes.SVG\n\n\tbackdrop: any\n\n\trender(animate = true) {\n\t\tconst isXGridEnabled = getProperty(this.getOptions(), 'grid', 'x', 'enabled')\n\t\tconst isYGridEnabled = getProperty(this.getOptions(), 'grid', 'y', 'enabled')\n\n\t\t// Draw the backdrop\n\t\tthis.drawBackdrop(isXGridEnabled, isYGridEnabled)\n\n\t\tif (!isXGridEnabled && !isYGridEnabled) {\n\t\t\treturn\n\t\t}\n\n\t\tif (isXGridEnabled) {\n\t\t\tDOMUtils.appendOrSelect(this.backdrop, 'g.x.grid')\n\t\t\tthis.drawXGrid(animate)\n\t\t}\n\n\t\tif (isYGridEnabled) {\n\t\t\tDOMUtils.appendOrSelect(this.backdrop, 'g.y.grid')\n\t\t\tthis.drawYGrid(animate)\n\t\t}\n\t}\n\n\tdrawXGrid(animate: boolean) {\n\t\tconst svg = this.parent\n\n\t\tconst height = this.backdrop.attr('height')\n\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst xGrid = axisBottom(mainXScale as any)\n\t\t\t.tickSizeInner(-height)\n\t\t\t.tickSizeOuter(0)\n\n\t\t// if the main range axis has a custom domain, align the gridlines to the ticks\n\t\tconst alignToTicks = getProperty(this.getOptions(), 'grid', 'x', 'alignWithAxisTicks')\n\n\t\tif (alignToTicks) {\n\t\t\tconst mainXPosition = this.services.cartesianScales.getDomainAxisPosition()\n\t\t\tconst customDomain = getProperty(this.getOptions(), 'axes', mainXPosition, 'ticks', 'values')\n\t\t\t// use custom domain if there is one\n\t\t\t// otherwise d3 defaults to using one gridline per tick\n\t\t\tif (customDomain) {\n\t\t\t\txGrid.tickValues(customDomain)\n\t\t\t}\n\t\t} else {\n\t\t\t// Determine number of ticks\n\t\t\tconst numberOfTicks = getProperty(this.getOptions(), 'grid', 'x', 'numberOfTicks')\n\n\t\t\txGrid.ticks(numberOfTicks)\n\t\t}\n\n\t\tconst g = svg\n\t\t\t.select('.x.grid')\n\t\t\t.attr('transform', `translate(${-this.backdrop.attr('x')}, ${height})`)\n\n\t\tif (animate) {\n\t\t\tg.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'grid-update',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.call(xGrid as any)\n\t\t} else {\n\t\t\tg.call(xGrid as any)\n\t\t}\n\n\t\tthis.cleanGrid(g)\n\t}\n\n\tdrawYGrid(animate: boolean) {\n\t\tconst svg = this.parent\n\t\tconst width = this.backdrop.attr('width')\n\n\t\tconst mainYScale = this.services.cartesianScales.getMainYScale()\n\t\tconst yGrid = axisLeft(mainYScale as any)\n\t\t\t.tickSizeInner(-width)\n\t\t\t.tickSizeOuter(0)\n\n\t\t// if the main range axis has a custom domain, align the gridlines to the ticks\n\t\tconst alignToTicks = getProperty(this.getOptions(), 'grid', 'y', 'alignWithAxisTicks')\n\n\t\tif (alignToTicks) {\n\t\t\tconst mainYPosition = this.services.cartesianScales.getRangeAxisPosition()\n\n\t\t\tconst customDomain = getProperty(this.getOptions(), 'axes', mainYPosition, 'ticks', 'values')\n\n\t\t\t// use custom domain if there is one\n\t\t\t// otherwise d3 defaults to using one gridline per tick\n\t\t\tif (customDomain) {\n\t\t\t\tyGrid.tickValues(customDomain)\n\t\t\t}\n\t\t} else {\n\t\t\t// Determine number of ticks\n\t\t\tconst numberOfTicks = getProperty(this.getOptions(), 'grid', 'y', 'numberOfTicks')\n\n\t\t\tyGrid.ticks(numberOfTicks)\n\t\t}\n\n\t\tconst g = svg.select('.y.grid').attr('transform', `translate(0, ${-this.backdrop.attr('y')})`)\n\n\t\tif (animate) {\n\t\t\tg.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'grid-update',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.call(yGrid as any)\n\t\t} else {\n\t\t\tg.call(yGrid as any)\n\t\t}\n\n\t\tthis.cleanGrid(g)\n\t}\n\n\t/**\n\t * Returns the threshold for the gridline tooltips based on the mouse location.\n\t * Calculated based on the mouse position between the two closest gridlines or edges of chart.\n\t */\n\tgetGridlineThreshold(mousePos: any) {\n\t\t// use the space between axis grid ticks to adjust the threshold for the tooltips\n\t\tconst svg = this.parent\n\n\t\t// sort in ascending x translation value order\n\t\tconst gridlinesX = svg\n\t\t\t.selectAll('.x.grid .tick')\n\t\t\t.nodes()\n\t\t\t.sort((a: HTMLElement, b: HTMLElement) => {\n\t\t\t\treturn Number(getTranslationValues(a).tx) - Number(getTranslationValues(b).tx)\n\t\t\t})\n\n\t\t// find the 2 gridlines on either side of the mouse\n\t\tlet floor = -1\n\t\tif (!gridlinesX.length) {\n\t\t\treturn\n\t\t}\n\n\t\tgridlinesX.forEach((line: HTMLElement) => {\n\t\t\tif (mousePos[0] >= +getTranslationValues(line).tx) {\n\t\t\t\tfloor++\n\t\t\t}\n\t\t})\n\t\tconst ceiling = floor + 1 < gridlinesX.length ? floor + 1 : gridlinesX.length\n\n\t\t// get the 'step' between chart gridlines\n\t\tconst line1 = gridlinesX[floor]\n\t\tconst line2 = gridlinesX[ceiling]\n\t\tlet lineSpacing\n\n\t\t// if the mouse is on edge of charts (mouseX < first gridline || mouseX > last gridline)\n\t\t// we can use the chart edge to determind the threshold for the gridlines\n\t\tif (!line1) {\n\t\t\t// we are between the first gridline and the chart edge\n\t\t\tlineSpacing = +getTranslationValues(line2 as any).tx\n\t\t} else if (!line2) {\n\t\t\t// we need to use the chart right bounds in case there isnt a domain axis\n\t\t\tconst gridElement = svg.select('rect.chart-grid-backdrop').node()\n\t\t\tconst width = DOMUtils.getSVGElementSize(gridElement as any).width\n\n\t\t\tlineSpacing = width - +getTranslationValues(line1 as any).tx\n\t\t} else {\n\t\t\t// there are two gridlines to use\n\t\t\tlineSpacing = +getTranslationValues(line2 as any).tx - +getTranslationValues(line1 as any).tx\n\t\t}\n\t\tconst { threshold } = this.getOptions().tooltip.gridline\n\t\t// return the threshold\n\t\treturn lineSpacing * threshold\n\t}\n\n\t/**\n\t * Returns the active gridlines based on the gridline threshold and mouse position.\n\t * @param position mouse positon\n\t */\n\tgetActiveGridline(position: any) {\n\t\tconst userSpecifiedThreshold = getProperty(this.getOptions, 'tooltip', 'gridline', 'threshold')\n\t\tconst threshold = userSpecifiedThreshold\n\t\t\t? userSpecifiedThreshold\n\t\t\t: this.getGridlineThreshold(position)\n\t\tconst svg = this.parent\n\n\t\tconst xGridlines = svg.selectAll('.x.grid .tick').filter(function () {\n\t\t\tconst translations = getTranslationValues(this as any)\n\n\t\t\t// threshold for when to display a gridline tooltip\n\t\t\tconst bounds = {\n\t\t\t\tmin: Number(translations.tx) - threshold,\n\t\t\t\tmax: Number(translations.tx) + threshold\n\t\t\t}\n\n\t\t\treturn bounds.min <= position[0] && position[0] <= bounds.max\n\t\t})\n\n\t\treturn xGridlines\n\t}\n\n\tdrawBackdrop(isXGridEnabled: boolean, isYGridEnabled: boolean) {\n\t\tconst svg = this.parent\n\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst mainYScale = this.services.cartesianScales.getMainYScale()\n\n\t\tconst [xScaleStart, xScaleEnd] = mainXScale.range()\n\t\tconst [yScaleEnd, yScaleStart] = mainYScale.range()\n\n\t\t// Get height from the grid\n\t\tthis.backdrop = DOMUtils.appendOrSelect(svg, 'svg.chart-grid-backdrop')\n\t\tconst backdropRect = DOMUtils.appendOrSelect(\n\t\t\tthis.backdrop,\n\t\t\tisXGridEnabled || isYGridEnabled\n\t\t\t\t? 'rect.chart-grid-backdrop.stroked'\n\t\t\t\t: 'rect.chart-grid-backdrop'\n\t\t)\n\n\t\tthis.backdrop\n\t\t\t.merge(backdropRect)\n\t\t\t.attr('x', xScaleStart)\n\t\t\t.attr('y', yScaleStart)\n\t\t\t.attr('width', Math.abs(xScaleEnd - xScaleStart))\n\t\t\t.attr('height', Math.abs(yScaleEnd - yScaleStart))\n\t\t\t.lower()\n\n\t\tbackdropRect.attr('width', '100%').attr('height', '100%')\n\t}\n\n\tcleanGrid(g: any) {\n\t\t// Remove extra elements\n\t\tg.selectAll('text').remove()\n\t\tg.select('.domain').remove()\n\t}\n}\n","import { area, select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { area as areaConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { CartesianOrientations, Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { GradientUtils } from '@/services/essentials/gradient-utils'\n\nexport class Area extends Component {\n\ttype = 'area'\n\trenderType = RenderTypes.SVG\n\n\tgradient_id = 'gradient-id-' + Math.floor(Math.random() * 99999999999)\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct area on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight area on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tconst options = this.getOptions()\n\t\tlet domain = [0, 0]\n\n\t\tconst { cartesianScales } = this.services\n\n\t\tconst orientation = cartesianScales.getOrientation()\n\t\tconst areaGenerator = area()\n\t\t\t.curve(this.services.curves.getD3Curve())\n\t\t\t.defined((datum: any) => {\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier()\n\t\t\t\tconst value = datum[rangeIdentifier]\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t})\n\n\t\t// Update the bound data on area groups\n\t\tconst groupedData = this.model.getGroupedData(this.configs.groups)\n\n\t\tconst bounds = getProperty(options, 'bounds')\n\t\tconst boundsEnabled = bounds && groupedData && groupedData.length === 1\n\n\t\tif (!boundsEnabled && bounds) {\n\t\t\tconsole.warn(\n\t\t\t\t`Bounds can only be shown when having 1 single datagroup, you've supplied ${groupedData.length}`\n\t\t\t) // eslint-disable-line no-console\n\t\t}\n\n\t\tlet upperBoundRangeValue = 0\n\t\t// If includeZero is enabled, we want to replace upperBoundRange from 0 to domain value\n\t\tconst includeZeroInRangeValue = (position: any, _domain: any) => {\n\t\t\tif (getProperty(options, 'axes', position, 'includeZero') === false) {\n\t\t\t\t// Replace upperBoundRangeValue if domain is positive\n\t\t\t\tif (_domain[0] > 0 && _domain[1] > 0) {\n\t\t\t\t\tupperBoundRangeValue = _domain[0]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst upperBound = (d: any) =>\n\t\t\tboundsEnabled\n\t\t\t\t? cartesianScales.getBoundedScaledValues(d)[0]\n\t\t\t\t: cartesianScales.getRangeValue(upperBoundRangeValue)\n\n\t\tconst lowerBound = (d: any) =>\n\t\t\tboundsEnabled\n\t\t\t\t? cartesianScales.getBoundedScaledValues(d)[1]\n\t\t\t\t: cartesianScales.getRangeValue(d)\n\n\t\tif (orientation === CartesianOrientations.VERTICAL) {\n\t\t\tdomain = cartesianScales.getMainYScale().domain() as number[]\n\t\t\tincludeZeroInRangeValue(cartesianScales.getMainYAxisPosition(), domain)\n\n\t\t\tareaGenerator\n\t\t\t\t.x((d: any) => cartesianScales.getDomainValue(d))\n\t\t\t\t.y0((d: any) => upperBound(d))\n\t\t\t\t.y1((d: any) => lowerBound(d))\n\t\t} else {\n\t\t\tdomain = cartesianScales.getMainXScale().domain() as number[]\n\t\t\tincludeZeroInRangeValue(cartesianScales.getMainXAxisPosition(), domain)\n\n\t\t\tareaGenerator\n\t\t\t\t.x0((d: any) => upperBound(d))\n\t\t\t\t.x1((d: any) => lowerBound(d))\n\t\t\t\t.y((d: any) => cartesianScales.getDomainValue(d))\n\t\t}\n\n\t\t// Is gradient enabled or not\n\t\tconst isGradientEnabled = getProperty(options, 'color', 'gradient', 'enabled')\n\n\t\t// Should gradient style be applicable\n\t\tconst isGradientAllowed = groupedData && groupedData.length === 1 && isGradientEnabled\n\n\t\tif (groupedData.length > 1 && isGradientEnabled) {\n\t\t\tconsole.error('Gradients can only be enabled when having 1 single dataset')\n\t\t}\n\n\t\tconst areas = svg.selectAll('path.area').data(groupedData, (group: any) => group.name)\n\n\t\tconst chartMainContainer = select(this.services.domUtils.getMainContainer())\n\n\t\t// Remove elements that need to be exited\n\t\t// We need exit at the top here to make sure that\n\t\t// Data filters are processed before entering new elements\n\t\t// Or updating existing ones\n\t\tareas.exit().attr('opacity', 0).remove()\n\n\t\t// if there is no grouped data (if all data groups are turned OFF with legend which can happen in the case of combo charts)\n\t\tif (!groupedData.length) {\n\t\t\treturn\n\t\t}\n\n\t\tif (isGradientAllowed) {\n\t\t\t// The fill value of area has been overwritten, get color value from stroke color class instead\n\t\t\tconst strokePathElement = chartMainContainer\n\t\t\t\t.select(\n\t\t\t\t\t`path.${this.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\t\tdataGroupName: groupedData[0].name\n\t\t\t\t\t})}`\n\t\t\t\t)\n\t\t\t\t.node()\n\n\t\t\tlet colorValue\n\t\t\tif (strokePathElement) {\n\t\t\t\tcolorValue = getComputedStyle(strokePathElement as HTMLElement, null).getPropertyValue(\n\t\t\t\t\t'stroke'\n\t\t\t\t)\n\t\t\t} else {\n\t\t\t\tconst sparklineColorObject = getProperty(this.model.getOptions(), 'color', 'scale')\n\n\t\t\t\tif (sparklineColorObject !== null) {\n\t\t\t\t\tconst sparklineColorObjectKeys = Object.keys(sparklineColorObject)\n\t\t\t\t\tcolorValue = sparklineColorObject[sparklineColorObjectKeys[0]]\n\t\t\t\t}\n\t\t\t}\n\t\t\tGradientUtils.appendOrUpdateLinearGradient({\n\t\t\t\tsvg: this.parent,\n\t\t\t\tid: this.services.domUtils.generateElementIDString(\n\t\t\t\t\t`${groupedData[0].name.replace(' ', '')}_${this.gradient_id}`\n\t\t\t\t),\n\t\t\t\tx1: '0%',\n\t\t\t\tx2: '0%',\n\t\t\t\ty1: '0%',\n\t\t\t\ty2: '100%',\n\t\t\t\tstops: GradientUtils.getStops(domain, colorValue)\n\t\t\t})\n\t\t} else {\n\t\t\t// make sure there is no linearGradient if no gradient is allowed\n\t\t\tif (!this.parent.selectAll('defs linearGradient').empty()) {\n\t\t\t\tthis.parent.selectAll('defs linearGradient').each(function () {\n\t\t\t\t\t;(this as any).parentNode.remove()\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tconst self = this\n\n\t\t// Enter paths that need to be introduced\n\t\tconst enteringAreas = areas.enter().append('path')\n\t\tif (isGradientAllowed) {\n\t\t\tenteringAreas\n\t\t\t\t.merge(areas as any)\n\t\t\t\t.style(\n\t\t\t\t\t'fill',\n\t\t\t\t\t(group: any) =>\n\t\t\t\t\t\t`url(#${this.services.domUtils.generateElementIDString(\n\t\t\t\t\t\t\t`${group.name.replace(' ', '')}_${this.gradient_id}`\n\t\t\t\t\t\t)})`\n\t\t\t\t)\n\t\t\t\t.attr('class', 'area')\n\t\t\t\t.attr('class', (group: any) =>\n\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\t\tdataGroupName: group.name,\n\t\t\t\t\t\toriginalClassName: 'area'\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('d', (group: any) => {\n\t\t\t\t\tconst { data } = group\n\t\t\t\t\treturn areaGenerator(data)\n\t\t\t\t})\n\t\t} else {\n\t\t\tenteringAreas\n\t\t\t\t.attr('opacity', 0)\n\t\t\t\t.merge(areas as any)\n\t\t\t\t.attr('class', 'area')\n\t\t\t\t.attr('class', (group: any) =>\n\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\t\tdataGroupName: group.name,\n\t\t\t\t\t\toriginalClassName: 'area'\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.style('fill', (group: any) => self.model.getFillColor(group.name, null, group.data))\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'area-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('opacity', boundsEnabled ? 1 : areaConfigs.opacity.selected)\n\t\t\t\t.attr('d', (group: any) => {\n\t\t\t\t\tconst { data } = group\n\t\t\t\t\treturn areaGenerator(data)\n\t\t\t\t})\n\n\t\t\tif (boundsEnabled) {\n\t\t\t\tenteringAreas\n\t\t\t\t\t.attr('fill-opacity', areaConfigs.opacity.selected)\n\t\t\t\t\t.style('stroke', (group: any) => self.model.getStrokeColor(group.name, null, group.data))\n\t\t\t\t\t.style('stroke-dasharray', '2, 2')\n\t\t\t\t\t.attr('stroke-width', 0.7 + 'px')\n\t\t\t}\n\t\t}\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tthis.parent\n\t\t\t.selectAll('path.area')\n\t\t\t.transition('legend-hover-area')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-area'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (group: any) => {\n\t\t\t\tif (group.name !== hoveredElement.datum()['name']) {\n\t\t\t\t\treturn areaConfigs.opacity.unselected\n\t\t\t\t}\n\n\t\t\t\treturn areaConfigs.opacity.selected\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.area')\n\t\t\t.transition('legend-mouseout-area')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-area'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', areaConfigs.opacity.selected)\n\t}\n\n\tdestroy() {\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","import { line } from 'd3'\nimport { some } from 'lodash-es'\nimport { flipDomainAndRangeBasedOnOrientation, getProperty } from '@/tools'\nimport { lines as lineConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class Line extends Component {\n\ttype = 'line'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst { events } = this.services\n\t\t// Highlight correct line legend item hovers\n\t\tevents.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\t// Un-highlight lines on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tconst { cartesianScales, curves } = this.services\n\n\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d)\n\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d)\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\tgetDomainValue,\n\t\t\tgetRangeValue,\n\t\t\tcartesianScales.getOrientation()\n\t\t)\n\t\tconst options = this.getOptions()\n\n\t\t// D3 line generator function\n\t\tconst lineGenerator = line()\n\t\t\t.x(getXValue)\n\t\t\t.y(getYValue)\n\t\t\t.curve(curves.getD3Curve())\n\t\t\t.defined((datum: any) => {\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier(datum)\n\t\t\t\tconst value = datum[rangeIdentifier]\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t})\n\n\t\tlet data = []\n\t\tif (this.configs.stacked) {\n\t\t\tconst percentage = Object.keys(options.axes).some(axis => options.axes[axis].percentage)\n\t\t\tconst { groupMapsTo } = options.data\n\t\t\tconst stackedData = this.model.getStackedData({\n\t\t\t\tgroups: this.configs.groups,\n\t\t\t\tpercentage\n\t\t\t})\n\n\t\t\tdata = stackedData.map((d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(d)\n\t\t\t\treturn {\n\t\t\t\t\tname: getProperty(d, 0, groupMapsTo),\n\t\t\t\t\tdata: d.map((datum: any) => ({\n\t\t\t\t\t\t[domainIdentifier]: datum.data.sharedStackKey,\n\t\t\t\t\t\t[groupMapsTo]: datum[groupMapsTo],\n\t\t\t\t\t\t[rangeIdentifier]: datum[1]\n\t\t\t\t\t})),\n\t\t\t\t\thidden: !some(d, (datum: any) => datum[0] !== datum[1])\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tdata = this.model.getGroupedData(this.configs.groups)\n\t\t}\n\n\t\t// Update the bound data on lines\n\t\tconst lines = svg.selectAll('path.line').data(data, (group: any) => group.name)\n\n\t\t// Remove elements that need to be exited\n\t\t// We need exit at the top here to make sure that\n\t\t// Data filters are processed before entering new elements\n\t\t// Or updating existing ones\n\t\tlines.exit().attr('opacity', 0).remove()\n\n\t\t// Add lines that need to be introduced\n\t\tconst enteringLines = lines.enter().append('path').classed('line', true).attr('opacity', 0)\n\n\t\t// Apply styles and datum\n\t\tenteringLines\n\t\t\t.merge(lines as any)\n\t\t\t.data(data, (group: any) => group.name)\n\t\t\t.attr('class', (group: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\tdataGroupName: group.name,\n\t\t\t\t\toriginalClassName: 'line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('stroke', (group: any) => this.model.getStrokeColor(group.name, null, group.data))\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'line')\n\t\t\t.attr('aria-label', (group: any) => {\n\t\t\t\tconst { data: groupData } = group\n\t\t\t\treturn groupData\n\t\t\t\t\t.map((datum: any) => {\n\t\t\t\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(datum)\n\t\t\t\t\t\treturn datum[rangeIdentifier]\n\t\t\t\t\t})\n\t\t\t\t\t.join(',')\n\t\t\t})\n\t\t\t// Transition\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'line-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d.hidden ? 0 : 1))\n\t\t\t.attr('d', (group: any) => {\n\t\t\t\tconst { data: groupData } = group\n\t\t\t\treturn lineGenerator(groupData)\n\t\t\t})\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tthis.parent\n\t\t\t.selectAll('path.line')\n\t\t\t.transition('legend-hover-line')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (group: any) => {\n\t\t\t\tif (group.name !== hoveredElement.datum()['name']) {\n\t\t\t\t\treturn lineConfigs.opacity.unselected\n\t\t\t\t}\n\n\t\t\t\treturn lineConfigs.opacity.selected\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.line')\n\t\t\t.transition('legend-mouseout-line')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', lineConfigs.opacity.selected)\n\t}\n\n\tdestroy() {\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","import { Selection, pointer } from 'd3'\nimport { isEqual } from 'lodash-es'\nimport { debounceWithD3MousePosition, getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { CartesianOrientations, Events, RenderTypes } from '@/interfaces/enums'\n\nexport type GenericSvgSelection = Selection<SVGGraphicsElement, any, Element, any>\n\nconst THRESHOLD = 5\n\n/** check if x is inside threshold area extents  */\nfunction pointIsWithinThreshold(dx: number, x: number) {\n\treturn dx > x - THRESHOLD && dx < x + THRESHOLD\n}\n\nexport class Ruler extends Component {\n\ttype = 'ruler'\n\trenderType = RenderTypes.SVG\n\n\tbackdrop: GenericSvgSelection\n\telementsToHighlight: GenericSvgSelection\n\tpointsWithinLine: {\n\t\tdomainValue: number\n\t\toriginalData: any\n\t}[]\n\tisXGridEnabled = getProperty(this.getOptions(), 'grid', 'x', 'enabled')\n\tisYGridEnabled = getProperty(this.getOptions(), 'grid', 'y', 'enabled')\n\t// flag for checking whether ruler event listener is added or not\n\tisEventListenerAdded = false\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst isRulerEnabled = getProperty(this.getOptions(), 'ruler', 'enabled')\n\n\t\tthis.drawBackdrop()\n\n\t\tif (isRulerEnabled && !this.isEventListenerAdded) {\n\t\t\tthis.addBackdropEventListeners()\n\t\t} else if (!isRulerEnabled && this.isEventListenerAdded) {\n\t\t\tthis.removeBackdropEventListeners()\n\t\t}\n\t}\n\n\tremoveBackdropEventListeners() {\n\t\tthis.isEventListenerAdded = false\n\t\tthis.backdrop.on('mousemove mouseover mouseout', null)\n\t}\n\n\tformatTooltipData(tooltipData: any) {\n\t\treturn tooltipData\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tshowRuler(event: CustomEvent, [x, y]: [number, number]) {\n\t\tconst svg = this.parent\n\n\t\tconst orientation: CartesianOrientations = this.services.cartesianScales.getOrientation()\n\n\t\tconst displayData = this.model.getDisplayData()\n\n\t\tconst rangeScale = this.services.cartesianScales.getRangeScale()\n\t\tconst [yScaleEnd, yScaleStart] = rangeScale.range()\n\n\t\tconst mouseCoordinate = orientation === CartesianOrientations.HORIZONTAL ? y : x\n\t\tconst ruler = DOMUtils.appendOrSelect(svg, 'g.ruler').attr('aria-label', 'ruler')\n\t\tconst rulerLine = DOMUtils.appendOrSelect(ruler, 'line.ruler-line')\n\t\tconst dataPointElements: GenericSvgSelection = svg.selectAll('[role=graphics-symbol]')\n\n\t\tconst pointsWithinLine = displayData\n\t\t\t.map((d: any) => ({\n\t\t\t\tdomainValue: this.services.cartesianScales.getDomainValue(d) as number,\n\t\t\t\toriginalData: d\n\t\t\t}))\n\t\t\t.filter((d: any) => pointIsWithinThreshold(d.domainValue, mouseCoordinate))\n\n\t\tif (\n\t\t\tthis.pointsWithinLine &&\n\t\t\tpointsWithinLine.length === this.pointsWithinLine.length &&\n\t\t\tpointsWithinLine.map((point: any) => point.domainValue).join() ===\n\t\t\t\tthis.pointsWithinLine.map(point => point.domainValue).join()\n\t\t) {\n\t\t\tthis.pointsWithinLine = pointsWithinLine\n\t\t\treturn this.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\tmousePosition: [x, y]\n\t\t\t})\n\t\t}\n\n\t\tthis.pointsWithinLine = pointsWithinLine\n\n\t\t/**\n\t\t * Find matches, reduce is used instead of filter\n\t\t * to only get elements which belong to the same axis coordinate\n\t\t */\n\t\tconst dataPointsMatchingRulerLine: {\n\t\t\tdomainValue: number\n\t\t\toriginalData: any\n\t\t}[] = this.pointsWithinLine.reduce((accum, currentValue) => {\n\t\t\tif (accum.length === 0) {\n\t\t\t\taccum.push(currentValue)\n\t\t\t\treturn accum\n\t\t\t}\n\n\t\t\t// store the first element of the accumulator array to compare it with current element being processed\n\t\t\tconst sampleAccumValue = accum[0].domainValue\n\n\t\t\tconst distanceToCurrentValue = Math.abs(mouseCoordinate - currentValue.domainValue)\n\t\t\tconst distanceToAccumValue = Math.abs(mouseCoordinate - sampleAccumValue)\n\n\t\t\tif (distanceToCurrentValue > distanceToAccumValue) {\n\t\t\t\t// if distance with current value is bigger than already existing value in the accumulator, skip current iteration\n\t\t\t\treturn accum\n\t\t\t} else if (distanceToCurrentValue < distanceToAccumValue) {\n\t\t\t\t// currentValue data point is closer to mouse inside the threshold area, so reinstantiate array\n\t\t\t\taccum = [currentValue]\n\t\t\t} else {\n\t\t\t\t// currentValue is equal to already stored values, which means there's another match on the same coordinate\n\t\t\t\taccum.push(currentValue)\n\t\t\t}\n\n\t\t\treturn accum\n\t\t}, [])\n\n\t\t// some data point match\n\t\tif (dataPointsMatchingRulerLine.length > 0) {\n\t\t\tconst tooltipData = dataPointsMatchingRulerLine\n\t\t\t\t.map((d: any) => d.originalData)\n\t\t\t\t.filter((d: any) => {\n\t\t\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(d)\n\t\t\t\t\tconst value = d[rangeIdentifier]\n\t\t\t\t\treturn value !== null && value !== undefined\n\t\t\t\t})\n\n\t\t\t// get elements on which we should trigger mouse events\n\t\t\tconst domainValuesMatchingRulerLine = dataPointsMatchingRulerLine.map(\n\t\t\t\t(d: any) => d.domainValue\n\t\t\t)\n\t\t\tconst elementsToHighlight = dataPointElements.filter((d: any) => {\n\t\t\t\tconst domainValue = this.services.cartesianScales.getDomainValue(d) as number\n\t\t\t\treturn domainValuesMatchingRulerLine.includes(domainValue)\n\t\t\t})\n\n\t\t\t/** if we pass from a trigger area to another one\n\t\t\t * mouseout on previous elements won't get dispatched\n\t\t\t * so we need to do it manually\n\t\t\t */\n\t\t\tif (\n\t\t\t\tthis.elementsToHighlight &&\n\t\t\t\tthis.elementsToHighlight.size() > 0 &&\n\t\t\t\t!isEqual(this.elementsToHighlight, elementsToHighlight)\n\t\t\t) {\n\t\t\t\tthis.hideRuler()\n\t\t\t}\n\n\t\t\telementsToHighlight.dispatch('mouseover')\n\n\t\t\t// set current hovered elements\n\t\t\tthis.elementsToHighlight = elementsToHighlight\n\n\t\t\tthis.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\tmousePosition: [x, y],\n\t\t\t\thoveredElement: rulerLine,\n\t\t\t\tdata: this.formatTooltipData(tooltipData)\n\t\t\t})\n\n\t\t\truler.attr('opacity', 1)\n\n\t\t\t// line snaps to matching point\n\t\t\tconst sampleMatch = dataPointsMatchingRulerLine[0]\n\t\t\tif (orientation === 'horizontal') {\n\t\t\t\trulerLine\n\t\t\t\t\t.attr('x1', yScaleStart)\n\t\t\t\t\t.attr('x2', yScaleEnd)\n\t\t\t\t\t.attr('y1', sampleMatch.domainValue)\n\t\t\t\t\t.attr('y2', sampleMatch.domainValue)\n\t\t\t} else {\n\t\t\t\trulerLine\n\t\t\t\t\t.attr('y1', yScaleStart)\n\t\t\t\t\t.attr('y2', yScaleEnd)\n\t\t\t\t\t.attr('x1', sampleMatch.domainValue)\n\t\t\t\t\t.attr('x2', sampleMatch.domainValue)\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hideRuler()\n\t\t}\n\t}\n\n\thideRuler() {\n\t\tconst svg = this.parent\n\t\tconst ruler = DOMUtils.appendOrSelect(svg, 'g.ruler')\n\t\tconst dataPointElements = svg.selectAll('[role=graphics-symbol]')\n\n\t\tdataPointElements.dispatch('mouseout')\n\t\tthis.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\truler.attr('opacity', 0)\n\t}\n\n\t/**\n\t * Adds the listener on the X grid to trigger multiple point tooltips along the x axis.\n\t */\n\taddBackdropEventListeners() {\n\t\tthis.isEventListenerAdded = true\n\n\t\tconst self = this\n\n\t\tconst holder = this.services.domUtils.getHolder()\n\n\t\tconst displayData = this.model.getDisplayData()\n\n\t\tlet mouseMoveCallback = function (event: CustomEvent) {\n\t\t\tconst pos = pointer(event, self.parent.node())\n\n\t\t\tself.showRuler(event, pos)\n\t\t}\n\n\t\t// Debounce mouseMoveCallback if there are more than 100 datapoints\n\t\tif (displayData.length > 100) {\n\t\t\tconst debounceThreshold = (displayData.length % 50) * 12.5\n\n\t\t\tmouseMoveCallback = debounceWithD3MousePosition(\n\t\t\t\tfunction (event: CustomEvent) {\n\t\t\t\t\tconst { mousePosition } = this\n\t\t\t\t\tself.showRuler(event, mousePosition)\n\t\t\t\t},\n\t\t\t\tdebounceThreshold,\n\t\t\t\tholder\n\t\t\t)\n\t\t}\n\n\t\tthis.backdrop\n\t\t\t.on('mousemove mouseover', mouseMoveCallback)\n\t\t\t.on('mouseout', this.hideRuler.bind(this))\n\t}\n\n\tdrawBackdrop() {\n\t\tconst svg = this.parent\n\n\t\t// Get height from the grid\n\t\tthis.backdrop = DOMUtils.appendOrSelect(svg, 'svg.chart-grid-backdrop')\n\t}\n}\n","import { select, Selection } from 'd3'\nimport { flipDomainAndRangeBasedOnOrientation, getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class Scatter extends Component {\n\ttype = 'scatter'\n\trenderType = RenderTypes.SVG\n\n\tscatterData: any\n\n\tinit() {\n\t\tconst { events } = this.services\n\t\tif (!events) throw new Error('Services events are undefined.')\n\n\t\t// Highlight correct circle on legend item hovers\n\t\tevents.addEventListener(\n\t\t\tEvents.Legend.ITEM_HOVER,\n\t\t\tthis.handleLegendOnHover as EventListenerOrEventListenerObject\n\t\t)\n\t\t// Un-highlight circles on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\n\t\tconst { fadeInOnChartHolderMouseover } = this.configs\n\t\tif (fadeInOnChartHolderMouseover) {\n\t\t\t// Fade-in scatter circles\n\t\t\tevents.addEventListener(Events.Chart.MOUSEOVER, this.handleChartHolderOnHover)\n\t\t\t// Fade-out scatter circles\n\t\t\tevents.addEventListener(Events.Chart.MOUSEOUT, this.handleChartHolderOnMouseOut)\n\t\t}\n\t}\n\n\tfilterBasedOnZoomDomain(data: any) {\n\t\tconst { cartesianScales } = this.services\n\t\tif (!cartesianScales) throw new Error('Services cartesianScales are undefined.')\n\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(data)\n\t\tconst zoomDomain = this.model.get('zoomDomain')\n\t\tif (zoomDomain !== undefined) {\n\t\t\treturn data.filter(\n\t\t\t\t(d: any) =>\n\t\t\t\t\td[domainIdentifier].getTime() >= zoomDomain[0].getTime() &&\n\t\t\t\t\td[domainIdentifier].getTime() <= zoomDomain[1].getTime()\n\t\t\t)\n\t\t}\n\t\treturn data\n\t}\n\n\tgetScatterData() {\n\t\tconst options = this.getOptions()\n\n\t\tconst { stacked } = this.configs\n\n\t\tlet scatterData\n\t\tif (stacked) {\n\t\t\tconst percentage = Object.keys(options.axes).some(axis => options.axes[axis].percentage)\n\t\t\tscatterData = this.model.getStackedData({\n\t\t\t\tgroups: this.configs.groups,\n\t\t\t\tpercentage\n\t\t\t})\n\t\t} else {\n\t\t\tconst { cartesianScales } = this.services\n\t\t\tif (!cartesianScales) throw new Error('Services cartesianScales are undefined.')\n\t\t\tscatterData = this.model.getDisplayData(this.configs.groups).filter((d: any) => {\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier(d)\n\t\t\t\treturn d[rangeIdentifier] !== undefined && d[rangeIdentifier] !== null\n\t\t\t})\n\t\t}\n\n\t\t// filter out datapoints that aren't part of the zoomed domain\n\t\treturn this.filterBasedOnZoomDomain(scatterData)\n\t}\n\n\trender(animate: boolean) {\n\t\tconst isScatterEnabled =\n\t\t\tgetProperty(this.getOptions(), 'points', 'enabled') ||\n\t\t\tgetProperty(this.getOptions(), 'bubble', 'enabled')\n\n\t\tif (!isScatterEnabled) {\n\t\t\treturn\n\t\t}\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst { cartesianScales } = this.services\n\t\tif (!cartesianScales) throw new Error('Services cartesianScales are undefined.')\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier()\n\n\t\t// Update data on dot groups\n\t\tconst circles = svg\n\t\t\t.selectAll('circle.dot')\n\t\t\t.data(\n\t\t\t\tthis.getScatterData(),\n\t\t\t\t(datum: any) => `${datum[groupMapsTo]}-${datum[domainIdentifier]}`\n\t\t\t) as Selection<SVGCircleElement, any, HTMLElement, any>\n\n\t\t// Remove circles that need to be removed\n\t\tcircles.exit().attr('opacity', 0).remove()\n\n\t\t// Add the dot groups that need to be introduced\n\t\tconst enteringCircles = circles.enter().append('circle').classed('dot', true).attr('opacity', 0)\n\n\t\t// Apply styling & position\n\t\tconst circlesToStyle = enteringCircles.merge(circles)\n\t\tthis.styleCircles(circlesToStyle, animate)\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\t// A value is an anomaly if is above all defined domain and range thresholds\n\tisDatapointThresholdAnomaly(datum: any) {\n\t\tconst { handleThresholds } = this.configs\n\t\tif (!handleThresholds) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst { cartesianScales } = this.services\n\t\tif (!cartesianScales) throw new Error('Cartesian scales service is undefined')\n\n\t\tconst orientation = cartesianScales.getOrientation()\n\n\t\t// Get highest domain and range thresholds\n\t\tconst [xThreshold, yThreshold] = flipDomainAndRangeBasedOnOrientation(\n\t\t\tcartesianScales.getHighestDomainThreshold(),\n\t\t\tcartesianScales.getHighestRangeThreshold(),\n\t\t\torientation\n\t\t)\n\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\t(d: any) => cartesianScales.getDomainValue(d),\n\t\t\t(d: any) => cartesianScales.getRangeValue(d),\n\t\t\torientation\n\t\t)\n\n\t\t// Get datum x and y values\n\t\tconst xValue = getXValue(datum)\n\t\tconst yValue = getYValue(datum)\n\n\t\t// To be an anomaly, the value has to be higher or equal than the threshold value\n\t\t// (if are present, both range and domain threshold values)\n\t\tif (yThreshold && xThreshold) {\n\t\t\treturn yValue <= yThreshold.scaleValue && xValue >= xThreshold.scaleValue\n\t\t}\n\n\t\tif (yThreshold) {\n\t\t\treturn yValue <= yThreshold.scaleValue\n\t\t}\n\n\t\tif (xThreshold) {\n\t\t\treturn xValue >= xThreshold.scaleValue\n\t\t}\n\n\t\treturn false\n\t}\n\n\tstyleCircles(selection: Selection<SVGCircleElement, any, Element, any>, animate: boolean) {\n\t\t// Chart options mixed with the internal configurations\n\t\tconst options = this.getOptions()\n\t\tconst { filled, fillOpacity } = options.points\n\t\tconst { cartesianScales } = this.services\n\t\tif (!cartesianScales) throw new Error('Cartesian scales service is undefined')\n\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d)\n\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d)\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\tgetDomainValue,\n\t\t\tgetRangeValue,\n\t\t\tcartesianScales.getOrientation()\n\t\t)\n\n\t\tconst { fadeInOnChartHolderMouseover } = this.configs\n\n\t\tselection\n\t\t\t.raise()\n\t\t\t.classed('dot', true)\n\t\t\t.attr('class', (d: any) => {\n\t\t\t\t// one element in ChartTabularData (Record<string, any>)\n\t\t\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(d)\n\t\t\t\tconst isFilled = this.model.getIsFilled(d[groupMapsTo], d[domainIdentifier], d, filled)\n\t\t\t\tconst classNamesNeeded = isFilled\n\t\t\t\t\t? [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE]\n\t\t\t\t\t: [ColorClassNameTypes.STROKE]\n\n\t\t\t\treturn (\n\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: classNamesNeeded,\n\t\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\t\toriginalClassName: 'dot'\n\t\t\t\t\t}) || ''\n\t\t\t\t)\n\t\t\t})\n\t\t\t// Set class to highlight the dots that are above all the thresholds, in both directions (vertical and horizontal)\n\t\t\t.classed('threshold-anomaly', (d: any) => this.isDatapointThresholdAnomaly(d))\n\t\t\t.classed('filled', (d: any) => {\n\t\t\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getIsFilled(d[groupMapsTo], d[domainIdentifier], d, filled)\n\t\t\t})\n\t\t\t.classed('unfilled', (d: any) => {\n\t\t\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn !this.model.getIsFilled(d[groupMapsTo], d[domainIdentifier], d, filled)\n\t\t\t})\n\t\t\t.transition()\n\t\t\t.call(\n\t\t\t\t(t: any) =>\n\t\t\t\t\tthis.services.transitions?.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'scatter-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('cx', getXValue)\n\t\t\t.attr('cy', getYValue)\n\t\t\t.attr('r', options.points.radius)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(d)\n\t\t\t\tif (this.model.getIsFilled(d[groupMapsTo], d[domainIdentifier], d, filled)) {\n\t\t\t\t\treturn this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.style('stroke', (d: any) => {\n\t\t\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getStrokeColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.attr('fill-opacity', filled ? fillOpacity : 1)\n\t\t\t.attr('opacity', fadeInOnChartHolderMouseover ? 0 : 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'point')\n\t\t\t.attr('aria-label', (d: any) => {\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier(d)\n\t\t\t\treturn d[rangeIdentifier]\n\t\t\t})\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\thandleChartHolderOnHover = () => {\n\t\tif (!this.parent) throw new Error('Parent not defined')\n\t\tthis.parent\n\t\t\t.selectAll('circle.dot')\n\t\t\t.transition('chart-holder-hover-scatter')\n\t\t\t.call(\n\t\t\t\t(t: any) =>\n\t\t\t\t\tthis.services.transitions?.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'chart-holder-hover-scatter'\n\t\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\thandleChartHolderOnMouseOut = () => {\n\t\tif (!this.parent) throw new Error('Parent not defined')\n\t\tthis.parent\n\t\t\t.selectAll('circle.dot')\n\t\t\t.transition('chart-holder-mouseout-scatter')\n\t\t\t.call(\n\t\t\t\t(t: any) =>\n\t\t\t\t\tthis.services.transitions?.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'chart-holder-mouseout-scatter'\n\t\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 0)\n\t}\n\n\t// TODO: follow signature of EventListenerOrEventListenerObject\n\thandleLegendOnHover = (evt: CustomEvent) => {\n\t\tconst { hoveredElement } = evt.detail\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tif (!this.parent) throw new Error('Parent not defined')\n\t\tthis.parent\n\t\t\t.selectAll('circle.dot')\n\t\t\t.transition('legend-hover-scatter')\n\t\t\t.call(\n\t\t\t\t(t: any) =>\n\t\t\t\t\tthis.services.transitions?.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'legend-hover-scatter'\n\t\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tif (!this.parent) throw new Error('Parent not defined')\n\n\t\tthis.parent\n\t\t\t.selectAll('circle.dot')\n\t\t\t.transition('legend-mouseout-scatter')\n\t\t\t.call(\n\t\t\t\t(t: any) =>\n\t\t\t\t\tthis.services.transitions?.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'legend-mouseout-scatter'\n\t\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\t// Extended in bubble graphs\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tgetTooltipAdditionalItems(datum: any) {\n\t\treturn null as any\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tconst { groupMapsTo } = self.getOptions().data\n\n\t\tif (!this.parent) throw new Error('Parent not defined')\n\t\tthis.parent\n\t\t\t.selectAll('circle')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\thoveredElement\n\t\t\t\t\t.classed('hovered', true)\n\t\t\t\t\t.attr('class', (d: any) =>\n\t\t\t\t\t\tself.model.getColorClassName({\n\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\t\t\toriginalClassName: hoveredElement.attr('class')\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.style('fill', (d: any) => {\n\t\t\t\t\t\tconst domainIdentifier = self.services.cartesianScales?.getDomainIdentifier(d)\n\t\t\t\t\t\treturn self.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t\t\t})\n\t\t\t\t\t.classed('unfilled', false)\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events?.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\tdata: [datum],\n\t\t\t\t\tadditionalItems: self.getTooltipAdditionalItems(datum)\n\t\t\t\t})\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events?.dispatchEvent(Events.Scatter.SCATTER_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events?.dispatchEvent(Events.Scatter.SCATTER_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events?.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events?.dispatchEvent(Events.Scatter.SCATTER_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\tif (!self.configs.filled) {\n\t\t\t\t\tconst { filled } = self.getOptions().points\n\t\t\t\t\tconst domainIdentifier = self.services.cartesianScales?.getDomainIdentifier(datum)\n\t\t\t\t\tconst isFilled = self.model.getIsFilled(\n\t\t\t\t\t\tdatum[groupMapsTo],\n\t\t\t\t\t\tdatum[domainIdentifier],\n\t\t\t\t\t\tdatum,\n\t\t\t\t\t\tfilled\n\t\t\t\t\t)\n\t\t\t\t\thoveredElement.classed('unfilled', !isFilled).style('fill', (d: any) => {\n\t\t\t\t\t\tif (isFilled || filled) {\n\t\t\t\t\t\t\treturn self.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events?.dispatchEvent(Events.Scatter.SCATTER_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events?.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent?.selectAll('circle').on('mousemove', null).on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst { events } = this.services\n\t\tif (!events) throw new Error('Services events undefined')\n\t\tevents.removeEventListener(\n\t\t\tEvents.Legend.ITEM_HOVER,\n\t\t\tthis.handleLegendOnHover as EventListenerOrEventListenerObject\n\t\t)\n\t\tevents.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t\tevents.removeEventListener(Events.Chart.MOUSEOVER, this.handleChartHolderOnHover)\n\t\tevents.removeEventListener(Events.Chart.MOUSEOUT, this.handleChartHolderOnMouseOut)\n\t}\n}\n","import {\n\taxisBottom,\n\taxisLeft,\n\taxisRight,\n\taxisTop,\n\ttype AxisScale,\n\tselect,\n\ttype Selection as D3Selection\n} from 'd3'\nimport { clamp } from 'lodash-es'\nimport { axis as axisConfigs } from '@/configuration'\nimport { getProperty, getTranslationValues, truncateLabel } from '@/tools'\nimport { Component } from '@/components/component'\nimport {\n\tAxisPositions,\n\tEvents,\n\tScaleTypes,\n\tTruncationTypes,\n\tAxisTitleOrientations,\n\tRenderTypes,\n\tTickRotations\n} from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport type { ChartModel } from '@/model/model'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { computeTimeIntervalName, formatTick, isTickPrimary } from '@/services/time-series'\nimport { sanitizeText } from '@/utils/sanitizeHtml'\n\nexport class Axis extends Component {\n\ttype = 'axes'\n\trenderType = RenderTypes.SVG\n\n\tmargins: any\n\ttruncation = {\n\t\t[AxisPositions.LEFT]: false,\n\t\t[AxisPositions.RIGHT]: false,\n\t\t[AxisPositions.TOP]: false,\n\t\t[AxisPositions.BOTTOM]: false\n\t}\n\n\tscale: AxisScale<any>\n\tscaleType: ScaleTypes\n\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\n\t\tif (configs) {\n\t\t\tthis.configs = configs\n\t\t}\n\n\t\tthis.margins = this.configs.margins\n\t}\n\n\trender(animate = true) {\n\t\tconst { position: axisPosition }: { position: AxisPositions } = this.configs\n\t\tconst options = this.getOptions()\n\t\tconst isAxisVisible = getProperty(options, 'axes', axisPosition, 'visible')\n\n\t\tconst svg = this.getComponentContainer() as D3Selection<\n\t\t\tSVGGraphicsElement,\n\t\t\tany,\n\t\t\tHTMLElement,\n\t\t\tany\n\t\t>\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// Add axis into the parent\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\t\tlet startPosition: number, endPosition: number\n\t\tif (axisPosition === AxisPositions.BOTTOM || axisPosition === AxisPositions.TOP) {\n\t\t\tstartPosition = this.configs.axes[AxisPositions.LEFT] ? this.margins.left : 0\n\t\t\tendPosition = this.configs.axes[AxisPositions.RIGHT] ? width - this.margins.right : width\n\t\t} else {\n\t\t\tstartPosition = height - this.margins.bottom\n\t\t\tendPosition = this.margins.top\n\t\t}\n\n\t\t// Grab the scale off of the Scales service\n\t\tif (!this.services.cartesianScales) throw new Error('Services cartesianScales undefined')\n\t\tconst scale = this.services.cartesianScales.getScaleByPosition(axisPosition) as any\n\n\t\tif (this.scaleType === ScaleTypes.LABELS || this.scaleType === ScaleTypes.LABELS_RATIO) {\n\t\t\tscale.rangeRound([startPosition, endPosition])\n\t\t} else {\n\t\t\tscale.range([startPosition, endPosition])\n\t\t}\n\n\t\t// Identify the corresponding d3 axis function\n\t\tlet axisFunction: any\n\t\tswitch (axisPosition) {\n\t\t\tcase AxisPositions.LEFT:\n\t\t\t\taxisFunction = axisLeft\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.BOTTOM:\n\t\t\t\taxisFunction = axisBottom\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.RIGHT:\n\t\t\t\taxisFunction = axisRight\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.TOP:\n\t\t\t\taxisFunction = axisTop\n\t\t\t\tbreak\n\t\t}\n\n\t\tcontainer.attr('aria-label', `${axisPosition} axis`)\n\t\tconst axisRefExists = !container.select(`g.ticks`).empty()\n\t\tlet axisRef = DOMUtils.appendOrSelect(container, `g.ticks`)\n\t\tif (!axisRefExists) {\n\t\t\taxisRef.attr('role', `${Roles.GRAPHICS_OBJECT} ${Roles.GROUP}`)\n\t\t\taxisRef.attr('aria-label', `${axisPosition} ticks`)\n\t\t}\n\n\t\t// We draw the invisible axis because of the async nature of d3 transitions\n\t\t// To be able to tell the final width & height of the axis when initiaing the transition\n\t\t// The invisible axis is updated instantly and without a transition\n\t\tconst invisibleAxisRef = DOMUtils.appendOrSelect(container, `g.ticks.invisible`)\n\t\t\t.style('opacity', '0')\n\t\t\t.style('pointer-events', 'none')\n\t\t\t.attr('aria-hidden', true)\n\t\t\t.attr('aria-label', `invisible ${axisPosition} ticks`)\n\n\t\tconst axisOptions = getProperty(options, 'axes', axisPosition)\n\t\tconst isTimeScaleType =\n\t\t\tthis.scaleType === ScaleTypes.TIME || axisOptions.scaleType === ScaleTypes.TIME\n\t\tconst isVerticalAxis =\n\t\t\taxisPosition === AxisPositions.LEFT || axisPosition === AxisPositions.RIGHT\n\n\t\t// if zoomDomain is available, scale type is time, and axis position isBOTTOM or TOP\n\t\t// update scale domain to zoomDomain.\n\t\tconst zoomDomain = this.model.get('zoomDomain')\n\t\tif (zoomDomain && isTimeScaleType && !isVerticalAxis) {\n\t\t\tscale.domain(zoomDomain)\n\t\t}\n\n\t\tif (!isAxisVisible) {\n\t\t\taxisRef.attr('aria-hidden', true)\n\t\t\treturn\n\t\t}\n\n\t\tconst axisScaleType = getProperty(axisOptions, 'scaleType')\n\t\tconst isDataLoading = getProperty(options, 'data', 'loading')\n\t\tconst numberOfTicksProvided = getProperty(axisOptions, 'ticks', 'number')\n\n\t\t// user can provide custom ticks to be displayed\n\t\t// ticks need to be in the domain of the axis data\n\t\tconst userProvidedTickValues = getProperty(axisOptions, 'ticks', 'values')\n\n\t\t// get user provided custom values for truncation\n\t\tconst truncationType = getProperty(axisOptions, 'truncation', 'type')\n\t\tconst truncationThreshold = getProperty(axisOptions, 'truncation', 'threshold')\n\t\tconst truncationNumCharacter = getProperty(axisOptions, 'truncation', 'numCharacter')\n\n\t\tconst isNumberOfTicksProvided = numberOfTicksProvided !== null\n\t\tconst timeScaleOptions = getProperty(options, 'timeScale')\n\n\t\t// Append to DOM a fake tick to get the right computed font height\n\t\tconst fakeTick = DOMUtils.appendOrSelect(invisibleAxisRef, `g.tick`)\n\t\tconst fakeTickText = DOMUtils.appendOrSelect(fakeTick, `text`).text('0')\n\t\tconst tickHeight = DOMUtils.getSVGElementSize(fakeTickText.node(), {\n\t\t\tuseBBox: true\n\t\t}).height\n\t\tfakeTick.remove()\n\n\t\tconst scaleType = this.scaleType || axisOptions.scaleType || ScaleTypes.LINEAR\n\n\t\t// Initialize axis object\n\t\tconst axis = axisFunction(scale).tickSizeOuter(0)\n\n\t\tif (scale.ticks) {\n\t\t\tlet numberOfTicks: number\n\n\t\t\tif (isNumberOfTicksProvided) {\n\t\t\t\tnumberOfTicks = numberOfTicksProvided\n\t\t\t} else {\n\t\t\t\tnumberOfTicks = axisConfigs.ticks.number\n\t\t\t\tif (isVerticalAxis) {\n\t\t\t\t\t// Set how many ticks based on height\n\t\t\t\t\tnumberOfTicks = this.getNumberOfFittingTicks(\n\t\t\t\t\t\theight,\n\t\t\t\t\t\ttickHeight,\n\t\t\t\t\t\taxisConfigs.ticks.verticalSpaceRatio\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// scale continuous\n\t\t\t// remove 0 ticks for skeleton\n\t\t\tif (scale.ticks().length === 1 && scale.ticks()[0] === 0) {\n\t\t\t\tnumberOfTicks = 0\n\t\t\t}\n\n\t\t\taxis.ticks(numberOfTicks)\n\n\t\t\tif (isTimeScaleType) {\n\t\t\t\tif (!scale.ticks(numberOfTicks).length) {\n\t\t\t\t\taxis.tickValues([])\n\t\t\t\t} else {\n\t\t\t\t\tconst addSpaceOnEdges = getProperty(options, 'timeScale', 'addSpaceOnEdges')\n\n\t\t\t\t\tconst customDomain = getProperty(options, 'axes', axisPosition, 'domain')\n\n\t\t\t\t\t// scale.nice() will change scale domain which causes extra space near chart edge\n\t\t\t\t\t// so use another scale instance to avoid impacts to original scale\n\t\t\t\t\tconst tempScale = scale.copy()\n\t\t\t\t\tif (addSpaceOnEdges && !customDomain) {\n\t\t\t\t\t\ttempScale.nice(numberOfTicks)\n\t\t\t\t\t}\n\t\t\t\t\tconst tickValues = tempScale.ticks(numberOfTicks)\n\n\t\t\t\t\t// Remove labels on the edges\n\t\t\t\t\t// If there are more than 2 labels to show\n\t\t\t\t\tif (addSpaceOnEdges && tickValues.length > 2 && !customDomain) {\n\t\t\t\t\t\ttickValues.splice(tickValues.length - 1, 1)\n\t\t\t\t\t\ttickValues.splice(0, 1)\n\t\t\t\t\t}\n\n\t\t\t\t\taxis.tickValues(tickValues)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// create the right ticks formatter\n\t\tlet formatter: any\n\t\tconst userProvidedFormatter = getProperty(axisOptions, 'ticks', 'formatter')\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\tif (isTimeScaleType) {\n\t\t\tconst timeInterval = computeTimeIntervalName(\n\t\t\t\taxis.tickValues(),\n\t\t\t\tgetProperty(options, 'timeScale', 'timeInterval')\n\t\t\t)\n\n\t\t\tif (userProvidedFormatter === null) {\n\t\t\t\tformatter = (t: number, i: number) =>\n\t\t\t\t\tformatTick(t, i, axis.tickValues(), timeInterval, timeScaleOptions, options.locale)\n\t\t\t} else {\n\t\t\t\tformatter = (t: number, i: number) => {\n\t\t\t\t\tconst defaultFormattedValue = formatTick(\n\t\t\t\t\t\tt,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\taxis.tickValues(),\n\t\t\t\t\t\ttimeInterval,\n\t\t\t\t\t\ttimeScaleOptions,\n\t\t\t\t\t\toptions.locale\n\t\t\t\t\t)\n\t\t\t\t\treturn userProvidedFormatter(t, i, defaultFormattedValue)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (userProvidedFormatter === null) {\n\t\t\t\tif (scaleType === ScaleTypes.LINEAR) {\n\t\t\t\t\tformatter = (t: any) => numberFormatter(t, localeCode)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tformatter = userProvidedFormatter\n\t\t\t}\n\t\t}\n\n\t\t// Set ticks formatter\n\t\taxis.tickFormat(formatter)\n\n\t\t// prioritize using a custom array of values rather than number of ticks\n\t\t// if both are provided. custom tick values need to be within the domain of the scale\n\t\tconst [lowerBound, upperBound] = this.services.cartesianScales\n\t\t\t.getScaleByPosition(axisPosition)\n\t\t\t.domain()\n\t\tlet validTicks: any\n\t\tif (userProvidedTickValues) {\n\t\t\tif (isTimeScaleType) {\n\t\t\t\t// sanitize user-provided tick values\n\t\t\t\tuserProvidedTickValues.forEach((userProvidedTickValue: any, i: number) => {\n\t\t\t\t\tif (userProvidedTickValue.getTime === undefined) {\n\t\t\t\t\t\tuserProvidedTickValues[i] = new Date(userProvidedTickValue)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// check the supplied ticks are within the time domain\n\t\t\t\tvalidTicks = userProvidedTickValues.filter((tick: any) => {\n\t\t\t\t\tconst tickTimestamp = tick.getTime()\n\t\t\t\t\treturn (\n\t\t\t\t\t\ttickTimestamp >= new Date(lowerBound).getTime() &&\n\t\t\t\t\t\ttickTimestamp <= new Date(upperBound).getTime()\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t} else if (axisScaleType === ScaleTypes.LABELS) {\n\t\t\t\tconst discreteDomain = this.services.cartesianScales\n\t\t\t\t\t.getScaleByPosition(axisPosition)\n\t\t\t\t\t.domain()\n\t\t\t\tvalidTicks = userProvidedTickValues.filter((tick: any) => discreteDomain.includes(tick))\n\t\t\t} else {\n\t\t\t\t// continuous scales\n\t\t\t\tvalidTicks = userProvidedTickValues.filter(\n\t\t\t\t\t(tick: any) => tick >= lowerBound && tick <= upperBound\n\t\t\t\t)\n\t\t\t}\n\n\t\t\taxis.tickValues(validTicks)\n\t\t}\n\n\t\t// Position and transition the axis\n\t\tswitch (axisPosition) {\n\t\t\tcase AxisPositions.LEFT:\n\t\t\t\taxisRef.attr('transform', `translate(${this.margins.left}, 0)`)\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.BOTTOM:\n\t\t\t\taxisRef.attr('transform', `translate(0, ${height - this.margins.bottom})`)\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.RIGHT:\n\t\t\t\taxisRef.attr('transform', `translate(${width - this.margins.right}, 0)`)\n\t\t\t\tbreak\n\t\t\tcase AxisPositions.TOP:\n\t\t\t\taxisRef.attr('transform', `translate(0, ${this.margins.top})`)\n\t\t\t\tbreak\n\t\t}\n\n\t\t// Position the axis title\n\t\t// check that data exists, if they don't, doesn't show the title axis\n\t\tconst isDataEmpty = this.model.isDataEmpty()\n\t\tif (axisOptions.title) {\n\t\t\tconst axisTitleRef = DOMUtils.appendOrSelect(container, `text.axis-title`).html(\n\t\t\t\tisDataEmpty || isDataLoading ? '' : sanitizeText(axisOptions.title)\n\t\t\t)\n\n\t\t\t// vertical axes can have override for title orientation\n\t\t\tconst titleOrientation = getProperty(axisOptions, 'titleOrientation')\n\t\t\tlet titleHeight // avoid lexical declaration in case block\n\t\t\tswitch (axisPosition) {\n\t\t\t\tcase AxisPositions.LEFT:\n\t\t\t\t\tif (titleOrientation === AxisTitleOrientations.RIGHT) {\n\t\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t\t.attr('transform', 'rotate(90)')\n\t\t\t\t\t\t\t.attr('y', 0)\n\t\t\t\t\t\t\t.attr('x', scale.range()[0] / 2)\n\t\t\t\t\t\t\t.attr('dy', '-0.5em')\n\t\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t} else {\n\t\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t\t.attr('transform', 'rotate(-90)')\n\t\t\t\t\t\t\t.attr('y', 0)\n\t\t\t\t\t\t\t.attr('x', -(scale.range()[0] / 2))\n\t\t\t\t\t\t\t.attr('dy', '0.75em')\n\t\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.BOTTOM:\n\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'transform',\n\t\t\t\t\t\t\t`translate(${this.margins.left / 2 + scale.range()[1] / 2}, ${height + 4})`\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.RIGHT:\n\t\t\t\t\tif (titleOrientation === AxisTitleOrientations.LEFT) {\n\t\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t\t.attr('transform', 'rotate(-90)')\n\t\t\t\t\t\t\t.attr('y', width)\n\t\t\t\t\t\t\t.attr('x', -(scale.range()[0] / 2))\n\t\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t} else {\n\t\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t\t.attr('transform', 'rotate(90)')\n\t\t\t\t\t\t\t.attr('y', -width)\n\t\t\t\t\t\t\t.attr('x', scale.range()[0] / 2)\n\t\t\t\t\t\t\t.attr('dy', '0.75em')\n\t\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.TOP:\n\t\t\t\t\ttitleHeight = DOMUtils.getSVGElementSize(axisTitleRef, {\n\t\t\t\t\t\tuseBBox: true\n\t\t\t\t\t}).height\n\n\t\t\t\t\taxisTitleRef\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'transform',\n\t\t\t\t\t\t\t`translate(${this.margins.left / 2 + scale.range()[1] / 2}, ${titleHeight / 2})`\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.style('text-anchor', 'middle')\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// Apply new axis to the axis element\n\t\tif (isTimeScaleType) {\n\t\t\tconst timeInterval = computeTimeIntervalName(\n\t\t\t\taxis.tickValues(),\n\t\t\t\tgetProperty(options, 'timeScale', 'timeInterval')\n\t\t\t)\n\n\t\t\tconst showDayName = timeScaleOptions.showDayName\n\t\t\tconst axisRefSelection = axisRef\n\n\t\t\tif (animate) {\n\t\t\t\taxisRef = axisRef.transition().call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'axis-update',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t) as any\n\t\t\t}\n\t\t\taxisRef = axisRef.call(axis)\n\n\t\t\t// Manipulate tick labels to make bold those that are in long format\n\t\t\tconst ticks = axisRefSelection\n\t\t\t\t.selectAll('.tick')\n\t\t\t\t.data(axis.tickValues(), scale)\n\t\t\t\t.order()\n\t\t\t\t.select('text')\n\t\t\tticks.style('font-weight', (tick: number, i: number) => {\n\t\t\t\treturn isTickPrimary(tick, i, axis.tickValues(), timeInterval, showDayName)\n\t\t\t\t\t? 'bold'\n\t\t\t\t\t: 'normal'\n\t\t\t})\n\t\t} else {\n\t\t\tif (!animate || !axisRefExists) {\n\t\t\t\taxisRef = axisRef.call(axis)\n\t\t\t} else {\n\t\t\t\taxisRef = axisRef\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'axis-update',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.call(axis) as any\n\t\t\t}\n\t\t}\n\n\t\tinvisibleAxisRef.call(axis)\n\n\t\tif (axisPosition === AxisPositions.BOTTOM || axisPosition === AxisPositions.TOP) {\n\t\t\tlet shouldRotateTicks = false\n\t\t\t// user could decide if tick rotation is required during zoom domain changing\n\t\t\tconst tickRotation = getProperty(axisOptions, 'ticks', 'rotation')\n\n\t\t\tif (tickRotation === TickRotations.ALWAYS) {\n\t\t\t\tshouldRotateTicks = true\n\t\t\t} else if (tickRotation === TickRotations.NEVER) {\n\t\t\t\tshouldRotateTicks = false\n\t\t\t} else if (!tickRotation || tickRotation === TickRotations.AUTO) {\n\t\t\t\t// if the option is not set or set to AUTO\n\n\t\t\t\t// depending on if tick rotation is necessary by calculating space\n\t\t\t\t// If we're dealing with a discrete scale type\n\t\t\t\t// We're able to grab the spacing between the ticks\n\t\t\t\tif (scale.step) {\n\t\t\t\t\tconst textNodes = invisibleAxisRef.selectAll('g.tick text').nodes() as any\n\n\t\t\t\t\t// If any ticks are any larger than the scale step size\n\t\t\t\t\tshouldRotateTicks = textNodes.some(\n\t\t\t\t\t\t(textNode: D3Selection<SVGGraphicsElement, any, Element, any>) =>\n\t\t\t\t\t\t\tDOMUtils.getSVGElementSize(textNode, {\n\t\t\t\t\t\t\t\tuseBBox: true\n\t\t\t\t\t\t\t}).width >= scale.step()\n\t\t\t\t\t)\n\t\t\t\t} else {\n\t\t\t\t\tshouldRotateTicks = false\n\n\t\t\t\t\tconst mockTextPiece = invisibleAxisRef.append('text').text('A')\n\n\t\t\t\t\tconst averageLetterWidth = DOMUtils.getSVGElementSize(mockTextPiece.node() as any, {\n\t\t\t\t\t\tuseBBox: true\n\t\t\t\t\t}).width as number\n\n\t\t\t\t\tlet lastStartPosition: any\n\n\t\t\t\t\t// Find out whether any text nodes roughly collide\n\t\t\t\t\tinvisibleAxisRef.selectAll('g.tick').each(function () {\n\t\t\t\t\t\tconst selection = select(this)\n\t\t\t\t\t\tconst xTransformation = parseFloat(getProperty(getTranslationValues(this as any), 'tx'))\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\txTransformation !== null &&\n\t\t\t\t\t\t\tlastStartPosition + selection.text().length * averageLetterWidth * 0.8 >=\n\t\t\t\t\t\t\t\txTransformation\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tshouldRotateTicks = true\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlastStartPosition = xTransformation\n\t\t\t\t\t})\n\n\t\t\t\t\t// Cleanup mock text piece\n\t\t\t\t\tmockTextPiece.remove()\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (shouldRotateTicks) {\n\t\t\t\tif (!isNumberOfTicksProvided) {\n\t\t\t\t\taxis.ticks(\n\t\t\t\t\t\tthis.getNumberOfFittingTicks(width, tickHeight, axisConfigs.ticks.horizontalSpaceRatio)\n\t\t\t\t\t)\n\n\t\t\t\t\tinvisibleAxisRef.call(axis)\n\t\t\t\t\taxisRef.call(axis)\n\t\t\t\t}\n\n\t\t\t\tcontainer\n\t\t\t\t\t.selectAll('g.ticks g.tick text')\n\t\t\t\t\t.attr('transform', `rotate(-45)`)\n\t\t\t\t\t.attr('text-anchor', axisPosition === AxisPositions.TOP ? 'start' : 'end')\n\t\t\t} else {\n\t\t\t\tcontainer.selectAll('g.ticks g.tick text').attr('transform', null).attr('text-anchor', null)\n\t\t\t}\n\t\t}\n\n\t\t// we don't need to show axes on empty state and on skeleton state\n\t\t// because the Skeleton component draws them\n\t\tif (isDataLoading) {\n\t\t\tcontainer.attr('opacity', 0)\n\t\t} else {\n\t\t\tcontainer.attr('opacity', 1)\n\t\t}\n\n\t\taxisRef.selectAll('g.tick').attr('aria-label', (d: any) => d)\n\n\t\tinvisibleAxisRef.selectAll('g.tick').attr('aria-label', (d: any) => d)\n\n\t\t// truncate the label if it's too long\n\t\t// only applies to discrete type\n\t\tif (\n\t\t\ttruncationType !== TruncationTypes.NONE &&\n\t\t\taxisScaleType === ScaleTypes.LABELS &&\n\t\t\t!userProvidedTickValues\n\t\t) {\n\t\t\tconst axisTickLabels = this.services.cartesianScales.getScaleDomain(axisPosition)\n\t\t\tif (axisTickLabels.length > 0) {\n\t\t\t\tconst tick_html = svg.select(`g.axis.${axisPosition} g.ticks g.tick`).html()\n\n\t\t\t\tcontainer.selectAll('g.ticks g.tick').html(tick_html)\n\n\t\t\t\tconst self = this\n\t\t\t\tcontainer\n\t\t\t\t\t.selectAll('g.tick text')\n\t\t\t\t\t.data(axisTickLabels)\n\t\t\t\t\t.text(function (d: any) {\n\t\t\t\t\t\tif (d.length > truncationThreshold) {\n\t\t\t\t\t\t\tself.truncation[axisPosition] = true\n\t\t\t\t\t\t\treturn truncateLabel(d, truncationType, truncationNumCharacter)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn d\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\tthis.getInvisibleAxisRef()\n\t\t\t\t\t.selectAll('g.tick text')\n\t\t\t\t\t.data(axisTickLabels)\n\t\t\t\t\t.text(function (d: any) {\n\t\t\t\t\t\tif (d.length > truncationThreshold) {\n\t\t\t\t\t\t\treturn truncateLabel(d, truncationType, truncationNumCharacter)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn d\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\tcontainer.selectAll('g.ticks').html(this.getInvisibleAxisRef().html())\n\n\t\t\t\tcontainer.selectAll('g.tick text').data(axisTickLabels)\n\t\t\t}\n\t\t}\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\taddEventListeners() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { position: axisPosition } = this.configs\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\t\tconst options = this.getOptions()\n\t\tconst axisOptions = getProperty(options, 'axes', axisPosition)\n\t\tconst axisScaleType = getProperty(axisOptions, 'scaleType')\n\t\tconst truncationThreshold = getProperty(axisOptions, 'truncation', 'threshold')\n\n\t\tconst self = this\n\t\tcontainer\n\t\t\t.selectAll('g.tick text')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (axisScaleType === ScaleTypes.LABELS && datum.length > truncationThreshold) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement: select(this),\n\t\t\t\t\t\tcontent: datum\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t\tif (axisScaleType === ScaleTypes.LABELS && datum.length > truncationThreshold) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (axisScaleType === ScaleTypes.LABELS) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tgetInvisibleAxisRef() {\n\t\tconst { position: axisPosition } = this.configs\n\n\t\treturn this.getComponentContainer().select(`g.axis.${axisPosition} g.ticks.invisible`)\n\t}\n\n\tgetTitleRef() {\n\t\tconst { position: axisPosition } = this.configs\n\n\t\treturn this.getComponentContainer().select(`g.axis.${axisPosition} text.axis-title`)\n\t}\n\n\tgetNumberOfFittingTicks(size: number, tickSize: number, spaceRatio: number) {\n\t\tconst numberOfTicksFit = Math.floor(size / (tickSize * spaceRatio))\n\t\treturn clamp(numberOfTicksFit, 2, axisConfigs.ticks.number)\n\t}\n\n\tdestroy() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { position: axisPosition } = this.configs\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\n\t\t// Remove event listeners\n\t\tcontainer\n\t\t\t.selectAll('g.tick text')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\t}\n}\n","import { select, type Selection } from 'd3'\nimport { getProperty } from '@/tools'\nimport { axis as axisConfigs } from '@/configuration'\nimport { Axis } from './axis'\nimport { AxisPositions, Events, ScaleTypes } from '@/interfaces/enums'\nimport type { ChartModel } from '@/model/model'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\n\nexport class HoverAxis extends Axis {\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\t}\n\n\trender(animate = true) {\n\t\tsuper.render(animate)\n\n\t\t// Remove existing event listeners to avoid flashing behavior\n\t\tsuper.destroy()\n\n\t\tconst axisPosition = this.configs.position as 'left' | 'right' | 'top' | 'bottom'\n\t\tconst svg = this.getComponentContainer()\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\n\t\tconst self = this\n\t\tcontainer.selectAll('g.tick').each(function (_: any, index: number) {\n\t\t\tconst g = select(this) as Selection<SVGElement, any, Element, any>\n\t\t\tg.classed('tick-hover', true).attr('tabindex', index === 0 ? 0 : -1)\n\t\t\tconst textNode = g.select<SVGGraphicsElement>('text')\n\t\t\tconst { width, height } = DOMUtils.getSVGElementSize(textNode, {\n\t\t\t\tuseBBox: true\n\t\t\t})\n\n\t\t\tconst rectangle = DOMUtils.appendOrSelect(g, 'rect.axis-holder')\n\n\t\t\tlet x = 0,\n\t\t\t\ty = 0\n\n\t\t\t// Depending on axis position, apply correct translation & rotation to align the rect\n\t\t\t// with the text\n\t\t\tswitch (axisPosition) {\n\t\t\t\tcase AxisPositions.LEFT:\n\t\t\t\t\tx = -width + Number(textNode.attr('x'))\n\t\t\t\t\ty = -(height / 2)\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.RIGHT:\n\t\t\t\t\tx = Math.abs(Number(textNode.attr('x')))\n\t\t\t\t\ty = -(height / 2)\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.TOP:\n\t\t\t\t\tx = -(width / 2)\n\t\t\t\t\ty = -height + Number(textNode.attr('y')) / 2\n\n\t\t\t\t\tif (self.truncation[axisPosition]) {\n\t\t\t\t\t\tx = 0\n\t\t\t\t\t\trectangle.attr('transform', `rotate(-45)`)\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.BOTTOM:\n\t\t\t\t\tx = -(width / 2)\n\t\t\t\t\ty = height / 2 - 2\n\n\t\t\t\t\tif (self.truncation[axisPosition]) {\n\t\t\t\t\t\tx = -width\n\t\t\t\t\t\trectangle.attr('transform', `rotate(-45)`)\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t}\n\n\t\t\t// Translates x position -4 left to keep center after padding\n\t\t\t// Adds padding on left & right\n\t\t\trectangle\n\t\t\t\t.attr('x', x - axisConfigs.hover.rectanglePadding)\n\t\t\t\t.attr('y', y)\n\t\t\t\t.attr('width', width + axisConfigs.hover.rectanglePadding * 2)\n\t\t\t\t.attr('height', height)\n\t\t\t\t.lower()\n\t\t})\n\n\t\t// Add event listeners to element group\n\t\tthis.addEventListeners()\n\t}\n\n\taddEventListeners() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { position: axisPosition } = this.configs\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\t\tconst options = this.getOptions()\n\t\tconst axisOptions = getProperty(options, 'axes', axisPosition)\n\t\tconst axisScaleType = getProperty(axisOptions, 'scaleType')\n\t\tconst truncationThreshold = getProperty(axisOptions, 'truncation', 'threshold')\n\n\t\tconst self = this\n\t\tcontainer\n\t\t\t.selectAll('g.tick.tick-hover')\n\t\t\t.on('mouseover', function (event: MouseEvent) {\n\t\t\t\tconst hoveredElement = select(this).select('text')\n\t\t\t\tconst datum = hoveredElement.datum() as string\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (axisScaleType === ScaleTypes.LABELS && datum.length > truncationThreshold) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\t\tdatum\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent) {\n\t\t\t\tconst hoveredElement = select(this).select('text')\n\t\t\t\tconst datum = hoveredElement.datum() as string\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this).select('text'),\n\t\t\t\t\tdatum: select(this).select('text').datum()\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this).select('text'),\n\t\t\t\t\tdatum: select(this).select('text').datum()\n\t\t\t\t})\n\n\t\t\t\tif (axisScaleType === ScaleTypes.LABELS) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('focus', function (event: any) {\n\t\t\t\tconst coordinates = { clientX: 0, clientY: 0 }\n\n\t\t\t\tif (event.target) {\n\t\t\t\t\t// Focus element since we are using arrow keys\n\t\t\t\t\tevent.target.focus()\n\t\t\t\t\tconst boundingRect = event.target.getBoundingClientRect()\n\t\t\t\t\tcoordinates.clientX = boundingRect.x\n\t\t\t\t\tcoordinates.clientY = boundingRect.y\n\t\t\t\t}\n\n\t\t\t\t// Dispatch focus event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_FOCUS, {\n\t\t\t\t\tevent: { ...event, ...coordinates },\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: select(this).select('text').datum()\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('blur', function (event: FocusEvent) {\n\t\t\t\t// Dispatch blur event\n\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_BLUR, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: select(this).select('text').datum()\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('keydown', function (event: KeyboardEvent) {\n\t\t\t\t// Hide the tooltip when `Escape` is pressed, but keep focus\n\t\t\t\tif (event.key && event.key === 'Escape') {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Axis.LABEL_BLUR, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: select(this),\n\t\t\t\t\t\tdatum: select(this).select('text').datum()\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// Choose specific arrow key depending on the axis\n\t\t\t\tif (axisPosition === AxisPositions.LEFT || axisPosition === AxisPositions.RIGHT) {\n\t\t\t\t\tif (event.key && event.key === 'ArrowUp') {\n\t\t\t\t\t\tself.goNext(this as HTMLElement, event)\n\t\t\t\t\t} else if (event.key && event.key === 'ArrowDown') {\n\t\t\t\t\t\tself.goPrevious(this as HTMLElement, event)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (event.key && event.key === 'ArrowLeft') {\n\t\t\t\t\t\tself.goPrevious(this as HTMLElement, event)\n\t\t\t\t\t} else if (event.key && event.key === 'ArrowRight') {\n\t\t\t\t\t\tself.goNext(this as HTMLElement, event)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\t// Focus on the next HTML element sibling\n\tprivate goNext(element: HTMLElement, event: KeyboardEvent) {\n\t\tif (element.nextElementSibling && element.nextElementSibling.tagName !== 'path') {\n\t\t\telement.nextElementSibling.dispatchEvent(new Event('focus'))\n\t\t}\n\n\t\tevent.preventDefault()\n\t}\n\n\t// Focus on the previous HTML element sibling\n\tprivate goPrevious(element: HTMLElement, event: KeyboardEvent) {\n\t\tif (element.previousElementSibling && element.previousElementSibling.tagName !== 'path') {\n\t\t\telement.previousElementSibling.dispatchEvent(new Event('focus'))\n\t\t}\n\n\t\tevent.preventDefault()\n\t}\n\n\tdestroy() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { position: axisPosition } = this.configs\n\t\tconst container = DOMUtils.appendOrSelect(svg, `g.axis.${axisPosition}`)\n\n\t\t// Remove event listeners\n\t\tcontainer\n\t\t\t.selectAll('g.tick.tick-hover')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\t\t\t.on('focus', null)\n\t\t\t.on('blur', null)\n\t}\n}\n","import { getProperty } from '@/tools'\nimport { Axis } from './axis'\nimport { HoverAxis } from './hover-axis'\nimport { Component } from '@/components/component'\nimport type { Threshold } from '@/components/essentials/threshold'\nimport { AxisPositions, Events, RenderTypes, AxisFlavor } from '@/interfaces/enums'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport type { ChartModelCartesian } from '@/model/cartesian-charts'\n\nexport class TwoDimensionalAxes extends Component {\n\ttype = '2D-axes'\n\trenderType = RenderTypes.SVG\n\n\tchildren: any = {}\n\n\tthresholds: Threshold[] = []\n\n\tmargins = {\n\t\ttop: 0,\n\t\tright: 0,\n\t\tbottom: 0,\n\t\tleft: 0\n\t}\n\n\trender(animate = false) {\n\t\tconst axes: any = {}\n\t\tconst axisPositions = Object.keys(AxisPositions)\n\t\tconst axesOptions = getProperty(this.getOptions(), 'axes')\n\n\t\taxisPositions.forEach((axisPosition: keyof typeof AxisPositions) => {\n\t\t\tconst axisOptions = axesOptions[AxisPositions[axisPosition]]\n\t\t\tif (axisOptions) {\n\t\t\t\taxes[AxisPositions[axisPosition]] = true\n\t\t\t}\n\t\t})\n\n\t\tthis.configs.axes = axes\n\n\t\t// Check the configs to know which axes need to be rendered\n\t\taxisPositions.forEach((axisPositionKey: keyof typeof AxisPositions) => {\n\t\t\tconst axisPosition = AxisPositions[axisPositionKey]\n\t\t\tif (this.configs.axes[axisPosition] && !this.children[axisPosition]) {\n\t\t\t\tconst configs = {\n\t\t\t\t\tposition: axisPosition,\n\t\t\t\t\taxes: this.configs.axes,\n\t\t\t\t\tmargins: this.margins\n\t\t\t\t}\n\n\t\t\t\tconst axisComponent =\n\t\t\t\t\t(this.model as ChartModelCartesian).axisFlavor === AxisFlavor.DEFAULT\n\t\t\t\t\t\t? new Axis(this.model, this.services, configs)\n\t\t\t\t\t\t: new HoverAxis(this.model, this.services, configs)\n\n\t\t\t\t// Set model, services & parent for the new axis component\n\t\t\t\taxisComponent.setModel(this.model)\n\t\t\t\taxisComponent.setServices(this.services)\n\t\t\t\taxisComponent.setParent(this.parent)\n\n\t\t\t\tthis.children[axisPosition] = axisComponent\n\t\t\t}\n\t\t})\n\n\t\tObject.keys(this.children).forEach((childKey: any) => {\n\t\t\tconst child = this.children[childKey]\n\t\t\tchild.render(animate)\n\t\t})\n\n\t\tconst margins = {} as any\n\n\t\tObject.keys(this.children).forEach((childKey: any) => {\n\t\t\tconst child = this.children[childKey]\n\t\t\tconst axisPosition = child.configs.position\n\n\t\t\t// Grab the invisibly rendered axis' width & height, and set margins\n\t\t\t// Based off of that\n\t\t\t// We draw the invisible axis because of the async nature of d3 transitions\n\t\t\t// To be able to tell the final width & height of the axis when initiaing the transition\n\t\t\t// The invisible axis is updated instantly and without a transition\n\t\t\tconst invisibleAxisRef = child.getInvisibleAxisRef()\n\t\t\tconst { width, height } = DOMUtils.getSVGElementSize(invisibleAxisRef, { useBBox: true })\n\n\t\t\tlet offset: any\n\t\t\tif (child.getTitleRef().empty()) {\n\t\t\t\toffset = 0\n\t\t\t} else {\n\t\t\t\toffset = DOMUtils.getSVGElementSize(child.getTitleRef(), {\n\t\t\t\t\tuseBBox: true\n\t\t\t\t}).height\n\n\t\t\t\tif (axisPosition === AxisPositions.LEFT || axisPosition === AxisPositions.RIGHT) {\n\t\t\t\t\toffset += 5\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch (axisPosition) {\n\t\t\t\tcase AxisPositions.TOP:\n\t\t\t\t\tmargins.top = height + offset\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.BOTTOM:\n\t\t\t\t\tmargins.bottom = height + offset\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.LEFT:\n\t\t\t\t\tmargins.left = width + offset\n\t\t\t\t\tbreak\n\t\t\t\tcase AxisPositions.RIGHT:\n\t\t\t\t\tmargins.right = width + offset\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t})\n\n\t\tthis.services.events.dispatchEvent(Events.Axis.RENDER_COMPLETE)\n\n\t\t// If the new margins are different than the existing ones\n\t\tconst isNotEqual = Object.keys(margins).some(\n\t\t\t(marginKey: 'top' | 'right' | 'bottom' | 'left') => {\n\t\t\t\treturn this.margins[marginKey] !== margins[marginKey]\n\t\t\t}\n\t\t)\n\n\t\tif (isNotEqual) {\n\t\t\tthis.margins = Object.assign(this.margins, margins)\n\n\t\t\t// also set new margins to model to allow external components to access\n\t\t\tthis.model.set({ axesMargins: this.margins }, { skipUpdate: true })\n\t\t\tthis.services.events.dispatchEvent(Events.ZoomBar.UPDATE)\n\n\t\t\tObject.keys(this.children).forEach((childKey: any) => {\n\t\t\t\tconst child = this.children[childKey]\n\t\t\t\tchild.margins = this.margins\n\t\t\t})\n\n\t\t\tthis.render(true)\n\t\t}\n\t}\n}\n","import { arc, easeLinear, scaleLinear, type ScaleLinear, type Selection } from 'd3'\nimport { getProperty } from '@/tools'\nimport { pie as pieConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Skeletons, CartesianOrientations, Alignments } from '@/interfaces/enums'\n\nexport class Skeleton extends Component {\n\ttype = 'skeleton'\n\txScale: ScaleLinear<number, number>\n\tyScale: ScaleLinear<number, number>\n\tbackdrop: Selection<SVGElement | HTMLDivElement, unknown, Element, any>\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst isDataLoading = getProperty(this.getOptions(), 'data', 'loading')\n\n\t\t// display a skeleton if there is no chart data or the loading flag is set to true\n\t\tif (isDataLoading) {\n\t\t\tthis.renderSkeleton(isDataLoading)\n\t\t} else {\n\t\t\tthis.removeSkeleton()\n\t\t}\n\t}\n\n\trenderSkeleton(showShimmerEffect: boolean) {\n\t\tif (this.configs.skeleton === Skeletons.GRID) {\n\t\t\tthis.renderGridSkeleton(showShimmerEffect)\n\t\t} else if (this.configs.skeleton === Skeletons.VERT_OR_HORIZ) {\n\t\t\tthis.renderVertOrHorizSkeleton(showShimmerEffect)\n\t\t} else if (this.configs.skeleton === Skeletons.PIE) {\n\t\t\tthis.renderPieSkeleton(showShimmerEffect)\n\t\t} else if (this.configs.skeleton === Skeletons.DONUT) {\n\t\t\tthis.renderDonutSkeleton(showShimmerEffect)\n\t\t} else {\n\t\t\tthrow new Error(`\"${this.configs.skeleton}\" is not a valid Skeleton type.`)\n\t\t}\n\t}\n\n\trenderGridSkeleton(showShimmerEffect: boolean) {\n\t\tthis.setScales()\n\t\tthis.drawBackdrop(showShimmerEffect)\n\t\tthis.drawXGrid(showShimmerEffect)\n\t\tthis.drawYGrid(showShimmerEffect)\n\t\tif (showShimmerEffect) {\n\t\t\tthis.setShimmerEffect('shimmer-lines')\n\t\t}\n\t}\n\n\trenderVertOrHorizSkeleton(showShimmerEffect: boolean) {\n\t\tconst orientation = this.services.cartesianScales.getOrientation()\n\t\tthis.setScales()\n\t\tthis.drawBackdrop(showShimmerEffect)\n\t\tif (orientation === CartesianOrientations.VERTICAL) {\n\t\t\tthis.drawYGrid(showShimmerEffect)\n\t\t}\n\t\tif (orientation === CartesianOrientations.HORIZONTAL) {\n\t\t\tthis.drawXGrid(showShimmerEffect)\n\t\t}\n\n\t\tthis.setShimmerEffect('shimmer-lines')\n\t}\n\n\trenderPieSkeleton(showShimmerEffect: boolean) {\n\t\tconst outerRadius = this.computeOuterRadius()\n\t\tconst innerRadius = 0\n\t\tthis.drawRing(outerRadius, innerRadius, showShimmerEffect)\n\t\tif (showShimmerEffect) {\n\t\t\tthis.setShimmerEffect('shimmer-areas')\n\t\t}\n\t}\n\n\trenderDonutSkeleton(showShimmerEffect: boolean) {\n\t\tconst outerRadius = this.computeOuterRadius()\n\t\tconst innerRadius = this.computeInnerRadius()\n\t\tthis.drawRing(outerRadius, innerRadius, showShimmerEffect)\n\t\tif (showShimmerEffect) {\n\t\t\tthis.setShimmerEffect('shimmer-areas')\n\t\t}\n\t}\n\n\tsetScales() {\n\t\tconst xRange = this.services.cartesianScales.getMainXScale().range()\n\t\tconst yRange = this.services.cartesianScales.getMainYScale().range()\n\t\tthis.xScale = scaleLinear().domain([0, 1]).range(xRange)\n\t\tthis.yScale = scaleLinear().domain([0, 1]).range(yRange)\n\t}\n\n\tdrawBackdrop(showShimmerEffect: boolean) {\n\t\tconst svg = this.parent\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tthis.backdrop = DOMUtils.appendOrSelect(svg, 'svg.chart-skeleton.DAII')\n\t\t\t.attr('width', width)\n\t\t\t.attr('height', height)\n\n\t\tconst backdropRect = DOMUtils.appendOrSelect(this.backdrop, 'rect.chart-skeleton-backdrop')\n\t\tbackdropRect.attr('width', '100%').attr('height', '100%')\n\n\t\tconst [xScaleStart] = this.xScale.range()\n\t\tconst [, yScaleStart] = this.yScale.range()\n\n\t\tthis.backdrop.merge(backdropRect).attr('x', xScaleStart).attr('y', yScaleStart)\n\n\t\tbackdropRect\n\t\t\t.classed('shimmer-effect-lines', showShimmerEffect)\n\t\t\t.classed('empty-state-lines', !showShimmerEffect)\n\t\t\t.style(\n\t\t\t\t'stroke',\n\t\t\t\tshowShimmerEffect\n\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t: null\n\t\t\t)\n\t}\n\n\tdrawXGrid(showShimmerEffect: boolean) {\n\t\tconst width = +this.backdrop.attr('width')\n\t\tconst ticksNumber = getProperty(this.getOptions(), 'grid', 'x', 'numberOfTicks')\n\t\tconst ticksValues = this.xScale.ticks(ticksNumber).map((d: any) => d * width)\n\n\t\tconst xGridG = DOMUtils.appendOrSelect(this.backdrop, 'g.x.skeleton')\n\t\tconst update = xGridG.selectAll('line').data(ticksValues)\n\t\tupdate\n\t\t\t.enter()\n\t\t\t.append('line')\n\t\t\t.merge(update as any)\n\t\t\t.attr('x1', (d: any) => d)\n\t\t\t.attr('x2', (d: any) => d)\n\t\t\t.attr('y1', 0)\n\t\t\t.attr('y2', '100%')\n\n\t\txGridG\n\t\t\t.selectAll('line')\n\t\t\t.classed('shimmer-effect-lines', showShimmerEffect)\n\t\t\t.classed('empty-state-lines', !showShimmerEffect)\n\t\t\t.style(\n\t\t\t\t'stroke',\n\t\t\t\tshowShimmerEffect\n\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t: null\n\t\t\t)\n\t}\n\n\tdrawYGrid(showShimmerEffect: boolean) {\n\t\tconst height = +this.backdrop.attr('height')\n\t\tconst width = this.backdrop.attr('width')\n\t\tconst ticksNumber = getProperty(this.getOptions(), 'grid', 'y', 'numberOfTicks')\n\t\tconst ticksValues = this.xScale.ticks(ticksNumber).map((d: any) => d * height)\n\n\t\tconst yGridG = DOMUtils.appendOrSelect(this.backdrop, 'g.y.skeleton')\n\t\tconst update = yGridG.selectAll('line').data(ticksValues)\n\t\tupdate\n\t\t\t.enter()\n\t\t\t.append('line')\n\t\t\t.merge(update as any)\n\t\t\t.attr('x1', 0)\n\t\t\t.attr('x2', width)\n\t\t\t.attr('y1', (d: any) => d)\n\t\t\t.attr('y2', (d: any) => d)\n\n\t\tyGridG\n\t\t\t.selectAll('line')\n\t\t\t.classed('shimmer-effect-lines', showShimmerEffect)\n\t\t\t.classed('empty-state-lines', !showShimmerEffect)\n\t\t\t.style(\n\t\t\t\t'stroke',\n\t\t\t\tshowShimmerEffect\n\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t: null\n\t\t\t)\n\t}\n\n\tdrawRing(outerRadius: number, innerRadius: number, shimmer = true) {\n\t\tconst svg = this.parent\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst container = DOMUtils.appendOrSelect(svg, 'svg.chart-skeleton')\n\t\t\t.attr('width', width)\n\t\t\t.attr('height', height)\n\n\t\tconst optionName = innerRadius === 0 ? 'pie' : 'donut'\n\n\t\tconst alignment = getProperty(this.getOptions(), optionName, 'alignment')\n\n\t\tDOMUtils.appendOrSelect(container, 'rect.chart-skeleton-area-container')\n\t\t\t.attr('width', width)\n\t\t\t.attr('height', height)\n\t\t\t.attr('fill', 'none')\n\n\t\tconst arcPathGenerator = arc()\n\t\t\t.innerRadius(innerRadius)\n\t\t\t.outerRadius(outerRadius)\n\t\t\t.startAngle(0)\n\t\t\t.endAngle(Math.PI * 2)\n\n\t\t// centering circle inside the container\n\t\tconst tcx = outerRadius + Math.abs(pieConfigs.radiusOffset)\n\t\tconst tcy = outerRadius + (Math.min(width, height) - outerRadius * 2) / 2\n\n\t\tconst skeletonAreaShape = DOMUtils.appendOrSelect(container, 'path')\n\t\t\t.attr('class', 'skeleton-area-shape')\n\t\t\t.attr('transform', `translate(${tcx}, ${tcy})`)\n\t\t\t.attr('d', arcPathGenerator)\n\t\t\t.classed('shimmer-effect-areas', shimmer)\n\t\t\t.classed('empty-state-areas', !shimmer)\n\t\t\t.style(\n\t\t\t\t'fill',\n\t\t\t\tshimmer ? `url(#${this.services.domUtils.generateElementIDString(`shimmer-areas`)})` : null\n\t\t\t)\n\n\t\t// Position skeleton\n\t\tlet translateX = outerRadius + pieConfigs.xOffset\n\t\tif (alignment === Alignments.CENTER) {\n\t\t\ttranslateX = width / 2\n\t\t} else if (alignment === Alignments.RIGHT) {\n\t\t\ttranslateX = width - outerRadius - pieConfigs.xOffset\n\t\t}\n\n\t\tconst translateY = outerRadius + pieConfigs.yOffset\n\t\tskeletonAreaShape.attr('transform', `translate(${translateX}, ${translateY})`)\n\t}\n\n\t// same logic in pie\n\tcomputeOuterRadius() {\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\t\tconst radius = Math.min(width, height) / 2\n\t\treturn radius + pieConfigs.radiusOffset\n\t}\n\n\t// same logic in donut\n\tcomputeInnerRadius() {\n\t\treturn this.computeOuterRadius() * (3 / 4)\n\t}\n\n\tsetShimmerEffect(gradientId: string) {\n\t\tconst animationDuration = 2000 // ms\n\t\tconst delay = 1000 // ms\n\t\tconst shimmerWidth = 0.2\n\t\tconst stopBgShimmerClass = 'stop-bg-shimmer'\n\t\tconst stopShimmerClass = 'stop-shimmer'\n\t\tconst container = this.parent.select('.chart-skeleton')\n\t\tconst { width } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\t\tconst startPoint = 0\n\t\tconst endPoint = width\n\n\t\t// append the defs as first child of container\n\t\tconst defs = DOMUtils.appendOrSelect(container as any, 'defs').lower()\n\t\tconst linearGradient = DOMUtils.appendOrSelect(defs, 'linearGradient')\n\t\t\t.attr('id', this.services.domUtils.generateElementIDString(gradientId))\n\t\t\t.attr('class', gradientId)\n\t\t\t.attr('x1', startPoint - 3 * shimmerWidth * width)\n\t\t\t.attr('x2', endPoint)\n\t\t\t.attr('y1', 0)\n\t\t\t.attr('y2', 0)\n\t\t\t.attr('gradientUnits', 'userSpaceOnUse')\n\t\t\t.attr('gradientTransform', `translate(0, 0)`)\n\t\tconst stops = `\n\t\t\t<stop class=\"${stopBgShimmerClass}\" offset=\"${startPoint}\"></stop>\n\t\t\t<stop class=\"${stopShimmerClass}\" offset=\"${startPoint + shimmerWidth}\"></stop>\n\t\t\t<stop class=\"${stopBgShimmerClass}\" offset=\"${startPoint + 2 * shimmerWidth}\"></stop>\n\t\t`\n\t\tlinearGradient.html(stops)\n\n\t\trepeat()\n\t\tfunction repeat() {\n\t\t\tlinearGradient\n\t\t\t\t.attr('gradientTransform', `translate(${startPoint - 3 * shimmerWidth * width}, 0)`)\n\t\t\t\t.transition()\n\t\t\t\t.duration(animationDuration)\n\t\t\t\t.delay(delay)\n\t\t\t\t.ease(easeLinear)\n\t\t\t\t.attr('gradientTransform', `translate(${endPoint + 3 * shimmerWidth * width}, 0)`)\n\t\t\t\t.on('end', repeat)\n\t\t}\n\t}\n\n\tremoveSkeleton() {\n\t\tconst container = this.parent.select('.chart-skeleton')\n\t\tcontainer.remove()\n\t}\n}\n","import { select } from 'd3'\nimport { flipDomainAndRangeBasedOnOrientation, generateSVGPathString, getProperty } from '@/tools'\nimport { boxplot as boxplotConfigs } from '@/configuration'\nimport { BoxplotChartModel } from '@/model/boxplot'\nimport { Component } from '@/components/component'\nimport { CartesianOrientations, ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class Boxplot extends Component {\n\ttype = 'boxplot'\n\trenderType = RenderTypes.SVG\n\n\trender(animate: boolean) {\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst dataGroupNames = this.model.getDataGroupNames()\n\n\t\t/*\n\t\t * Get graphable dimensions\n\t\t */\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst mainYScale = this.services.cartesianScales.getMainYScale()\n\t\tconst [xScaleStart, xScaleEnd] = mainXScale.range()\n\t\tconst [yScaleEnd, yScaleStart] = mainYScale.range()\n\t\tconst width = xScaleEnd - xScaleStart\n\t\tconst height = yScaleEnd - yScaleStart\n\t\tif (width === 0) {\n\t\t\treturn\n\t\t}\n\n\t\t// Get orientation of the chart\n\t\tconst { cartesianScales } = this.services\n\t\tconst orientation = cartesianScales.getOrientation()\n\t\tconst isInVerticalOrientation = orientation === CartesianOrientations.VERTICAL\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\t(d: any) => this.services.cartesianScales.getDomainValue(d),\n\t\t\t(d: any) => this.services.cartesianScales.getRangeValue(d),\n\t\t\torientation\n\t\t)\n\n\t\tconst gridSize = Math.floor((isInVerticalOrientation ? width : height) / dataGroupNames.length)\n\t\tconst boxWidth = Math.min(gridSize / 2, 16)\n\n\t\tconst boxplotData = (this.model as BoxplotChartModel).getBoxplotData()\n\n\t\t/*\n\t\t * update or initialize all box groups\n\t\t */\n\t\tconst boxGroups = svg.selectAll('.box-group').data(boxplotData)\n\t\tboxGroups.exit().remove()\n\n\t\tconst boxGroupsEnter = boxGroups.enter().append('g').attr('class', 'box-group')\n\n\t\tconst allBoxGroups = boxGroups.merge(boxGroupsEnter)\n\n\t\t/*\n\t\t * draw the 2 range lines for each box\n\t\t */\n\t\t// Start range line\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.vertical-line.start'))\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'vertical-line start'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('stroke-width', boxplotConfigs.strokeWidth.default)\n\t\t\t.attr('fill', 'none')\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-verticalstartline',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo])\n\t\t\t\tconst x1 = x0\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.whiskers.min)\n\t\t\t\tconst y1 = cartesianScales.getRangeValue(d.quartiles.q_25)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t// End range line\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.vertical-line.end'))\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'vertical-line end'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('stroke-width', boxplotConfigs.strokeWidth.default)\n\t\t\t.attr('fill', 'none')\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-verticalendline',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo])\n\t\t\t\tconst x1 = x0\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.whiskers.max)\n\t\t\t\tconst y1 = cartesianScales.getRangeValue(d.quartiles.q_75)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update the boxes\n\t\t */\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.box'))\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'box'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('fill-opacity', boxplotConfigs.box.opacity.default)\n\t\t\t.attr('stroke-width', boxplotConfigs.strokeWidth.default)\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'box')\n\t\t\t.attr('aria-label', (d: any) => d[groupMapsTo])\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-quartiles',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo]) - boxWidth / 2\n\t\t\t\tconst x1 = x0 + boxWidth\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(\n\t\t\t\t\tMath[isInVerticalOrientation ? 'max' : 'min'](d.quartiles.q_75, d.quartiles.q_25)\n\t\t\t\t)\n\t\t\t\tconst y1 =\n\t\t\t\t\ty0 +\n\t\t\t\t\tMath.abs(\n\t\t\t\t\t\tcartesianScales.getRangeValue(d.quartiles.q_75) -\n\t\t\t\t\t\t\tcartesianScales.getRangeValue(d.quartiles.q_25)\n\t\t\t\t\t)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update highlight areas\n\t\t */\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.highlight-area'))\n\t\t\t.attr('class', 'highlight-area')\n\t\t\t.attr('opacity', 0)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo]) - boxWidth / 2\n\t\t\t\tconst x1 = x0 + boxWidth\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.whiskers.min)\n\t\t\t\tconst y1 = cartesianScales.getRangeValue(d.whiskers.max)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update the starting whisker\n\t\t */\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.whisker.start'))\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'whisker start'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('stroke-width', boxplotConfigs.strokeWidth.thicker)\n\t\t\t.attr('fill', 'none')\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-startingwhisker',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo]) - boxWidth / 4\n\t\t\t\tconst x1 = x0 + boxWidth / 2\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.whiskers.min)\n\t\t\t\tconst y1 = cartesianScales.getRangeValue(d.whiskers.min)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update the median line\n\t\t */\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.median'))\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'median'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('stroke-width', 2)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-median',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo]) - boxWidth / 2\n\t\t\t\tconst x1 = x0 + boxWidth\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.quartiles.q_50)\n\t\t\t\tconst y1 = y0\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update the ending whisker\n\t\t */\n\t\tboxGroupsEnter\n\t\t\t.append('path')\n\t\t\t.merge(boxGroups.select('path.whisker.end'))\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'whisker end'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('stroke-width', boxplotConfigs.strokeWidth.thicker)\n\t\t\t.attr('fill', 'none')\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-endingwhisker',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst x0 = cartesianScales.getDomainValue(d[groupMapsTo]) - boxWidth / 4\n\t\t\t\tconst x1 = x0 + boxWidth / 2\n\t\t\t\tconst y0 = cartesianScales.getRangeValue(d.whiskers.max)\n\t\t\t\tconst y1 = cartesianScales.getRangeValue(d.whiskers.max)\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\n\t\t/*\n\t\t * Draw out and update the outlier circles\n\t\t */\n\t\tconst circles = allBoxGroups.selectAll('circle.outlier').data((d: any) =>\n\t\t\td.outliers.map((outlier: any) => {\n\t\t\t\treturn {\n\t\t\t\t\tmin: d.whiskers.min,\n\t\t\t\t\tmax: d.whiskers.max,\n\t\t\t\t\t[groupMapsTo]: d[groupMapsTo],\n\t\t\t\t\tvalue: outlier\n\t\t\t\t}\n\t\t\t})\n\t\t)\n\n\t\tcircles.exit().remove()\n\n\t\tconst circlesEnter = circles.enter().append('circle')\n\n\t\tcircles\n\t\t\t.merge(circlesEnter)\n\t\t\t.attr('r', boxplotConfigs.circle.radius)\n\t\t\t.attr('class', () =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\toriginalClassName: 'outlier'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('fill-opacity', boxplotConfigs.circle.opacity.default)\n\t\t\t.attr('cx', getXValue)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'boxplot-update-circles',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('cy', getYValue)\n\n\t\tthis.addBoxEventListeners()\n\t\tthis.addCircleEventListeners()\n\t}\n\n\taddBoxEventListeners() {\n\t\tconst self = this\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.highlight-area')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tconst parentElement = select((this as any).parentNode)\n\t\t\t\tparentElement\n\t\t\t\t\t.select('path.box')\n\t\t\t\t\t.classed('hovered', true)\n\t\t\t\t\t.attr('fill-opacity', boxplotConfigs.box.opacity.hovered)\n\n\t\t\t\t// Show tooltip for single datapoint\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\tgetProperty(options, 'locale', 'translations', 'group') ||\n\t\t\t\t\t\t\t\tgetProperty(options, 'tooltip', 'groupLabel') ||\n\t\t\t\t\t\t\t\t'Group',\n\t\t\t\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Minimum',\n\t\t\t\t\t\t\tvalue: datum.whiskers.min\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Q1',\n\t\t\t\t\t\t\tvalue: datum.quartiles.q_25\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Median',\n\t\t\t\t\t\t\tvalue: datum.quartiles.q_50\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Q3',\n\t\t\t\t\t\t\tvalue: datum.quartiles.q_75\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Maximum',\n\t\t\t\t\t\t\tvalue: datum.whiskers.max\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'IQR',\n\t\t\t\t\t\t\tvalue: datum.quartiles.q_75 - datum.quartiles.q_25\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.BOX_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.BOX_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.BOX_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tconst parentElement = select((this as any).parentNode)\n\t\t\t\tparentElement\n\t\t\t\t\t.select('path.box')\n\t\t\t\t\t.classed('hovered', false)\n\t\t\t\t\t.attr('fill-opacity', boxplotConfigs.box.opacity.default)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.BOX_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\taddCircleEventListeners() {\n\t\tconst self = this\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier()\n\n\t\tthis.parent\n\t\t\t.selectAll('circle')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\thoveredElement\n\t\t\t\t\t.classed('hovered', true)\n\t\t\t\t\t.attr('fill-opacity', boxplotConfigs.circle.opacity.hovered)\n\t\t\t\t\t.classed('unfilled', false)\n\n\t\t\t\t// Show tooltip for single datapoint\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\tgetProperty(options, 'locale', 'translations', 'group') ||\n\t\t\t\t\t\t\t\tgetProperty(options, 'tooltip', 'groupLabel') ||\n\t\t\t\t\t\t\t\t'Group',\n\t\t\t\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Outlier',\n\t\t\t\t\t\t\tvalue: datum[rangeIdentifier]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.OUTLIER_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.OUTLIER_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.OUTLIER_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement\n\t\t\t\t\t.classed('hovered', false)\n\t\t\t\t\t.attr('fill-opacity', boxplotConfigs.circle.opacity.default)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Boxplot.OUTLIER_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n}\n","import { flipSVGCoordinatesBasedOnOrientation } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { RenderTypes } from '@/interfaces/enums'\n\nexport class ZeroLine extends Component {\n\ttype = 'zero-line'\n\trenderType = RenderTypes.SVG\n\n\trender(animate: boolean) {\n\t\tconst axisPosition = this.services.cartesianScales.getRangeAxisPosition({\n\t\t\tgroups: this.configs.groups\n\t\t})\n\t\tconst rangeScale = this.services.cartesianScales.getScaleByPosition(axisPosition)\n\t\t// check the domain\n\t\tconst [minDomainValue, maxDomainValue] = rangeScale.domain()\n\n\t\tconst drawZeroLine =\n\t\t\t(minDomainValue > 0 && maxDomainValue < 0) || (minDomainValue < 0 && maxDomainValue > 0)\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer()\n\n\t\t// show zero line only if is necessary, otherwise make sure tto remove zero line if the chart\n\t\t// previously had a domain that went into negatives\n\t\tif (!drawZeroLine) {\n\t\t\t// otherwise if a chart draws a zero line and then the domain change the zero line is still in the DOM\n\t\t\tsvg.selectAll('line.domain').remove()\n\t\t\treturn\n\t\t}\n\n\t\t// Get x & y position of the line\n\t\tconst [x0, x1] = this.services.cartesianScales.getDomainScale().range()\n\t\tlet yPosition = +rangeScale(0) + 0.5\n\n\t\t// if scale domain contains NaN, return the first value of the range\n\t\t// this is necessary for the zero line y position that otherwise is NaN\n\t\t// so on the top of the chart while we want it on the bottom\n\t\tif (!yPosition) {\n\t\t\tyPosition = rangeScale.range()[0]\n\t\t}\n\n\t\tconst lineCoordinates = flipSVGCoordinatesBasedOnOrientation(\n\t\t\t{\n\t\t\t\tx0,\n\t\t\t\tx1,\n\t\t\t\ty0: yPosition,\n\t\t\t\ty1: yPosition\n\t\t\t},\n\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t)\n\n\t\tconst line = DOMUtils.appendOrSelect(svg, 'line.domain')\n\t\tline\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'zero-line-update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('y1', lineCoordinates.y0)\n\t\t\t.attr('y2', lineCoordinates.y1)\n\t\t\t.attr('x1', lineCoordinates.x0)\n\t\t\t.attr('x2', lineCoordinates.x1)\n\t}\n}\n","import { extent, scaleLinear, type Selection } from 'd3'\nimport { flipDomainAndRangeBasedOnOrientation, getProperty } from '@/tools'\nimport { Scatter } from './scatter'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class Bubble extends Scatter {\n\ttype = 'bubble'\n\trenderType = RenderTypes.SVG\n\n\tgetRadiusScale(selection: Selection<any, any, any, any>) {\n\t\tconst options = this.getOptions()\n\t\tconst { radiusMapsTo } = options.bubble\n\n\t\tconst data = selection.data()\n\t\t// Filter out any null/undefined values\n\t\tconst allRadii = data.map((d: any) => d[radiusMapsTo]).filter(radius => radius)\n\t\tconst chartSize = DOMUtils.getHTMLElementSize(this.services.domUtils.getMainContainer())\n\n\t\t// We need the ternary operator here in case the user\n\t\t// doesn't provide radius values in data\n\t\tconst radiusDataIsValid = allRadii.length > 0\n\t\tconst domain = radiusDataIsValid ? extent(allRadii) : [1, 1]\n\n\t\treturn scaleLinear()\n\t\t\t.domain(domain)\n\t\t\t.range(radiusDataIsValid ? options.bubble.radiusRange(chartSize, data) : [4, 4])\n\t}\n\n\tstyleCircles(selection: Selection<any, any, any, any>, animate: boolean) {\n\t\t// Chart options mixed with the internal configurations\n\t\tconst options = this.getOptions()\n\t\tconst { radiusMapsTo } = options.bubble\n\n\t\tconst radiusScale = this.getRadiusScale(selection)\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst { cartesianScales } = this.services\n\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d)\n\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d)\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\tgetDomainValue,\n\t\t\tgetRangeValue,\n\t\t\tcartesianScales.getOrientation()\n\t\t)\n\n\t\tselection\n\t\t\t.raise()\n\t\t\t.classed('dot', true)\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-label', (d: any) => {\n\t\t\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier(d)\n\t\t\t\treturn d[rangeIdentifier]\n\t\t\t})\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'bubble-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('cx', getXValue)\n\t\t\t.attr('cy', getYValue)\n\t\t\t// We need `|| 1` here in case the user doesn't provide radius values in data\n\t\t\t.attr('r', (d: any) => radiusScale(d[radiusMapsTo] || 1))\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'dot'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.style('stroke', (d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getStrokeColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.attr('fill-opacity', options.bubble.fillOpacity)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\tgetTooltipAdditionalItems(datum: any) {\n\t\tconst bubbleOptions = getProperty(this.getOptions(), 'bubble')\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tlabel: getProperty(bubbleOptions, 'radiusLabel'),\n\t\t\t\tvalue: datum[getProperty(bubbleOptions, 'radiusMapsTo')]\n\t\t\t}\n\t\t]\n\t}\n}\n","import { select } from 'd3'\nimport { generateSVGPathString, getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { BulletChartModel } from '@/model/bullet'\n\nexport class Bullet extends Component {\n\ttype = 'bullet'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst data = this.model.getDisplayData(this.configs.groups)\n\n\t\tconst rangeScale = this.services.cartesianScales.getRangeScale()\n\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier()\n\t\tconst [rangeScaleStart, rangeScaleEnd] = rangeScale.range()\n\t\tconst [, rangeScaleDomainMax] = rangeScale.domain()\n\n\t\tconst renderRangeBoxes = () => {\n\t\t\tconst rangeBoxData: any[] = []\n\t\t\tdata.forEach((datum: any) => {\n\t\t\t\tif (datum.ranges) {\n\t\t\t\t\tdatum.ranges.forEach((range: any, i: number) => {\n\t\t\t\t\t\tif (range !== null && range !== undefined && range < rangeScaleDomainMax) {\n\t\t\t\t\t\t\trangeBoxData.push({\n\t\t\t\t\t\t\t\tdatum,\n\t\t\t\t\t\t\t\tvalue: range,\n\t\t\t\t\t\t\t\torder: i + 1\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\trangeBoxData.push({\n\t\t\t\t\t\tdatum,\n\t\t\t\t\t\torder: 1\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Update data on all lines\n\t\t\tconst rangeBoxes = DOMUtils.appendOrSelect(svg, 'g.range-boxes')\n\t\t\t\t.selectAll('path.range-box')\n\t\t\t\t.data(rangeBoxData, (datum: any) => `${datum[groupMapsTo]}-${datum.order}`)\n\n\t\t\t// Remove lines that are no longer needed\n\t\t\trangeBoxes.exit().attr('opacity', 0).remove()\n\n\t\t\t// Add the paths that need to be introduced\n\t\t\tconst rangeBoxesEnter = rangeBoxes.enter().append('path').attr('opacity', 0)\n\n\t\t\trangeBoxesEnter\n\t\t\t\t.merge(rangeBoxes as any)\n\t\t\t\t.attr('class', (d: any) => `range-box order-${d.order}`)\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'bullet-range-box-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('d', (d: any) => {\n\t\t\t\t\t/*\n\t\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t\t */\n\t\t\t\t\tconst lineHeight = 16\n\n\t\t\t\t\tlet x0: number, x1: number, y0: number, y1: number\n\t\t\t\t\tif (d.order === 1) {\n\t\t\t\t\t\tx0 = this.services.cartesianScales.getDomainValue(d.datum) - lineHeight / 2\n\t\t\t\t\t\tx1 = x0 + lineHeight\n\t\t\t\t\t\ty0 = rangeScaleEnd - 2\n\t\t\t\t\t\ty1 = rangeScaleStart + 1\n\t\t\t\t\t} else {\n\t\t\t\t\t\tx0 = this.services.cartesianScales.getDomainValue(d.datum) - lineHeight / 2\n\t\t\t\t\t\tx1 = x0 + lineHeight\n\t\t\t\t\t\ty0 = this.services.cartesianScales.getRangeValue(d.value)\n\t\t\t\t\t\ty1 = rangeScaleEnd\n\t\t\t\t\t}\n\n\t\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.attr('opacity', 1)\n\t\t}\n\n\t\tconst renderBars = () => {\n\t\t\t// Update data on all bars\n\t\t\tconst bars = DOMUtils.appendOrSelect(svg, 'g.bars')\n\t\t\t\t.selectAll('path.bar')\n\t\t\t\t.data(data, (datum: any) => datum[groupMapsTo])\n\n\t\t\t// Remove bars that are no longer needed\n\t\t\tbars.exit().attr('opacity', 0).remove()\n\n\t\t\t// Add the paths that need to be introduced\n\t\t\tconst barsEnter = bars.enter().append('path').attr('opacity', 0)\n\n\t\t\tbarsEnter\n\t\t\t\t.merge(bars as any)\n\t\t\t\t.classed('bar', true)\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'bullet-bar-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('class', (d: any) =>\n\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\t\toriginalClassName: 'bar'\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.style('fill', (d: any) => {\n\t\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\t\treturn this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t\t})\n\t\t\t\t.attr('d', (d: any) => {\n\t\t\t\t\t/*\n\t\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t\t */\n\t\t\t\t\tconst barWidth = 8\n\t\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(d) - barWidth / 2\n\t\t\t\t\tconst x1 = x0 + barWidth\n\t\t\t\t\tconst y0 = this.services.cartesianScales.getRangeValue(0) + 1\n\t\t\t\t\tconst y1 = this.services.cartesianScales.getRangeValue(d)\n\n\t\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.attr('opacity', 1)\n\t\t\t\t// a11y\n\t\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t\t.attr('aria-roledescription', 'bar')\n\t\t\t\t.attr('aria-label', (d: any) => d.value)\n\t\t}\n\n\t\tconst renderTargetLines = () => {\n\t\t\t// Update data on all lines\n\t\t\tconst lines = DOMUtils.appendOrSelect(svg, 'g.markers')\n\t\t\t\t.selectAll('path.marker')\n\t\t\t\t.data(\n\t\t\t\t\tdata.filter((d: any) => getProperty(d, 'marker') !== null),\n\t\t\t\t\t(datum: any) => datum[groupMapsTo]\n\t\t\t\t)\n\n\t\t\t// Remove lines that are no longer needed\n\t\t\tlines.exit().attr('opacity', 0).remove()\n\n\t\t\t// Add the paths that need to be introduced\n\t\t\tconst linesEnter = lines.enter().append('path').attr('opacity', 0)\n\n\t\t\tlinesEnter\n\t\t\t\t.merge(lines as any)\n\t\t\t\t.classed('marker', true)\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'bullet-marker-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('d', (d: any) => {\n\t\t\t\t\t/*\n\t\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t\t */\n\t\t\t\t\tconst lineHeight = 24\n\t\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(d) - lineHeight / 2\n\t\t\t\t\tconst x1 = x0 + lineHeight\n\t\t\t\t\tconst y0 = this.services.cartesianScales.getRangeValue(d.marker)\n\t\t\t\t\tconst y1 = y0\n\n\t\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.attr('opacity', 1)\n\t\t}\n\n\t\tconst renderTargetQuartiles = () => {\n\t\t\tlet quartilesData: any[] = []\n\t\t\tdata\n\t\t\t\t.filter((d: any) => getProperty(d, 'marker') !== null)\n\t\t\t\t.forEach((d: any) => {\n\t\t\t\t\tconst value = d.marker\n\t\t\t\t\tconst barValue = d[rangeIdentifier]\n\n\t\t\t\t\tquartilesData = quartilesData.concat([\n\t\t\t\t\t\t{ datum: d, value: value * 0.25, barValue },\n\t\t\t\t\t\t{ datum: d, value: value * 0.5, barValue },\n\t\t\t\t\t\t{ datum: d, value: value * 0.75, barValue }\n\t\t\t\t\t])\n\t\t\t\t})\n\n\t\t\t// Update data on all lines\n\t\t\tconst lines = DOMUtils.appendOrSelect(svg, 'g.quartiles')\n\t\t\t\t.selectAll('path.quartile')\n\t\t\t\t.data(quartilesData, (datum: any) => datum[groupMapsTo])\n\n\t\t\t// Remove lines that are no longer needed\n\t\t\tlines.exit().attr('opacity', 0).remove()\n\n\t\t\t// Add the paths that need to be introduced\n\t\t\tconst linesEnter = lines.enter().append('path').attr('opacity', 0)\n\n\t\t\tlinesEnter\n\t\t\t\t.merge(lines as any)\n\t\t\t\t.attr('class', (d: any) => {\n\t\t\t\t\treturn `quartile ${d.value <= d.barValue ? 'over-bar' : ''}`\n\t\t\t\t})\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'bullet-quartile-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('d', ({ datum: d, value }: { datum: any; value: any }) => {\n\t\t\t\t\t/*\n\t\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t\t */\n\t\t\t\t\tlet lineHeight = 4\n\t\t\t\t\t// if it lines up with a performance area border\n\t\t\t\t\t// make the line taller\n\t\t\t\t\tif (d.ranges && d.ranges.indexOf(value) !== -1) {\n\t\t\t\t\t\tlineHeight = 8\n\t\t\t\t\t}\n\n\t\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(d) - lineHeight / 2\n\t\t\t\t\tconst x1 = x0 + lineHeight\n\t\t\t\t\tconst y0 = this.services.cartesianScales.getRangeValue(value)\n\t\t\t\t\tconst y1 = y0\n\n\t\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t\t.attr('opacity', 1)\n\t\t}\n\n\t\trenderRangeBoxes()\n\t\trenderBars()\n\t\trenderTargetLines()\n\t\trenderTargetQuartiles()\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-hover-simple-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-simple-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-mouseout-simple-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-simple-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier()\n\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tconst performanceAreaTitles = getProperty(options, 'bullet', 'performanceAreaTitles')\n\t\t\t\tconst matchingRangeIndex = (\n\t\t\t\t\tself.model as BulletChartModel\n\t\t\t\t).getMatchingRangeIndexForDatapoint(datum)\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\tgetProperty(options, 'locale', 'translations', 'group') ||\n\t\t\t\t\t\t\t\tgetProperty(options, 'tooltip', 'groupLabel') ||\n\t\t\t\t\t\t\t\t'Group',\n\t\t\t\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\t\t\tdataGroupName: datum[groupMapsTo]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Value',\n\t\t\t\t\t\t\tvalue: datum[rangeIdentifier]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Target',\n\t\t\t\t\t\t\tvalue: datum.marker\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Percentage',\n\t\t\t\t\t\t\tvalue: `${numberFormatter(Math.floor((datum[rangeIdentifier] / datum.marker) * 100), localeCode)}%`\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Performance',\n\t\t\t\t\t\t\tvalue: performanceAreaTitles[matchingRangeIndex]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity.js\";\n\nexport default function(transform) {\n  if (transform == null) return identity;\n  var x0,\n      y0,\n      kx = transform.scale[0],\n      ky = transform.scale[1],\n      dx = transform.translate[0],\n      dy = transform.translate[1];\n  return function(input, i) {\n    if (!i) x0 = y0 = 0;\n    var j = 2, n = input.length, output = new Array(n);\n    output[0] = (x0 += input[0]) * kx + dx;\n    output[1] = (y0 += input[1]) * ky + dy;\n    while (j < n) output[j] = input[j], ++j;\n    return output;\n  };\n}\n","export default function(array, n) {\n  var t, j = array.length, i = j - n;\n  while (i < --j) t = array[i], array[i++] = array[j], array[j] = t;\n}\n","import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\n\nexport default function(topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n","export default function(topology, arcs) {\n  var stitchedArcs = {},\n      fragmentByStart = {},\n      fragmentByEnd = {},\n      fragments = [],\n      emptyIndex = -1;\n\n  // Stitch empty arcs first, since they may be subsumed by other arcs.\n  arcs.forEach(function(i, j) {\n    var arc = topology.arcs[i < 0 ? ~i : i], t;\n    if (arc.length < 3 && !arc[1][0] && !arc[1][1]) {\n      t = arcs[++emptyIndex], arcs[emptyIndex] = i, arcs[j] = t;\n    }\n  });\n\n  arcs.forEach(function(i) {\n    var e = ends(i),\n        start = e[0],\n        end = e[1],\n        f, g;\n\n    if (f = fragmentByEnd[start]) {\n      delete fragmentByEnd[f.end];\n      f.push(i);\n      f.end = end;\n      if (g = fragmentByStart[end]) {\n        delete fragmentByStart[g.start];\n        var fg = g === f ? f : f.concat(g);\n        fragmentByStart[fg.start = f.start] = fragmentByEnd[fg.end = g.end] = fg;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else if (f = fragmentByStart[end]) {\n      delete fragmentByStart[f.start];\n      f.unshift(i);\n      f.start = start;\n      if (g = fragmentByEnd[start]) {\n        delete fragmentByEnd[g.end];\n        var gf = g === f ? f : g.concat(f);\n        fragmentByStart[gf.start = g.start] = fragmentByEnd[gf.end = f.end] = gf;\n      } else {\n        fragmentByStart[f.start] = fragmentByEnd[f.end] = f;\n      }\n    } else {\n      f = [i];\n      fragmentByStart[f.start = start] = fragmentByEnd[f.end = end] = f;\n    }\n  });\n\n  function ends(i) {\n    var arc = topology.arcs[i < 0 ? ~i : i], p0 = arc[0], p1;\n    if (topology.transform) p1 = [0, 0], arc.forEach(function(dp) { p1[0] += dp[0], p1[1] += dp[1]; });\n    else p1 = arc[arc.length - 1];\n    return i < 0 ? [p1, p0] : [p0, p1];\n  }\n\n  function flush(fragmentByEnd, fragmentByStart) {\n    for (var k in fragmentByEnd) {\n      var f = fragmentByEnd[k];\n      delete fragmentByStart[f.start];\n      delete f.start;\n      delete f.end;\n      f.forEach(function(i) { stitchedArcs[i < 0 ? ~i : i] = 1; });\n      fragments.push(f);\n    }\n  }\n\n  flush(fragmentByEnd, fragmentByStart);\n  flush(fragmentByStart, fragmentByEnd);\n  arcs.forEach(function(i) { if (!stitchedArcs[i < 0 ? ~i : i]) fragments.push([i]); });\n\n  return fragments;\n}\n","import {object} from \"./feature.js\";\nimport stitch from \"./stitch.js\";\n\nfunction planarRingArea(ring) {\n  var i = -1, n = ring.length, a, b = ring[n - 1], area = 0;\n  while (++i < n) a = b, b = ring[i], area += a[0] * b[1] - a[1] * b[0];\n  return Math.abs(area); // Note: doubled area!\n}\n\nexport default function(topology) {\n  return object(topology, mergeArcs.apply(this, arguments));\n}\n\nexport function mergeArcs(topology, objects) {\n  var polygonsByArc = {},\n      polygons = [],\n      groups = [];\n\n  objects.forEach(geometry);\n\n  function geometry(o) {\n    switch (o.type) {\n      case \"GeometryCollection\": o.geometries.forEach(geometry); break;\n      case \"Polygon\": extract(o.arcs); break;\n      case \"MultiPolygon\": o.arcs.forEach(extract); break;\n    }\n  }\n\n  function extract(polygon) {\n    polygon.forEach(function(ring) {\n      ring.forEach(function(arc) {\n        (polygonsByArc[arc = arc < 0 ? ~arc : arc] || (polygonsByArc[arc] = [])).push(polygon);\n      });\n    });\n    polygons.push(polygon);\n  }\n\n  function area(ring) {\n    return planarRingArea(object(topology, {type: \"Polygon\", arcs: [ring]}).coordinates[0]);\n  }\n\n  polygons.forEach(function(polygon) {\n    if (!polygon._) {\n      var group = [],\n          neighbors = [polygon];\n      polygon._ = 1;\n      groups.push(group);\n      while (polygon = neighbors.pop()) {\n        group.push(polygon);\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            polygonsByArc[arc < 0 ? ~arc : arc].forEach(function(polygon) {\n              if (!polygon._) {\n                polygon._ = 1;\n                neighbors.push(polygon);\n              }\n            });\n          });\n        });\n      }\n    }\n  });\n\n  polygons.forEach(function(polygon) {\n    delete polygon._;\n  });\n\n  return {\n    type: \"MultiPolygon\",\n    arcs: groups.map(function(polygons) {\n      var arcs = [], n;\n\n      // Extract the exterior (unique) arcs.\n      polygons.forEach(function(polygon) {\n        polygon.forEach(function(ring) {\n          ring.forEach(function(arc) {\n            if (polygonsByArc[arc < 0 ? ~arc : arc].length < 2) {\n              arcs.push(arc);\n            }\n          });\n        });\n      });\n\n      // Stitch the arcs into one or more rings.\n      arcs = stitch(topology, arcs);\n\n      // If more than one ring is returned,\n      // at most one of these rings can be the exterior;\n      // choose the one with the greatest absolute area.\n      if ((n = arcs.length) > 1) {\n        for (var i = 1, k = area(arcs[0]), ki, t; i < n; ++i) {\n          if ((ki = area(arcs[i])) > k) {\n            t = arcs[0], arcs[0] = arcs[i], arcs[i] = t, k = ki;\n          }\n        }\n      }\n\n      return arcs;\n    }).filter(function(arcs) {\n      return arcs.length > 0;\n    })\n  };\n}\n","import { select, type Selection } from 'd3'\nimport { get, isEqual } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { Ruler } from './ruler'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { CartesianOrientations, ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\n\nexport class BinnedRuler extends Ruler {\n\ttype = 'ruler-binned'\n\trenderType = RenderTypes.SVG\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tshowRuler(event: CustomEvent, [x, y]: [number, number]) {\n\t\tconst svg = this.parent\n\n\t\tconst options = this.model.getOptions()\n\t\tconst { cartesianScales } = this.services\n\n\t\tconst orientation: CartesianOrientations = cartesianScales.getOrientation()\n\n\t\tconst rangeScale = cartesianScales.getRangeScale()\n\t\tconst [yScaleEnd, yScaleStart] = rangeScale.range()\n\n\t\tconst domainScale = cartesianScales.getDomainScale()\n\n\t\tconst correspondingDomainValue = domainScale.invert(\n\t\t\torientation === CartesianOrientations.VERTICAL ? x : y\n\t\t)\n\n\t\tconst ruler = DOMUtils.appendOrSelect(svg, 'g.ruler').attr('aria-label', 'ruler')\n\t\tconst rulerLine = DOMUtils.appendOrSelect(ruler, 'line.ruler-line')\n\n\t\tconst dataPointElements = svg.selectAll('[role=graphics-symbol]') as Selection<\n\t\t\tSVGGraphicsElement,\n\t\t\tany,\n\t\t\tElement,\n\t\t\tany\n\t\t>\n\n\t\tconst elementsToHighlight = dataPointElements.filter((d: any) => {\n\t\t\tif (\n\t\t\t\tparseFloat(get(d, 'data.x0')) <= correspondingDomainValue &&\n\t\t\t\tparseFloat(get(d, 'data.x1')) >= correspondingDomainValue\n\t\t\t) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t})\n\n\t\t// some data point match\n\t\tif (elementsToHighlight.size() > 0) {\n\t\t\t/** if we pass from a trigger area to another one\n\t\t\t * mouseout on previous elements won't get dispatched\n\t\t\t * so we need to do it manually\n\t\t\t */\n\t\t\tif (\n\t\t\t\tthis.elementsToHighlight &&\n\t\t\t\tthis.elementsToHighlight.size() > 0 &&\n\t\t\t\t!isEqual(this.elementsToHighlight, elementsToHighlight)\n\t\t\t) {\n\t\t\t\tthis.hideRuler()\n\t\t\t}\n\n\t\t\telementsToHighlight.dispatch('mouseover')\n\n\t\t\t// set current hovered elements\n\t\t\tthis.elementsToHighlight = elementsToHighlight\n\n\t\t\tconst sampleMatchData = select(elementsToHighlight.nodes()[0]).datum()\n\n\t\t\tconst x0 = parseFloat(get(sampleMatchData, 'data.x0'))\n\t\t\tconst x1 = parseFloat(get(sampleMatchData, 'data.x1'))\n\n\t\t\tconst activeDataGroupNames = this.model.getActiveDataGroupNames()\n\n\t\t\tconst tooltipDataGroups = activeDataGroupNames\n\t\t\t\t.reverse()\n\t\t\t\t.map((dataGroupName: string) => ({\n\t\t\t\t\tlabel: dataGroupName,\n\t\t\t\t\tvalue: get(sampleMatchData, `data.${dataGroupName}`),\n\t\t\t\t\tclass: this.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\tdataGroupName\n\t\t\t\t\t})\n\t\t\t\t}))\n\t\t\t\t.filter((d: any) => d.value !== 0)\n\t\t\tconst thereIsMatchingData = tooltipDataGroups.length > 0\n\n\t\t\tif (thereIsMatchingData) {\n\t\t\t\tthis.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tmousePosition: [x, y],\n\t\t\t\t\thoveredElement: rulerLine,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: get(options, 'bins.rangeLabel') || 'Range',\n\t\t\t\t\t\t\tvalue: `${x0} – ${x1}`\n\t\t\t\t\t\t},\n\t\t\t\t\t\t...tooltipDataGroups,\n\t\t\t\t\t\t...(getProperty(options, 'tooltip', 'showTotal') === true\n\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\t\t\t\tget(options, 'locale.translations.total') ||\n\t\t\t\t\t\t\t\t\t\t\tget(options, 'tooltip.totalLabel') ||\n\t\t\t\t\t\t\t\t\t\t\t'Total',\n\t\t\t\t\t\t\t\t\t\tvalue: activeDataGroupNames.reduce(\n\t\t\t\t\t\t\t\t\t\t\t(accum: number, currentValue: any) =>\n\t\t\t\t\t\t\t\t\t\t\t\taccum + parseFloat(get(sampleMatchData, `data.${currentValue}`)),\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t: [])\n\t\t\t\t\t]\n\t\t\t\t})\n\n\t\t\t\truler.attr('opacity', 1)\n\n\t\t\t\tconst rulerPosition = domainScale((x0 + x1) / 2)\n\n\t\t\t\t// line snaps to matching point\n\t\t\t\tif (orientation === 'horizontal') {\n\t\t\t\t\trulerLine\n\t\t\t\t\t\t.attr('x1', yScaleStart)\n\t\t\t\t\t\t.attr('x2', yScaleEnd)\n\t\t\t\t\t\t.attr('y1', rulerPosition)\n\t\t\t\t\t\t.attr('y2', rulerPosition)\n\t\t\t\t} else {\n\t\t\t\t\trulerLine\n\t\t\t\t\t\t.attr('y1', yScaleStart)\n\t\t\t\t\t\t.attr('y2', yScaleEnd)\n\t\t\t\t\t\t.attr('x1', rulerPosition)\n\t\t\t\t\t\t.attr('x2', rulerPosition)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.hideRuler()\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hideRuler()\n\t\t}\n\t}\n}\n","import { Ruler } from './ruler'\n\nexport class StackedRuler extends Ruler {\n\tformatTooltipData(tooltipData: any) {\n\t\treturn tooltipData.reverse()\n\t}\n}\n","import { path as d3Path } from 'd3'\nimport type { Coordinates } from '@/interfaces/layout'\n\n/**\n * Returns a path string for a straight path\n * @param source - The source coordinates\n * @param source.x - The source's x coordinate\n * @param source.y - The source's y coordinate\n * @param target - The target coordinates\n * @param target.x - The target's x coordinate\n * @param target.y - The target's y coordinate\n * @return The path string\n */\nconst buildStraightPathString = (source: Coordinates, target: Coordinates) => {\n\tconst sx = source.x as number\n\tconst sy = source.y as number\n\tconst tx = target.x as number\n\tconst ty = target.y as number\n\n\tconst path = d3Path()\n\n\tpath.moveTo(sx, sy)\n\tpath.lineTo(tx, ty)\n\n\treturn path.toString()\n}\n\n/**\n * Returns a path string for an elbow path with a bend point\n * @param  source - The source coordinates\n * @param  source.x - The source's x coordinate\n * @param  source.y - The source's y coordinate\n * @param  target - The target coordinates\n * @param  target.x - The target's x coordinate\n * @param  target.y - The target's y coordinate\n * @param  percent - Where the bend point should appear between the source and target\n * @return The path string\n */\nconst buildElbowPathString = (source: Coordinates, target: Coordinates, percent = 0.5) => {\n\tconst sx = source.x\n\tconst sy = source.y\n\tconst tx = target.x\n\tconst ty = target.y\n\n\tconst path = d3Path()\n\n\tpath.moveTo(sx, sy)\n\tpath.lineTo(sx + (tx - sx) * percent, sy)\n\tpath.lineTo(sx + (tx - sx) * percent, ty)\n\tpath.lineTo(tx, ty)\n\n\treturn path.toString()\n}\n\n/**\n * Returns a path string for an path with a custom bezier curve\n * @param source - The source coordinates\n * @param source.x - The source's x coordinate\n * @param source.y - The source's y coordinate\n * @param target - The target coordinates\n * @param target.x - The target's x coordinate\n * @param target.y - The target's y coordinate\n * @param cpx1 - X coordinate for the first control point\n * @param cpy1 - Y coordinate for the first control point\n * @param cpx2 - X coordinate for the second control point\n * @param cpy2 - Y coordinate for the second control point\n * @return The path string\n */\nconst buildBezierPathString = (\n\tsource: Coordinates,\n\ttarget: Coordinates,\n\tcpx1: number,\n\tcpy1: number,\n\tcpx2: number,\n\tcpy2: number\n) => {\n\tconst sx = source.x\n\tconst sy = source.y\n\tconst tx = target.x\n\tconst ty = target.y\n\n\tconst path = d3Path()\n\n\tpath.moveTo(sx, sy)\n\tpath.bezierCurveTo(cpx1, cpy1, cpx2, cpy2, tx, ty)\n\n\treturn path.toString()\n}\n\nexport { buildStraightPathString, buildElbowPathString, buildBezierPathString }\n","const arrowLeft = {\n\td: 'M7 0v8L0 4z',\n\theight: 8,\n\twidth: 7.5,\n\tid: 'arrowLeft'\n}\n\nconst arrowRight = {\n\td: 'M0 0v8l7-4z',\n\theight: 8,\n\twidth: 7.5,\n\tid: 'arrowRight'\n}\n\nconst circle = {\n\td: 'M5.32 9.513a4.75 4.75 0 100-9.5 4.75 4.75 0 000 9.5z',\n\theight: 10,\n\twidth: 10,\n\tid: 'circle'\n}\n\nconst diamond = {\n\td: 'M5.03517654-1e-7l4.99999996 5-4.99999996 5-5-5L2.4517844 2.58339204z',\n\theight: 10,\n\twidth: 10,\n\tid: 'diamond'\n}\n\nconst square = {\n\td: 'M0 .44974747h8v8H0v-3.6830331z',\n\theight: 9,\n\twidth: 8,\n\tid: 'square'\n}\n\nconst tee = {\n\td: 'M0 0h1.5v8H0z',\n\theight: 8,\n\twidth: 2,\n\tid: 'tee'\n}\n\nexport { arrowLeft, arrowRight, square, diamond, circle, tee }\n","import { axisBottom, interpolateNumber, quantize, scaleBand, scaleLinear } from 'd3'\nimport { isEmpty } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { legend as legendConfigs } from '@/configuration'\nimport { ColorLegendType, Events, RenderTypes } from '@/interfaces/enums'\nimport { Legend } from './legend'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { getDomain } from '@/services/color-scale-utils'\nimport type { ChartModel } from '@/model'\n\nexport class ColorScaleLegend extends Legend {\n\ttype = 'color-legend'\n\trenderType = RenderTypes.SVG\n\n\tprivate gradient_id = `gradient-id-${Math.floor(Math.random() * 99999999999)}`\n\tprivate chartType: string\n\n\tconstructor(model: ChartModel, services: any, configs?: any) {\n\t\tsuper(model, services, configs)\n\t\tthis.chartType = configs.chartType\n\t}\n\n\tinit() {\n\t\t// Highlight correct circle on legend item hovers\n\t\tif (this.chartType === 'heatmap') {\n\t\t\tconst eventsFragment = this.services.events\n\t\t\teventsFragment.addEventListener(Events.Axis.RENDER_COMPLETE, this.handleAxisCompleteEvent)\n\t\t}\n\t}\n\n\t// Position legend after axis have rendered\n\thandleAxisCompleteEvent = () => {\n\t\tconst svg = this.getComponentContainer()\n\n\t\tconst { width } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst isDataLoading = getProperty(this.getOptions(), 'data', 'loading')\n\n\t\tif (width > legendConfigs.color.barWidth && !isDataLoading) {\n\t\t\tconst title = getProperty(this.getOptions(), 'heatmap', 'colorLegend', 'title')\n\n\t\t\tconst { cartesianScales } = this.services\n\n\t\t\t// Get axis width & start/end positions\n\t\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\t\tconst xDimensions = mainXScale.range()\n\n\t\t\t// Align legend with the axis\n\t\t\tif (xDimensions[0] > 1) {\n\t\t\t\tsvg.select('g.legend').attr('transform', `translate(${xDimensions[0]}, 0)`)\n\n\t\t\t\tif (title) {\n\t\t\t\t\tconst { width: textWidth } = DOMUtils.getSVGElementSize(\n\t\t\t\t\t\tsvg.select('g.legend-title').select('text'),\n\t\t\t\t\t\t{ useBBox: true }\n\t\t\t\t\t)\n\n\t\t\t\t\t// D3 moves the LEFT y-axis labels by 9\n\t\t\t\t\tconst availableSpace = xDimensions[0] - textWidth - 9\n\n\t\t\t\t\t// If space is available, align the label with the axis labels\n\t\t\t\t\tif (availableSpace > 1) {\n\t\t\t\t\t\tsvg.select('g.legend-title').attr('transform', `translate(${availableSpace}, 0)`)\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Move the legend down by 16 pixels to display legend text on top\n\t\t\t\t\t\tsvg.select('g.legend').attr('transform', `translate(${xDimensions[0]}, 16)`)\n\n\t\t\t\t\t\t// Align legend title with start of axis\n\t\t\t\t\t\tsvg.select('g.legend-title').attr('transform', `translate(${xDimensions[0]}, 0)`)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Default state\n\t\t\tsvg.select('g.legend-title').attr('transform', `translate(0, 0)`)\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst options = this.getOptions()\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { width } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst customColors = getProperty(options, 'color', 'gradient', 'colors')\n\n\t\tconst colorScaleType = getProperty(options, this.chartType, 'colorLegend', 'type')\n\n\t\tlet colorPairingOption = getProperty(options, 'color', 'pairing', 'option')\n\n\t\tconst title = getProperty(options, 'heatmap', 'colorLegend', 'title')\n\n\t\t// Clear DOM if loading\n\t\tconst isDataLoading = getProperty(this.getOptions(), 'data', 'loading')\n\n\t\tif (isDataLoading) {\n\t\t\tsvg.html('')\n\t\t\treturn\n\t\t}\n\n\t\tconst customColorsEnabled = !isEmpty(customColors)\n\t\tconst domain = getDomain(this.model.getDisplayData())\n\n\t\tconst useDefaultBarWidth = !(width <= legendConfigs.color.barWidth)\n\t\tconst barWidth = useDefaultBarWidth ? legendConfigs.color.barWidth : width\n\n\t\tconst legendGroupElement = DOMUtils.appendOrSelect(svg, 'g.legend')\n\t\tconst axisElement = DOMUtils.appendOrSelect(legendGroupElement, 'g.legend-axis')\n\n\t\t// Render title if it exists\n\t\tif (title) {\n\t\t\tconst legendTitleGroup = DOMUtils.appendOrSelect(svg, 'g.legend-title')\n\t\t\tconst legendTitle = DOMUtils.appendOrSelect(legendTitleGroup, 'text')\n\t\t\tlegendTitle.text(title).attr('dy', '0.7em')\n\n\t\t\t// Move the legend down by 16 pixels to display legend text on top\n\t\t\tlegendGroupElement.attr('transform', `translate(0, 16)`)\n\t\t}\n\n\t\t// If domain consists of negative and positive values, use diverging palettes\n\t\tconst colorScheme = domain[0] < 0 && domain[1] > 0 ? 'diverge' : 'mono'\n\n\t\t// Use default color pairing options if not in defined range\n\t\tif (colorPairingOption < 1 && colorPairingOption > 4 && colorScheme === 'mono') {\n\t\t\tcolorPairingOption = 1\n\t\t} else if (colorPairingOption < 1 && colorPairingOption > 2 && colorScheme === 'diverge') {\n\t\t\tcolorPairingOption = 1\n\t\t}\n\n\t\tlet colorPairing = []\n\t\t// Carbon charts has 11 colors for a single monochromatic palette & 17 for a divergent palette\n\t\tconst colorGroupingLength = colorScheme === 'diverge' ? 17 : 11\n\n\t\tif (!customColorsEnabled) {\n\t\t\t// Add class names to list and the amount based on the color scheme\n\t\t\tfor (let i = 1; i < colorGroupingLength + 1; i++) {\n\t\t\t\tcolorPairing.push(\n\t\t\t\t\tcolorScaleType === ColorLegendType.LINEAR\n\t\t\t\t\t\t? `stop-color-${colorScheme}-${colorPairingOption}-${i}`\n\t\t\t\t\t\t: `fill-${colorScheme}-${colorPairingOption}-${i}`\n\t\t\t\t)\n\t\t\t}\n\t\t} else {\n\t\t\t// Use custom colors\n\t\t\tcolorPairing = customColors\n\t\t}\n\n\t\t// Generate equal chunks between range to act as ticks\n\t\tconst interpolator = interpolateNumber(domain[0], domain[1])\n\t\tconst quant = quantize(interpolator, 3)\n\n\t\t// Create scale & ticks\n\t\tconst linearScale = scaleLinear().domain(domain).range([0, barWidth])\n\t\tconst legendAxis = axisBottom(linearScale).tickSize(0).tickValues(quant)\n\n\t\t//translating ticks into given locale language\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\tlegendAxis.tickFormat(d => numberFormatter(d, localeCode))\n\n\t\tlet rangeStart: any // avoid unexpected lexical declaration in case block\n\t\tswitch (colorScaleType) {\n\t\t\tcase ColorLegendType.LINEAR:\n\t\t\t\tthis.drawLinear(colorPairing, legendGroupElement, barWidth)\n\t\t\t\tbreak\n\t\t\tcase ColorLegendType.QUANTIZE:\n\t\t\t\trangeStart = this.drawQuantize(\n\t\t\t\t\tcolorPairing,\n\t\t\t\t\tcolorScheme,\n\t\t\t\t\tcustomColorsEnabled,\n\t\t\t\t\tlegendGroupElement,\n\t\t\t\t\tbarWidth\n\t\t\t\t)\n\t\t\t\t// Using range provided by drawQuantize for alignment purposes\n\t\t\t\tlinearScale.range([rangeStart, barWidth])\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tthrow Error('Entered color legend type is not supported.')\n\t\t}\n\n\t\t// Align axes at the bottom of the rectangle and delete the domain line\n\t\taxisElement\n\t\t\t.attr('transform', `translate(0,${legendConfigs.color.axisYTranslation})`)\n\t\t\t.call(legendAxis)\n\n\t\t// Remove auto generated axis bottom line\n\t\taxisElement.select('.domain').remove()\n\n\t\t// Translate first/last axis tick if barWidth equals chart width\n\t\t// Ensures text is not clipped when default bar width (300px) is not used\n\t\taxisElement\n\t\t\t.select('g.tick:last-of-type text')\n\t\t\t.style('text-anchor', useDefaultBarWidth ? 'middle' : 'end')\n\t\taxisElement\n\t\t\t.select('g.tick:first-of-type text')\n\t\t\t.style(\n\t\t\t\t'text-anchor',\n\t\t\t\tuseDefaultBarWidth && this.chartType !== 'choropleth' ? 'middle' : 'start'\n\t\t\t)\n\t}\n\n\t// Renders gradient legend\n\tdrawLinear(colorPairing: any, legendGroupElement: any, barWidth: any) {\n\t\tconst stopLengthPercentage = 100 / (colorPairing.length - 1)\n\n\t\t// Generate the gradient\n\t\tconst linearGradient = DOMUtils.appendOrSelect(legendGroupElement, 'linearGradient')\n\t\t// Rendering gradient\n\t\tlinearGradient\n\t\t\t.attr('id', `${this.gradient_id}-legend`)\n\t\t\t.selectAll('stop')\n\t\t\t.data(colorPairing)\n\t\t\t.enter()\n\t\t\t.append('stop')\n\t\t\t.attr('offset', (_: any, i: number) => `${i * stopLengthPercentage}%`)\n\t\t\t.attr('class', (_: any, i: number) => colorPairing[i])\n\t\t\t.attr('stop-color', (d: string) => d)\n\n\t\t// Create the legend container\n\t\tconst rectangle = DOMUtils.appendOrSelect(legendGroupElement, 'rect')\n\t\trectangle\n\t\t\t.attr('width', barWidth)\n\t\t\t.attr('height', legendConfigs.color.barHeight)\n\t\t\t.style('fill', `url(#${this.gradient_id}-legend)`)\n\t}\n\n\t/**\n\t * Renders quantized legend\n\t * @returns number (range start)\n\t */\n\tdrawQuantize(\n\t\tcolorPairing: any,\n\t\tcolorScheme: any,\n\t\tcustomColorsEnabled: any,\n\t\tlegendGroupElement: any,\n\t\tbarWidth: any\n\t) {\n\t\t// If divergent && non-custom color, remove 0/white from being displayed\n\t\tif (!customColorsEnabled && colorScheme === 'diverge') {\n\t\t\tcolorPairing.splice(colorPairing.length / 2, 1)\n\t\t}\n\n\t\tconst colorScaleBand = scaleBand().domain(colorPairing).range([0, barWidth])\n\n\t\t// Render the quantized rectangles\n\t\tconst rectangle = DOMUtils.appendOrSelect(legendGroupElement, 'g.quantized-rect')\n\n\t\trectangle\n\t\t\t.selectAll('rect')\n\t\t\t.data(colorScaleBand.domain())\n\t\t\t.join('rect')\n\t\t\t.attr('x', (d: string) => colorScaleBand(d))\n\t\t\t.attr('y', 0)\n\t\t\t.attr('width', Math.max(0, colorScaleBand.bandwidth() - 1))\n\t\t\t.attr('height', legendConfigs.color.barHeight)\n\t\t\t.attr('class', (d: string) => d)\n\t\t\t.attr('fill', (d: string) => d)\n\n\t\treturn (!customColorsEnabled && colorScheme) === 'mono' ? colorScaleBand.bandwidth() - 1 : 0\n\t}\n\n\tdestroy() {\n\t\tif (this.chartType === 'heatmap') {\n\t\t\t// Remove legend listeners\n\t\t\tconst eventsFragment = this.services.events\n\t\t\teventsFragment.removeEventListener(Events.Axis.RENDER_COMPLETE, this.handleAxisCompleteEvent)\n\t\t}\n\t}\n}\n","import type { Selection as D3Selection } from 'd3'\nimport { getProperty } from '@/tools'\nimport { meter as meterConfigs } from '@/configuration'\nimport { Title } from './title'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { RenderTypes, Statuses } from '@/interfaces/enums'\nimport { MeterChartModel } from '@/model/meter'\n\nexport class MeterTitle extends Title {\n\ttype = 'meter-title'\n\trenderType = RenderTypes.SVG\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = false) {\n\t\tconst dataset = getProperty(this.model.getDisplayData(), 0)\n\t\tconst options = this.getOptions()\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst meterTitle = options.locale.translations.meter.title\n\t\tconst proportional = getProperty(options, 'meter', 'proportional')\n\n\t\tif (proportional) {\n\t\t\tthis.displayTotal()\n\t\t\tthis.displayBreakdownTitle()\n\t\t} else {\n\t\t\t// the title for a meter, is the label for that dataset\n\t\t\tconst title = svg\n\t\t\t\t.selectAll('text.meter-title')\n\t\t\t\t.data(meterTitle ? [meterTitle] : [dataset[groupMapsTo]])\n\t\t\ttitle\n\t\t\t\t.enter()\n\t\t\t\t.append('text')\n\t\t\t\t.classed('meter-title', true)\n\t\t\t\t.merge(title as any)\n\t\t\t\t.attr('x', 0)\n\t\t\t\t.attr('y', '1em')\n\t\t\t\t.text((d: any) => d)\n\n\t\t\ttitle.exit().remove()\n\n\t\t\t// appends the associated percentage after title\n\t\t\tthis.appendPercentage()\n\t\t}\n\n\t\t// if status ranges are provided (custom or default), display indicator\n\t\tthis.displayStatus()\n\n\t\t// get the max width of a title (with consideration for the status/percentage)\n\t\tconst maxWidth = this.getMaxTitleWidth()\n\t\tconst titleElement = DOMUtils.appendOrSelect(svg, 'text.meter-title')\n\n\t\tif (maxWidth > 0 && titleElement.node().getComputedTextLength() > maxWidth) {\n\t\t\tthis.truncateTitle(titleElement, maxWidth)\n\t\t}\n\t}\n\n\tdisplayBreakdownTitle() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\t\tconst datasetsTotal = (this.model as MeterChartModel).getMaximumDomain(\n\t\t\tthis.model.getDisplayData()\n\t\t)\n\t\tconst total = getProperty(options, 'meter', 'proportional', 'total')\n\t\tconst unit = getProperty(options, 'meter', 'proportional', 'unit')\n\t\t\t? getProperty(options, 'meter', 'proportional', 'unit')\n\t\t\t: ''\n\n\t\tlet data\n\t\tif (datasetsTotal === total) {\n\t\t\tdata = null\n\t\t} else {\n\t\t\tconst difference = total !== null ? total - datasetsTotal : datasetsTotal\n\t\t\t//breakdownFormatter\n\t\t\tconst breakdownFormatter = getProperty(options, 'meter', 'proportional', 'breakdownFormatter')\n\t\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\t\tdata =\n\t\t\t\tbreakdownFormatter !== null\n\t\t\t\t\t? breakdownFormatter({\n\t\t\t\t\t\t\tdatasetsTotal: datasetsTotal,\n\t\t\t\t\t\t\ttotal: total\n\t\t\t\t\t\t})\n\t\t\t\t\t: `${numberFormatter(datasetsTotal, localeCode)} ${unit} used (${numberFormatter(difference, localeCode)} ${unit} available)`\n\t\t}\n\n\t\t// the breakdown part to whole of the datasets to the overall total\n\t\tconst title = svg.selectAll('text.proportional-meter-title').data([data])\n\n\t\ttitle\n\t\t\t.enter()\n\t\t\t.append('text')\n\t\t\t.classed('proportional-meter-title', true)\n\t\t\t.merge(title as any)\n\t\t\t.attr('x', 0)\n\t\t\t.attr('y', '1em')\n\t\t\t.text((d: any) => d)\n\n\t\ttitle.exit().remove()\n\n\t\tconst maxWidth = this.getMaxTitleWidth()\n\t\tconst titleElement = DOMUtils.appendOrSelect(svg, 'text.proportional-meter-title')\n\n\t\tif (maxWidth > 0 && titleElement.node().getComputedTextLength() > maxWidth) {\n\t\t\tthis.truncateTitle(titleElement, maxWidth)\n\t\t}\n\t}\n\n\t// show the total for prop meter\n\tdisplayTotal() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\n\t\tconst total = getProperty(options, 'meter', 'proportional', 'total')\n\n\t\tconst totalValue = total\n\t\t\t? getProperty(options, 'meter', 'proportional', 'total')\n\t\t\t: (this.model as MeterChartModel).getMaximumDomain(this.model.getDisplayData())\n\n\t\tconst unit = getProperty(options, 'meter', 'proportional', 'unit')\n\t\t\t? getProperty(options, 'meter', 'proportional', 'unit')\n\t\t\t: ''\n\n\t\t// totalFormatter function\n\t\tconst totalFormatter = getProperty(options, 'meter', 'proportional', 'totalFormatter')\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\n\t\tconst totalString =\n\t\t\ttotalFormatter !== null\n\t\t\t\t? totalFormatter(totalValue)\n\t\t\t\t: `${numberFormatter(total, localeCode)} ${unit} total`\n\n\t\tconst containerWidth = DOMUtils.getHTMLElementSize(this.parent.node() as HTMLElement).width\n\n\t\tconst title = svg.selectAll('text.proportional-meter-total').data([totalString])\n\n\t\ttitle\n\t\t\t.enter()\n\t\t\t.append('text')\n\t\t\t.classed('proportional-meter-total', true)\n\t\t\t.merge(title as any)\n\t\t\t// Position the total text -24 pixels to add spacing between text and status icon (if status exists)\n\t\t\t.attr(\n\t\t\t\t'x',\n\t\t\t\tthis.model.getStatus() && typeof containerWidth !== 'string'\n\t\t\t\t\t? containerWidth - meterConfigs.total.paddingRight\n\t\t\t\t\t: containerWidth\n\t\t\t)\n\t\t\t.attr('y', '1em')\n\t\t\t.attr('text-anchor', 'end')\n\t\t\t.text((d: any) => d)\n\n\t\ttitle.exit().remove()\n\t}\n\n\t/**\n\t * Appends the corresponding status based on the value and the peak.\n\t */\n\tdisplayStatus() {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer()\n\n\t\tconst containerWidth = DOMUtils.getHTMLElementSize(this.parent.node() as HTMLElement).width || 0\n\n\t\t// get the status from the model\n\t\tconst status = this.model.getStatus()\n\t\tconst radius = meterConfigs.status.indicatorSize / 2\n\n\t\t// create a group for the icon/inner path\n\t\tconst statusGroup = DOMUtils.appendOrSelect(svg, `g.status-indicator`)\n\t\t\t.attr('class', status !== null ? `status-indicator status--${status}` : '')\n\t\t\t.attr('transform', `translate(${containerWidth - radius}, 0)`)\n\n\t\tconst data = status ? [status] : []\n\t\tconst icon = statusGroup.selectAll('circle.status').data(data) as D3Selection<\n\t\t\tSVGCircleElement,\n\t\t\tany,\n\t\t\tElement,\n\t\t\tany\n\t\t>\n\n\t\ticon\n\t\t\t.enter()\n\t\t\t.append('circle')\n\t\t\t.merge(icon)\n\t\t\t.attr('class', 'status')\n\t\t\t.attr('r', radius)\n\t\t\t.attr('cx', 0)\n\t\t\t.attr('cy', 8) // replaced `calc(1em / 2)` which is not an acceptable value for an SVG element's cy value\n\n\t\tconst innerIcon = statusGroup.selectAll('path.innerFill').data(data)\n\n\t\tinnerIcon\n\t\t\t.enter()\n\t\t\t.append('path')\n\t\t\t.merge(innerIcon as any)\n\t\t\t.attr('d', self.getStatusIconPathString(status))\n\t\t\t.attr('transform', `translate(-${radius}, 0)`)\n\t\t\t.attr('class', 'innerFill')\n\n\t\tinnerIcon.exit().remove()\n\t\ticon.exit().remove()\n\t}\n\n\t/**\n\t * Appends the associated percentage to the end of the title\n\t */\n\tappendPercentage() {\n\t\tconst dataValue = getProperty(this.model.getDisplayData(), 0, 'value')\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(this.getOptions(), 'locale')\n\t\t// use the title's position to append the percentage to the end\n\t\tconst svg = this.getComponentContainer()\n\t\tconst title = DOMUtils.appendOrSelect(svg, 'text.meter-title')\n\n\t\t// check if it is enabled\n\t\tconst data =\n\t\t\tgetProperty(this.getOptions(), 'meter', 'statusBar', 'percentageIndicator', 'enabled') ===\n\t\t\ttrue\n\t\t\t\t? [dataValue]\n\t\t\t\t: []\n\n\t\t// append a percentage if it is enabled, update it\n\t\tconst percentage = svg.selectAll('text.percent-value').data(data)\n\n\t\t// the horizontal offset of the percentage value from the title\n\t\tconst offset = meterConfigs.statusBar.paddingRight\n\n\t\tpercentage\n\t\t\t.enter()\n\t\t\t.append('text')\n\t\t\t.classed('percent-value', true)\n\t\t\t.merge(percentage as any)\n\t\t\t.text((d: any) => `${d !== null && d !== undefined ? numberFormatter(d, localeCode) : 0}%`)\n\t\t\t.attr('x', +title.attr('x') + title.node().getComputedTextLength() + offset) // set the position to after the title\n\t\t\t.attr('y', title.attr('y'))\n\n\t\tpercentage.exit().remove()\n\t}\n\n\t/**\n\t * Uses the parent class truncate logic\n\t * @param title d3 selection of title element that will be truncated\n\t * @param titlestring the original string that needs truncation\n\t * @param maxWidth the max width the title can take\n\t */\n\ttruncateTitle(title: any, maxWidth: number) {\n\t\tsuper.truncateTitle(title, maxWidth)\n\n\t\t// update the position on the percentage to be inline with the title\n\t\tconst tspan = DOMUtils.appendOrSelect(this.parent, 'tspan')\n\t\tconst offset = meterConfigs.statusBar.paddingRight\n\t\tconst tspanLength = Math.ceil(tspan.node().getComputedTextLength())\n\n\t\tconst percentage = DOMUtils.appendOrSelect(this.parent, 'text.percent-value')\n\t\tpercentage.attr(\n\t\t\t'x',\n\t\t\t+title.attr('x') + title.node().getComputedTextLength() + tspanLength + offset\n\t\t)\n\t}\n\n\t// computes the maximum space a title can take\n\tprotected getMaxTitleWidth() {\n\t\tconst proportional = getProperty(this.getOptions(), 'meter', 'proportional')\n\n\t\tconst containerWidth = DOMUtils.getHTMLElementSize(this.parent.node() as HTMLElement).width\n\n\t\tif (proportional !== null) {\n\t\t\tconst total = DOMUtils.appendOrSelect(this.parent, 'text.proportional-meter-total').node()\n\n\t\t\tconst totalWidth = DOMUtils.getSVGElementSize(total, {\n\t\t\t\tuseBBox: true\n\t\t\t}).width\n\n\t\t\treturn containerWidth - totalWidth - meterConfigs.total.paddingLeft\n\t\t} else {\n\t\t\tconst percentage = DOMUtils.appendOrSelect(this.parent, 'text.percent-value')\n\t\t\t// the title needs to fit the width of the container without crowding the status, and percentage value\n\t\t\tconst offset = meterConfigs.statusBar.paddingRight\n\t\t\tconst percentageWidth = percentage.node().getComputedTextLength()\n\n\t\t\tconst statusGroup = DOMUtils.appendOrSelect(this.parent, 'g.status-indicator').node()\n\t\t\tconst statusWidth =\n\t\t\t\tDOMUtils.getSVGElementSize(statusGroup, { useBBox: true }).width +\n\t\t\t\tmeterConfigs.status.paddingLeft\n\n\t\t\treturn containerWidth - percentageWidth - offset - statusWidth\n\t\t}\n\t}\n\n\t/**\n\t * Get the associated status icon for the data\n\t * @param status the active status for the meter chart\n\t */\n\tprotected getStatusIconPathString(status: Statuses) {\n\t\tswitch (status) {\n\t\t\tcase Statuses.SUCCESS:\n\t\t\t\treturn 'M6.875 11.3125 3.75 8.1875 4.74375 7.25 6.875 9.34375 11.50625 4.75 12.5 5.7375 Z'\n\t\t\tcase Statuses.DANGER:\n\t\t\t\treturn 'M10.7 11.5 4.5 5.3 5.3 4.5 11.5 10.7 Z'\n\t\t\tcase Statuses.WARNING:\n\t\t\t\treturn 'M7.9375,11.125 C7.41973305,11.125 7,11.544733 7,12.0625 C7,12.580267 7.41973305,13 7.9375,13 C8.45526695,13 8.875,12.580267 8.875,12.0625 C8.875,11.544733 8.45526695,11.125 7.9375,11.125 M7.3125, 3 8.5625, 3 8.5625, 9.875 7.3125, 9.875, 7.3125, 3 Z'\n\t\t}\n\t}\n}\n","// Internal Imports\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { getProperty } from '@/tools'\n\nexport class Bar extends Component {\n\t// Gets the correct width for bars based on options & configurations\n\tprotected getBarWidth() {\n\t\tconst options = this.getOptions()\n\t\tif (options.bars.width) {\n\t\t\treturn options.bars.width\n\t\t}\n\n\t\tconst numberOfDatapoints = this.model.getDisplayData().length\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst chartWidth = DOMUtils.getSVGElementSize((this as any).parent, {\n\t\t\tuseAttrs: true\n\t\t}).width\n\n\t\tif (!(mainXScale as any).step) {\n\t\t\tconst spacingFactor = getProperty(options, 'bars', 'spacingFactor')\n\n\t\t\treturn Math.min(options.bars.maxWidth, (chartWidth * spacingFactor) / numberOfDatapoints)\n\t\t}\n\n\t\treturn Math.min(options.bars.maxWidth, (mainXScale as any).step() / 2)\n\t}\n\n\tprotected isOutsideZoomedDomain(x0: number, x1: number) {\n\t\tconst dataCount = this.model.getDisplayData().length\n\t\t// if only one data point, never out of zoom domain\n\t\t// or it becomes a blank chart\n\t\tif (dataCount <= 1) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst zoomDomain = this.model.get('zoomDomain')\n\t\tif (zoomDomain !== undefined) {\n\t\t\tconst domainScale = this.services.cartesianScales.getDomainScale()\n\t\t\treturn x0 < domainScale(zoomDomain[0]) || x1 > domainScale(zoomDomain[1])\n\t\t}\n\t\treturn false\n\t}\n}\n","import { hierarchy as d3Hierarchy, pack as D3Pack, select } from 'd3'\nimport { get } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { canvasZoomSettings, circlePack as circlePackConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\nimport { CirclePackChartModel } from '@/model/circle-pack'\n\nexport class CirclePack extends Component {\n\ttype = 'circle-pack'\n\trenderType = RenderTypes.SVG\n\n\tfocal: any\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\t// svg and container widths\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// Because of a Firefox bug with regards to sizing & d3 packs,\n\t\t// rather than checking if height or width aren't 0,\n\t\t// we have to make sure they're not smaller than 1\n\t\tif (width < 1 || height < 1) {\n\t\t\t// on first render the svg is width and height 0\n\t\t\t// the circle packing layout functionality will not run\n\t\t\treturn\n\t\t}\n\n\t\t// data and options (zoom/not zoom)\n\t\tlet displayData = this.model.getDisplayData()\n\t\t// check if there is just one parent for the data\n\t\tconst parentNode = (this.model as CirclePackChartModel).hasParentNode()\n\t\tconst hierarchyLevel = (this.model as CirclePackChartModel).getHierarchyLevel()\n\t\tconst options = this.getOptions()\n\t\tconst canvasZoomEnabled = getProperty(options, 'canvasZoom', 'enabled')\n\n\t\t// check if there is one root for the data\n\t\t// that root will be the only datagroup (colorscale will be monochrome)\n\t\tif (parentNode && getProperty(displayData, 0, 'children')) {\n\t\t\t// remove want to remove the parent from being rendered\n\t\t\tdisplayData = getProperty(displayData, 0, 'children')\n\t\t}\n\n\t\tconst root = d3Hierarchy({ children: displayData })\n\t\t\t.sum((d: any) => d.value)\n\t\t\t.sort((a, b) => b.value - a.value)\n\n\t\tconst packLayout = D3Pack()\n\t\t\t.size([width, height])\n\t\t\t.padding((d: any) => {\n\t\t\t\t// add 3 px to account for the stroke width 1.5px\n\t\t\t\treturn d.depth >= 1\n\t\t\t\t\t? circlePackConfigs.padding.children + 3\n\t\t\t\t\t: circlePackConfigs.padding.mainGroup + 3\n\t\t\t})\n\n\t\tconst nodeData = packLayout(root)\n\t\t\t.descendants()\n\t\t\t.splice(1)\n\t\t\t.filter(node => {\n\t\t\t\t// filter based on hierarchy level\n\t\t\t\treturn node.depth <= hierarchyLevel\n\t\t\t})\n\n\t\t// enter the circles\n\t\tconst circles = svg.selectAll('circle.node').data(nodeData)\n\n\t\tcircles.exit().attr('width', 0).attr('height', 0).remove()\n\n\t\tconst enteringCircles = circles.enter().append('circle').classed('node', true)\n\n\t\tenteringCircles\n\t\t\t.merge(circles as any)\n\t\t\t.attr('class', (d: any) => {\n\t\t\t\tconst originalClass = canvasZoomEnabled && hierarchyLevel === 3 ? this.getZoomClass(d) : ''\n\t\t\t\treturn this.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\tdataGroupName: d.data.dataGroupName,\n\t\t\t\t\toriginalClassName: d.children\n\t\t\t\t\t\t? `node ${originalClass}`\n\t\t\t\t\t\t: `node node-leaf ${originalClass}`\n\t\t\t\t})\n\t\t\t})\n\t\t\t.style('fill', (d: any) => this.model.getFillColor(d.data.dataGroupName, null, d.data))\n\t\t\t.style('stroke', (d: any) => this.model.getFillColor(d.data.dataGroupName, null, d.data))\n\t\t\t.attr('cx', (d: any) => d.x)\n\t\t\t.attr('cy', (d: any) => d.y)\n\t\t\t.transition('circlepack-leaf-update-enter')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'circlepack-leaf-update-enter'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('r', (d: any) => d.r)\n\t\t\t.attr('opacity', 1)\n\t\t\t.attr('fill-opacity', circlePackConfigs.circles.fillOpacity)\n\n\t\tif (canvasZoomEnabled === true && this.focal) {\n\t\t\tthis.services.canvasZoom.zoomIn(this.focal, enteringCircles, canvasZoomSettings)\n\t\t\tthis.setBackgroundListeners()\n\t\t}\n\n\t\tif (!parentNode) {\n\t\t\t// add legend filtering if it isnt a monochrome chart\n\t\t\tthis.addLegendListeners()\n\t\t}\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\t// turn off the highlight class on children circles\n\tunhighlightChildren(childData: any) {\n\t\tconst data = childData.map((d: any) => d.data)\n\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.filter((d: any) => data.some((datum: any) => datum === d.data) && d.depth > 1)\n\t\t\t.style('stroke', (d: any) => this.model.getFillColor(d.data.dataGroupName, null, d.data))\n\t}\n\n\t// highlight the children circles with a stroke\n\thighlightChildren(childData: any) {\n\t\tconst data = childData.map((d: any) => d.data)\n\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.filter((d: any) => data.some((datum: any) => datum === d.data) && d.depth > 1)\n\t\t\t.style('stroke', circlePackConfigs.circles.hover.stroke)\n\t}\n\n\tgetZoomClass(node: any) {\n\t\tif ((this.model as CirclePackChartModel).getHierarchyLevel() === 3 && this.focal) {\n\t\t\tif (\n\t\t\t\tnode.data === this.focal.data ||\n\t\t\t\tthis.focal.children.some((d: any) => d.data === node.data)\n\t\t\t) {\n\t\t\t\treturn 'focal'\n\t\t\t}\n\t\t}\n\t\treturn 'non-focal'\n\t}\n\n\taddLegendListeners() {\n\t\tconst { events } = this.services\n\t\t// Highlight correct circle on legend item hovers\n\t\tevents.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\t// Un-highlight circles on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\tremoveBackgroundListeners() {\n\t\tconst chartSvg = select(this.services.domUtils.getMainContainer())\n\t\tchartSvg.on('click', () => null)\n\t}\n\n\tsetBackgroundListeners() {\n\t\tconst chartSvg = select(this.services.domUtils.getMainContainer())\n\t\tconst self = this\n\t\tconst canvasSelection = this.parent.selectAll('circle.node')\n\n\t\tchartSvg.on('click', () => {\n\t\t\tself.focal = null as any\n\t\t\t;(self.model as CirclePackChartModel).updateHierarchyLevel(2)\n\t\t\tchartSvg.classed('zoomed-in', false)\n\t\t\tself.services.canvasZoom.zoomOut(canvasSelection, canvasZoomSettings)\n\t\t})\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.transition('legend-hover-circlepack')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-circlepack'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => {\n\t\t\t\treturn d.data.dataGroupName === hoveredElement.datum()['name']\n\t\t\t\t\t? 1\n\t\t\t\t\t: circlePackConfigs.circles.fillOpacity\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.transition('legend-mouseout-circlepack')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-circlepack'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\t// Zoom icon to be appended to the label in the tooltip\n\tgetZoomIcon() {\n\t\treturn `\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10 10\">\n\t\t\t<polygon points=\"5.93 3.71 4.45 3.71 4.45 2.23 3.71 2.23 3.71 3.71 2.23 3.71 2.23 4.45 3.71 4.45 3.71 5.93 4.45 5.93 4.45 4.45 5.93 4.45 5.93 3.71\"/>\n\t\t\t<path d=\"M7.2,6.67a4,4,0,0,0,1-2.59A4.08,4.08,0,1,0,4.07,8.15h0a4,4,0,0,0,2.59-1L9.48,10,10,9.48Zm-3.12.77A3.34,3.34,0,1,1,7.41,4.08,3.34,3.34,0,0,1,4.08,7.44Z\"/>\n\t\t</svg>`\n\t}\n\n\t// add event listeners for tooltip on the circles\n\taddEventListeners() {\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\tconst hierarchyLevel = (self.model as CirclePackChartModel).getHierarchyLevel()\n\t\t\t\tconst disabled = hierarchyLevel > 2 && !hoveredElement.classed('focal')\n\t\t\t\tconst canvasZoomEnabled = getProperty(self.model.getOptions(), 'canvasZoom', 'enabled')\n\n\t\t\t\tlet zoomable = false\n\t\t\t\tif (!disabled) {\n\t\t\t\t\t// get the children data for the tooltip\n\t\t\t\t\tlet childrenData = []\n\t\t\t\t\tlet totalValue: any[] = []\n\t\t\t\t\tlet parentValue = null\n\t\t\t\t\tif (datum.children) {\n\t\t\t\t\t\tif (datum.depth > 1 && canvasZoomEnabled) {\n\t\t\t\t\t\t\tzoomable = true\n\t\t\t\t\t\t\thoveredElement.classed('clickable', true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchildrenData = datum.children.map((child: any) => {\n\t\t\t\t\t\t\tif (child !== null) {\n\t\t\t\t\t\t\t\t// retrieve the children values if there are any 3rd level\n\t\t\t\t\t\t\t\tif (typeof child.data.value === 'number') {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tlabel: child.data.name,\n\t\t\t\t\t\t\t\t\t\tvalue: child.data.value\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tlabel: child.data.name,\n\t\t\t\t\t\t\t\t\t\tlabelIcon: canvasZoomEnabled && hierarchyLevel <= 2 ? self.getZoomIcon() : null,\n\t\t\t\t\t\t\t\t\t\tvalue: child.value\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tconst options = self.model.getOptions()\n\t\t\t\t\t\ttotalValue = [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\t\tget(options, 'locale.translations.total') ||\n\t\t\t\t\t\t\t\t\tget(options, 'tooltip.totalLabel') ||\n\t\t\t\t\t\t\t\t\t'Total',\n\t\t\t\t\t\t\t\tvalue: datum.value,\n\t\t\t\t\t\t\t\tbold: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t\t// children get a highlight stroke\n\t\t\t\t\t\tself.highlightChildren(datum.children)\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// if there is no children we want to display the value for the data\n\t\t\t\t\t\tparentValue = datum.value\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fillColor = getComputedStyle(this as Element, null).getPropertyValue('fill')\n\n\t\t\t\t\t// Show tooltip\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\t\t\t\tlabel: datum.data.name,\n\t\t\t\t\t\t\t\tlabelIcon:\n\t\t\t\t\t\t\t\t\tzoomable && canvasZoomEnabled && hierarchyLevel <= 2 ? self.getZoomIcon() : null,\n\t\t\t\t\t\t\t\tvalue: parentValue\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...childrenData,\n\t\t\t\t\t\t\t...totalValue\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.CirclePack.CIRCLE_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.CirclePack.CIRCLE_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\tif (datum.children) {\n\t\t\t\t\tself.unhighlightChildren(datum.children)\n\t\t\t\t}\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.CirclePack.CIRCLE_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tconst disabled = hoveredElement.classed('non-focal')\n\n\t\t\t\tconst canvasZoomEnabled = getProperty(self.model.getOptions(), 'canvasZoom', 'enabled')\n\n\t\t\t\tif (canvasZoomEnabled && (self.model as CirclePackChartModel).getHierarchyLevel() > 2) {\n\t\t\t\t\tconst canvasSelection = self.parent.selectAll('circle.node')\n\t\t\t\t\tconst chartSvg = select(self.services.domUtils.getMainContainer())\n\t\t\t\t\tchartSvg.classed('zoomed-in', false)\n\t\t\t\t\tself.focal = null as any\n\t\t\t\t\t;(self.model as CirclePackChartModel).updateHierarchyLevel(2)\n\t\t\t\t\tself.services.canvasZoom.zoomOut(canvasSelection, canvasZoomSettings)\n\t\t\t\t}\n\t\t\t\t// zoom if chart has zoom enabled and if its a depth 2 circle that has children\n\t\t\t\telse if (datum.depth === 2 && datum.children && !disabled && canvasZoomEnabled) {\n\t\t\t\t\tconst canvasSelection = self.parent.selectAll('circle.node')\n\t\t\t\t\tconst chartSvg = select(self.services.domUtils.getMainContainer())\n\t\t\t\t\tchartSvg.classed('zoomed-in', true)\n\t\t\t\t\tself.focal = datum as any\n\t\t\t\t\t;(self.model as CirclePackChartModel).updateHierarchyLevel(3)\n\t\t\t\t\tself.services.canvasZoom.zoomIn(datum, canvasSelection, canvasZoomSettings)\n\t\t\t\t\t// don't want the click event to propagate to the background zoom out\n\t\t\t\t\t// does not clash with the tooltip/other events because it does need to close the\n\t\t\t\t\t// tooltip on the click event in order to zoom in/out\n\t\t\t\t\tevent.stopPropagation()\n\t\t\t\t}\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.CirclePack.CIRCLE_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('circle.node')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\t\t\t.on('click', null)\n\n\t\t// remove the listeners on the legend\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\n\t\tthis.removeBackgroundListeners()\n\t}\n}\n","import { arc, interpolate, pie, select } from 'd3'\nimport { delay } from 'lodash-es'\nimport { convertValueToPercentage, getProperty } from '@/tools'\nimport { pie as pieConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport {\n\tCalloutDirections,\n\tEvents,\n\tAlignments,\n\tColorClassNameTypes,\n\tRenderTypes\n} from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\n// Pie slice tween function\nfunction arcTween(a: any, arcFunc: any) {\n\tconst i = interpolate(this._current, a)\n\n\treturn (t: any) => {\n\t\tthis._current = i(t)\n\t\treturn arcFunc(this._current)\n\t}\n}\n\nexport class Pie extends Component {\n\ttype = 'pie'\n\trenderType = RenderTypes.SVG\n\tisRendering = false\n\n\t// We need to store our arcs\n\t// So that addEventListeners()\n\t// Can access them\n\tarc: any\n\thoverArc: any\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\tgetInnerRadius() {\n\t\treturn pieConfigs.innerRadius\n\t}\n\n\trender(animate = true) {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer()\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst { valueMapsTo } = options.pie\n\n\t\tthis.isRendering = true\n\n\t\t// remove any slices that are valued at 0 because they dont need to be rendered and will create extra padding\n\t\tconst displayData = this.model.getDisplayData().filter((data: any) => data[valueMapsTo] > 0)\n\n\t\t// Compute the outer radius needed\n\t\tconst radius = this.computeRadius()\n\n\t\tthis.arc = arc().innerRadius(this.getInnerRadius()).outerRadius(radius)\n\n\t\t// Set the hover arc radius\n\t\tthis.hoverArc = arc()\n\t\t\t.innerRadius(this.getInnerRadius())\n\t\t\t.outerRadius(radius + pieConfigs.hoverArc.outerRadiusOffset)\n\n\t\t// Setup the pie layout\n\t\tconst pieLayout = pie()\n\t\t\t.value((d: any) => d[valueMapsTo])\n\t\t\t.sort(getProperty(options, 'pie', 'sortFunction'))\n\t\t\t.padAngle(pieConfigs.padAngle)\n\n\t\t// Add data to pie layout\n\t\tconst pieLayoutData = pieLayout(displayData)\n\n\t\t// Update data on all slices\n\t\tconst slicesGroup = DOMUtils.appendOrSelect(svg, 'g.slices')\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('data-name', 'slices')\n\n\t\tconst paths = slicesGroup\n\t\t\t.selectAll('path.slice')\n\t\t\t.data(pieLayoutData, (d: any) => d.data[groupMapsTo])\n\n\t\t// Remove slices that need to be exited\n\t\tpaths.exit().attr('opacity', 0).remove()\n\n\t\t// Add new slices that are being introduced\n\t\tconst enteringPaths = paths.enter().append('path').classed('slice', true).attr('opacity', 0)\n\n\t\t// Update styles & position on existing and entering slices\n\t\tconst allPaths = enteringPaths\n\t\t\t.merge(paths as any)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d.data[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'slice'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => self.model.getFillColor(d.data[groupMapsTo], null, d.data))\n\t\t\t.attr('d', this.arc)\n\n\t\tallPaths\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'pie_slice_enter_update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'slice')\n\t\t\t.attr(\n\t\t\t\t'aria-label',\n\t\t\t\t(d: any) =>\n\t\t\t\t\t`${d[valueMapsTo]}, ${\n\t\t\t\t\t\tconvertValueToPercentage(d.data[valueMapsTo], displayData, valueMapsTo) + '%'\n\t\t\t\t\t}`\n\t\t\t)\n\t\t\t// Tween\n\t\t\t.attrTween('d', function (a: any) {\n\t\t\t\treturn arcTween.bind(this)(a, self.arc)\n\t\t\t})\n\t\t\t.on('end', () => {\n\t\t\t\tself.isRendering = false\n\t\t\t})\n\n\t\t// Draw the slice labels\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\tconst renderLabels = options.pie.labels.enabled\n\t\tconst labelData = renderLabels\n\t\t\t? pieLayoutData.filter(x => (x.data as any)[valueMapsTo] > 0)\n\t\t\t: []\n\t\tconst labelsGroup = DOMUtils.appendOrSelect(svg, 'g.labels')\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('data-name', 'labels')\n\n\t\tconst labels = labelsGroup\n\t\t\t.selectAll('text.pie-label')\n\t\t\t.data(labelData, (d: any) => d.data[groupMapsTo])\n\n\t\t// Remove labels that are existing\n\t\tlabels.exit().attr('opacity', 0).remove()\n\n\t\t// Add labels that are being introduced\n\t\tconst enteringLabels = labels.enter().append('text').classed('pie-label', true)\n\n\t\t// Update styles & position on existing & entering labels\n\t\tconst calloutData: any[] = []\n\t\tenteringLabels\n\t\t\t.merge(labels as any)\n\t\t\t.style('text-anchor', 'middle')\n\t\t\t.text((d: any) => {\n\t\t\t\tif (options.pie.labels.formatter) {\n\t\t\t\t\treturn options.pie.labels.formatter({\n\t\t\t\t\t\t...d,\n\t\t\t\t\t\tpercentageValue: convertValueToPercentage(\n\t\t\t\t\t\t\td.data[valueMapsTo],\n\t\t\t\t\t\t\tdisplayData,\n\t\t\t\t\t\t\tvalueMapsTo,\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn (\n\t\t\t\t\tnumberFormatter(\n\t\t\t\t\t\tconvertValueToPercentage(d.data[valueMapsTo], displayData, valueMapsTo),\n\t\t\t\t\t\tlocaleCode\n\t\t\t\t\t) + '%'\n\t\t\t\t)\n\t\t\t})\n\t\t\t// Calculate dimensions in order to transform\n\t\t\t.datum(function (d: any) {\n\t\t\t\tconst marginedRadius = radius + 7\n\n\t\t\t\tconst theta = (d.endAngle - d.startAngle) / 2 + d.startAngle\n\t\t\t\tconst deg = (theta / Math.PI) * 180\n\n\t\t\t\tconst textLength = this.getComputedTextLength()\n\t\t\t\td.textOffsetX = textLength / 2\n\t\t\t\td.textOffsetY = deg > 90 && deg < 270 ? 10 : 0\n\n\t\t\t\td.xPosition = (d.textOffsetX + marginedRadius) * Math.sin(theta)\n\t\t\t\td.yPosition = (d.textOffsetY + marginedRadius) * -Math.cos(theta)\n\n\t\t\t\treturn d\n\t\t\t})\n\t\t\t.attr('transform', function (d: any, i: number) {\n\t\t\t\tconst totalSlices = labelData.length\n\t\t\t\tconst sliceAngleDeg = (d.endAngle - d.startAngle) * (180 / Math.PI)\n\n\t\t\t\t// check if last 2 slices (or just last) are < the threshold\n\t\t\t\tif (i >= totalSlices - 2) {\n\t\t\t\t\tif (sliceAngleDeg < pieConfigs.callout.minSliceDegree) {\n\t\t\t\t\t\tlet labelTranslateX, labelTranslateY\n\t\t\t\t\t\tif (d.index === totalSlices - 1) {\n\t\t\t\t\t\t\tlabelTranslateX =\n\t\t\t\t\t\t\t\td.xPosition +\n\t\t\t\t\t\t\t\tpieConfigs.callout.offsetX +\n\t\t\t\t\t\t\t\tpieConfigs.callout.textMargin +\n\t\t\t\t\t\t\t\td.textOffsetX\n\t\t\t\t\t\t\tlabelTranslateY = d.yPosition - pieConfigs.callout.offsetY\n\n\t\t\t\t\t\t\t// Set direction of callout\n\t\t\t\t\t\t\td.direction = CalloutDirections.RIGHT\n\t\t\t\t\t\t\tcalloutData.push(d)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlabelTranslateX =\n\t\t\t\t\t\t\t\td.xPosition -\n\t\t\t\t\t\t\t\tpieConfigs.callout.offsetX -\n\t\t\t\t\t\t\t\td.textOffsetX -\n\t\t\t\t\t\t\t\tpieConfigs.callout.textMargin\n\t\t\t\t\t\t\tlabelTranslateY = d.yPosition - pieConfigs.callout.offsetY\n\n\t\t\t\t\t\t\t// Set direction of callout\n\t\t\t\t\t\t\td.direction = CalloutDirections.LEFT\n\t\t\t\t\t\t\tcalloutData.push(d)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn `translate(${labelTranslateX}, ${labelTranslateY})`\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn `translate(${d.xPosition}, ${d.yPosition})`\n\t\t\t})\n\n\t\t// Render pie label callouts\n\t\tthis.renderCallouts(calloutData)\n\n\t\tconst optionName = getProperty(options, 'donut') ? 'donut' : 'pie'\n\t\tconst alignment = getProperty(options, optionName, 'alignment')\n\n\t\tconst { width } = DOMUtils.getSVGElementSize(this.getParent() as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// don't add padding for labels & callouts if they are disabled\n\t\tconst xOffset = renderLabels ? pieConfigs.xOffset : 0\n\t\tconst yOffset = renderLabels ? pieConfigs.yOffset : 0\n\n\t\t// Position Pie\n\t\tlet pieTranslateX = radius + xOffset\n\t\tif (alignment === Alignments.CENTER) {\n\t\t\tpieTranslateX = width / 2\n\t\t} else if (alignment === Alignments.RIGHT) {\n\t\t\tpieTranslateX = width - radius - pieConfigs.xOffset\n\t\t}\n\n\t\tlet pieTranslateY = radius + yOffset\n\t\tif (calloutData.length > 0) {\n\t\t\tpieTranslateY += pieConfigs.yOffsetCallout\n\t\t}\n\n\t\tsvg.attr('x', pieTranslateX + 7).attr('y', pieTranslateY)\n\n\t\t// Add event listeners\n\t\tthis.addEventListeners()\n\t}\n\n\trenderCallouts(calloutData: any[]) {\n\t\tconst svg = DOMUtils.appendOrSelect(this.getComponentContainer(), 'g.callouts')\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('data-name', 'callouts')\n\n\t\t// Update data on callouts\n\t\tconst callouts = svg.selectAll('g.callout').data(calloutData)\n\n\t\tcallouts.exit().remove()\n\n\t\tconst enteringCallouts = callouts\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.classed('callout', true)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('aria-roledescription', 'label callout')\n\n\t\t// Update data values for each callout\n\t\t// For the horizontal and vertical lines to use\n\t\tenteringCallouts.merge(callouts as any).datum(function (d: any) {\n\t\t\tconst { xPosition, yPosition, direction } = d\n\n\t\t\tif (direction === CalloutDirections.RIGHT) {\n\t\t\t\td.startPos = {\n\t\t\t\t\tx: xPosition,\n\t\t\t\t\ty: yPosition + d.textOffsetY\n\t\t\t\t}\n\n\t\t\t\t// end position for the callout line\n\t\t\t\td.endPos = {\n\t\t\t\t\tx: xPosition + pieConfigs.callout.offsetX,\n\t\t\t\t\ty: yPosition - pieConfigs.callout.offsetY + d.textOffsetY\n\t\t\t\t}\n\n\t\t\t\t// the intersection point of the vertical and horizontal line\n\t\t\t\td.intersectPointX = d.endPos.x - pieConfigs.callout.horizontalLineLength\n\t\t\t} else {\n\t\t\t\t// start position for the callout line\n\t\t\t\td.startPos = {\n\t\t\t\t\tx: xPosition,\n\t\t\t\t\ty: yPosition + d.textOffsetY\n\t\t\t\t}\n\n\t\t\t\t// end position for the callout line should be bottom aligned to the title\n\t\t\t\td.endPos = {\n\t\t\t\t\tx: xPosition - pieConfigs.callout.offsetX,\n\t\t\t\t\ty: yPosition - pieConfigs.callout.offsetY + d.textOffsetY\n\t\t\t\t}\n\n\t\t\t\t// the intersection point of the vertical and horizontal line\n\t\t\t\td.intersectPointX = d.endPos.x + pieConfigs.callout.horizontalLineLength\n\t\t\t}\n\n\t\t\t// Store the necessary data in the DOM element\n\t\t\treturn d\n\t\t})\n\n\t\t// draw vertical line\n\t\tconst enteringVerticalLines = enteringCallouts.append('line').classed('vertical-line', true)\n\n\t\tenteringVerticalLines\n\t\t\t.merge(svg.selectAll('line.vertical-line'))\n\t\t\t.datum(function () {\n\t\t\t\treturn select(this.parentNode as any).datum()\n\t\t\t})\n\t\t\t.style('stroke-width', '1px')\n\t\t\t.attr('x1', (d: any) => d.startPos.x)\n\t\t\t.attr('y1', (d: any) => d.startPos.y)\n\t\t\t.attr('x2', (d: any) => d.intersectPointX)\n\t\t\t.attr('y2', (d: any) => d.endPos.y)\n\n\t\t// draw horizontal line\n\t\tconst enteringHorizontalLines = enteringCallouts.append('line').classed('horizontal-line', true)\n\n\t\tenteringHorizontalLines\n\t\t\t.merge(svg.selectAll('line.horizontal-line'))\n\t\t\t.datum(function () {\n\t\t\t\treturn select(this.parentNode as any).datum()\n\t\t\t})\n\t\t\t.style('stroke-width', '1px')\n\t\t\t.attr('x1', (d: any) => d.intersectPointX)\n\t\t\t.attr('y1', (d: any) => d.endPos.y)\n\t\t\t.attr('x2', (d: any) => d.endPos.x)\n\t\t\t.attr('y2', (d: any) => d.endPos.y)\n\t}\n\n\t// Highlight elements that match the hovered legend item\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.slice')\n\t\t\t.transition('legend-hover-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) =>\n\t\t\t\td.data[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1\n\t\t\t)\n\t}\n\n\t// Un-highlight all elements\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.slice')\n\t\t\t.transition('legend-mouseout-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\n\t\tthis.parent\n\t\t\t.selectAll('path.slice')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tif (!self.isRendering) {\n\t\t\t\t\thoveredElement\n\t\t\t\t\t\t.classed('hovered', true)\n\t\t\t\t\t\t.transition('pie_slice_mouseover')\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'pie_slice_mouseover'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('d', self.hoverArc)\n\t\t\t\t}\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Pie.SLICE_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tconst { groupMapsTo } = self.getOptions().data\n\t\t\t\tconst { valueMapsTo } = self.getOptions().pie\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: datum.data[groupMapsTo],\n\t\t\t\t\t\t\tvalue: datum.data[valueMapsTo]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Pie.SLICE_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Pie.SLICE_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tdelay(() => {\n\t\t\t\t\tif (!self.isRendering) {\n\t\t\t\t\t\thoveredElement\n\t\t\t\t\t\t\t.classed('hovered', false)\n\t\t\t\t\t\t\t.transition('pie_slice_mouseout')\n\t\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\t\tname: 'pie_slice_mouseout'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('d', self.arc)\n\t\t\t\t\t}\n\t\t\t\t}, 100)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Pie.SLICE_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\t// Helper functions\n\tprotected computeRadius() {\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst options = this.getOptions()\n\t\tconst radius: number = Math.min(width, height) / 2\n\t\tconst renderLabels = options.pie.labels.enabled\n\n\t\treturn renderLabels ? radius + pieConfigs.radiusOffset : radius\n\t}\n}\n","import { interpolateNumber, interpolateRound, select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { Pie } from './pie'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { RenderTypes } from '@/interfaces/enums'\n\nexport class Donut extends Pie {\n\ttype = 'donut'\n\trenderType = RenderTypes.SVG\n\n\trender(animate = true) {\n\t\t// Call render() from Pie\n\t\tsuper.render(animate)\n\n\t\tconst self = this\n\n\t\t// if there are no data, remove the center content\n\t\t// that is the old one and do nothing\n\t\tif (this.model.isDataEmpty()) {\n\t\t\tthis.getComponentContainer().select('g.center').remove()\n\t\t\treturn\n\t\t}\n\n\t\tconst svg = DOMUtils.appendOrSelect(this.getComponentContainer(), 'g.center')\n\t\tconst options = this.getOptions()\n\n\t\t// Compute the outer radius needed\n\t\tconst radius = this.computeRadius()\n\t\tconst donutTitle = getProperty(options, 'donut', 'center', 'label')\n\n\t\t// Add the number shown in the center of the donut\n\t\tDOMUtils.appendOrSelect(svg, 'text.donut-figure')\n\t\t\t.attr('text-anchor', 'middle')\n\t\t\t.style('dominant-baseline', () => {\n\t\t\t\t// Center figure if title is empty\n\t\t\t\tif (donutTitle === null || donutTitle === '') {\n\t\t\t\t\treturn 'central'\n\t\t\t\t}\n\n\t\t\t\treturn 'initial'\n\t\t\t})\n\t\t\t.style('font-size', () => options.donut.center.numberFontSize(radius))\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'donut-figure-enter-update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.tween('text', function () {\n\t\t\t\treturn self.centerNumberTween(select(this))\n\t\t\t})\n\n\t\t// Title will be rendered only if it isn't empty\n\t\tif (donutTitle !== null && donutTitle !== '') {\n\t\t\t// Add the label below the number in the center of the donut\n\t\t\tDOMUtils.appendOrSelect(svg, 'text.donut-title')\n\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t.style('font-size', () => options.donut.center.titleFontSize(radius))\n\t\t\t\t.attr('y', options.donut.center.titleYPosition(radius))\n\t\t\t\t.text(donutTitle)\n\t\t}\n\t}\n\n\tgetInnerRadius() {\n\t\t// Compute the outer radius needed\n\t\tconst radius = this.computeRadius()\n\n\t\treturn radius * (3 / 4)\n\t}\n\n\tcenterNumberTween(d3Ref: any) {\n\t\tconst options = this.getOptions()\n\n\t\tlet donutCenterFigure = getProperty(options, 'donut', 'center', 'number')\n\t\tif (donutCenterFigure === null) {\n\t\t\tdonutCenterFigure = this.model.getDisplayData().reduce((accumulator: number, d: any) => {\n\t\t\t\treturn accumulator + d[options.pie.valueMapsTo]\n\t\t\t}, 0)\n\t\t}\n\n\t\t// Remove commas from the current value string, and convert to an int\n\t\tconst currentValue = parseInt(d3Ref.text().replace(/[, ]+/g, ''), 10) || 0\n\n\t\tlet interpolateFunction\n\t\tif (currentValue % 1 === 0 && donutCenterFigure % 1 === 0) {\n\t\t\tinterpolateFunction = interpolateRound\n\t\t} else {\n\t\t\tinterpolateFunction = interpolateNumber\n\t\t}\n\n\t\tconst i = interpolateFunction(currentValue, donutCenterFigure)\n\n\t\treturn (t: any) => {\n\t\t\tconst { numberFormatter } = options.donut.center\n\t\t\tif (numberFormatter) {\n\t\t\t\td3Ref.text(numberFormatter(i(t)))\n\t\t\t} else {\n\t\t\t\tconst { code: localeCode, number: localeNumberFormatter } = getProperty(options, 'locale')\n\t\t\t\td3Ref.text(localeNumberFormatter(Math.floor(i(t)), localeCode))\n\t\t\t}\n\t\t}\n\t}\n}\n","import { arc, select } from 'd3'\nimport { clamp } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport {\n\tEvents,\n\tGaugeTypes,\n\tArrowDirections,\n\tColorClassNameTypes,\n\tAlignments,\n\tRenderTypes\n} from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\n// arrow paths for delta\nconst ARROW_UP_PATH_STRING = '4,10 8,6 12,10'\nconst ARROW_DOWN_PATH_STRING = '12,6 8,10 4,6'\n\nexport class Gauge extends Component {\n\ttype = 'gauge'\n\trenderType = RenderTypes.SVG\n\n\t// We need to store our arcs so that addEventListeners() can access them\n\tarc: any\n\tbackgroundArc: any\n\n\tgetValue(): number {\n\t\tconst data = this.model.getData()\n\t\tconst value = data.find((d: any) => d.group === 'value')?.value ?? null\n\t\treturn value\n\t}\n\n\tgetValueRatio(): number {\n\t\tconst value = clamp(this.getValue(), 0, 100)\n\t\treturn value / 100\n\t}\n\n\tgetDelta(): number {\n\t\tconst data = this.model.getData()\n\t\tconst delta = data.find((d: any) => d.group === 'delta')?.value ?? null\n\t\treturn delta\n\t}\n\n\tgetArcRatio(): number {\n\t\tconst options = this.getOptions()\n\t\tconst type = getProperty(options, 'gauge', 'type')\n\t\tconst arcRatio = type === GaugeTypes.FULL ? 1 : 0.5\n\t\treturn arcRatio\n\t}\n\n\tgetArcSize(): number {\n\t\treturn this.getArcRatio() * Math.PI * 2\n\t}\n\n\tgetStartAngle(): number {\n\t\tconst arcSize = this.getArcSize()\n\t\tif (arcSize === 2 * Math.PI) {\n\t\t\treturn 0\n\t\t}\n\t\treturn -arcSize / 2\n\t}\n\n\t// use provided arrow direction or default to using the delta\n\tgetArrow(delta: any): string {\n\t\tconst options = this.getOptions()\n\t\tconst arrowDirection = getProperty(options, 'gauge', 'deltaArrow', 'direction')\n\n\t\tswitch (arrowDirection) {\n\t\t\tcase ArrowDirections.UP:\n\t\t\t\treturn ARROW_UP_PATH_STRING\n\t\t\tcase ArrowDirections.DOWN:\n\t\t\t\treturn ARROW_DOWN_PATH_STRING\n\t\t\tdefault:\n\t\t\t\treturn delta > 0 ? ARROW_UP_PATH_STRING : ARROW_DOWN_PATH_STRING\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer().attr('width', '100%').attr('height', '100%')\n\t\tconst options = this.getOptions()\n\n\t\tconst value = this.getValue()\n\t\tconst valueRatio = this.getValueRatio()\n\t\tconst arcSize = this.getArcSize()\n\n\t\t// angles for drawing the gauge\n\t\tconst startAngle = this.getStartAngle()\n\t\tconst rotationAngle = valueRatio * arcSize\n\t\tconst currentAngle = startAngle + rotationAngle\n\t\tconst endAngle = startAngle + arcSize\n\n\t\t// Compute the outer radius needed\n\t\tconst radius = this.computeRadius()\n\t\tconst innerRadius = this.getInnerRadius()\n\n\t\t// draw the container and arc\n\t\tthis.backgroundArc = arc()\n\t\t\t.innerRadius(innerRadius)\n\t\t\t.outerRadius(radius)\n\t\t\t.startAngle(currentAngle)\n\t\t\t.endAngle(endAngle)\n\n\t\tthis.arc = arc()\n\t\t\t.innerRadius(innerRadius)\n\t\t\t.outerRadius(radius)\n\t\t\t.startAngle(startAngle)\n\t\t\t.endAngle(currentAngle)\n\n\t\t// draw the container\n\t\tDOMUtils.appendOrSelect(svg, 'path.arc-background').attr('d', this.backgroundArc)\n\n\t\t// Add data arc\n\t\tconst arcValue = svg.selectAll('path.arc-foreground').data([value])\n\t\tconst arcEnter = arcValue.enter().append('path')\n\n\t\tarcEnter\n\t\t\t.merge(arcValue as any)\n\t\t\t.attr(\n\t\t\t\t'class',\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: 'value',\n\t\t\t\t\toriginalClassName: 'arc-foreground'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', () => getProperty(this.getOptions(), 'color', 'scale', 'value'))\n\t\t\t.attr('d', this.arc)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'value')\n\t\t\t.attr('aria-label', (d: any) => d)\n\n\t\t// draw the value and delta to the center\n\t\tthis.drawValueNumber()\n\t\tthis.drawDelta()\n\n\t\tarcValue.exit().remove()\n\n\t\tconst alignment = getProperty(options, 'gauge', 'alignment')\n\n\t\tconst { width } = DOMUtils.getSVGElementSize(this.getParent() as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// Position gauge\n\t\tlet gaugeTranslateX = radius\n\t\tif (alignment === Alignments.CENTER) {\n\t\t\tgaugeTranslateX = width / 2\n\t\t} else if (alignment === Alignments.RIGHT) {\n\t\t\tgaugeTranslateX = width - radius\n\t\t}\n\t\tsvg.attr('x', gaugeTranslateX).attr('y', radius)\n\n\t\t// Add event listeners\n\t\tthis.addEventListeners()\n\t}\n\n\t/**\n\t * draws the value number associated with the Gauge component in the center\n\t */\n\tdrawValueNumber() {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\n\t\tconst arcType = getProperty(options, 'gauge', 'type')\n\t\tconst value = this.getValue()\n\t\tconst delta = this.getDelta()\n\n\t\t// Sizing and positions relative to the radius\n\t\tconst radius = this.computeRadius()\n\n\t\tconst valueFontSize = getProperty(options, 'gauge', 'valueFontSize')\n\t\t// if there is a delta, use the size to center the numbers, otherwise center the valueNumber\n\t\tconst deltaFontSize = getProperty(options, 'gauge', 'deltaFontSize')\n\n\t\tconst numberSpacing = getProperty(options, 'gauge', 'numberSpacing')\n\n\t\tconst showPercentageSymbol = getProperty(options, 'gauge', 'showPercentageSymbol')\n\n\t\t// circular gauge without delta should have valueNumber centered\n\t\tlet numbersYPosition = 0\n\t\tif (arcType === GaugeTypes.FULL && !delta) {\n\t\t\tnumbersYPosition = deltaFontSize(radius)\n\t\t} else if (arcType === GaugeTypes.SEMI && delta) {\n\t\t\t// semi circular gauge we want the numbers aligned to the chart container\n\t\t\tnumbersYPosition = -(deltaFontSize(radius) + numberSpacing)\n\t\t}\n\n\t\t// Add the numbers at the center\n\t\tconst numbersGroup = DOMUtils.appendOrSelect(svg, 'g.gauge-numbers').attr(\n\t\t\t'transform',\n\t\t\t`translate(0, ${numbersYPosition})`\n\t\t)\n\n\t\tconst fontSize = valueFontSize(radius)\n\t\t// Add the big number\n\t\tconst valueNumberGroup = DOMUtils.appendOrSelect(numbersGroup, 'g.gauge-value-number')\n\t\tconst { code: localeCode, number: localeNumberFormatter } = getProperty(options, 'locale')\n\t\tconst numberFormatter = getProperty(options, 'gauge', 'numberFormatter')\n\t\tconst valueNumber = valueNumberGroup.selectAll('text.gauge-value-number').data([value])\n\n\t\tvalueNumber\n\t\t\t.enter()\n\t\t\t.append('text')\n\t\t\t.attr('class', 'gauge-value-number')\n\t\t\t.merge(valueNumber as any)\n\t\t\t.style('font-size', `${fontSize}px`)\n\t\t\t.attr('text-anchor', 'middle')\n\t\t\t.text((d: any) => {\n\t\t\t\tlet value\n\t\t\t\tif (d !== null && d !== undefined) {\n\t\t\t\t\tvalue = Number(d.toFixed(2)) % 1 !== 0 ? d.toFixed(2) : d.toFixed()\n\t\t\t\t} else {\n\t\t\t\t\tvalue = 0\n\t\t\t\t}\n\t\t\t\tif (numberFormatter) {\n\t\t\t\t\treturn numberFormatter(value)\n\t\t\t\t} else {\n\t\t\t\t\treturn localeNumberFormatter(Number(value), localeCode)\n\t\t\t\t}\n\t\t\t})\n\n\t\t// add the percentage symbol beside the valueNumber\n\t\tconst { width: valueNumberWidth } = DOMUtils.getSVGElementSize(\n\t\t\tDOMUtils.appendOrSelect(svg, 'text.gauge-value-number'),\n\t\t\t{ useBBox: true }\n\t\t)\n\n\t\tconst symbolFontSize = fontSize / 2\n\t\tconst gaugeSymbol = showPercentageSymbol ? '%' : ''\n\t\tconst symbol = DOMUtils.appendOrSelect(valueNumberGroup, 'text.gauge-value-symbol')\n\t\t\t.style('font-size', `${symbolFontSize}px`)\n\t\t\t.attr('x', valueNumberWidth / 2)\n\t\t\t.text(gaugeSymbol)\n\n\t\tconst { width: symbolWidth, height: symbolHeight } = DOMUtils.getSVGElementSize(symbol, {\n\t\t\tuseBBox: true\n\t\t})\n\n\t\t// adjust the symbol to superscript using the bbox instead of the font-size cause\n\t\t// we want to align the actual character to the value number\n\t\tsymbol.attr('y', `-${symbolHeight / 2}px`)\n\n\t\t// move the value group depending on the symbol's drawn size\n\t\tvalueNumberGroup.attr('transform', `translate(-${symbolWidth / 2}, 0)`) // Optical centering for the presence of the smaller % symbol\n\t}\n\n\t/**\n\t * adds the delta number for the gauge\n\t */\n\tdrawDelta() {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\t\tconst delta = this.getDelta()\n\t\tconst { code: localeCode, number: localeNumberFormatter } = getProperty(options, 'locale')\n\t\tif (!delta) {\n\t\t\tconst deltaGroup = svg.select('g.gauge-delta')\n\n\t\t\tif (!deltaGroup.empty()) {\n\t\t\t\tdeltaGroup.remove()\n\t\t\t}\n\t\t} else {\n\t\t\t// Sizing and positions relative to the radius\n\t\t\tconst radius = this.computeRadius()\n\t\t\tconst deltaFontSize = delta ? getProperty(options, 'gauge', 'deltaFontSize') : () => 0\n\n\t\t\t// use numberFormatter here only if there is a delta supplied\n\t\t\tconst numberFormatter = delta\n\t\t\t\t? getProperty(options, 'gauge', 'numberFormatter')\n\t\t\t\t: (): any => null\n\n\t\t\tconst arrowSize = getProperty(options, 'gauge', 'deltaArrow', 'size')\n\t\t\tconst numberSpacing = getProperty(options, 'gauge', 'numberSpacing')\n\n\t\t\tconst showPercentageSymbol = getProperty(options, 'gauge', 'showPercentageSymbol')\n\n\t\t\tconst numbersGroup = DOMUtils.appendOrSelect(svg, 'g.gauge-numbers')\n\n\t\t\t// Add the smaller number of the delta\n\t\t\tconst deltaGroup = DOMUtils.appendOrSelect(numbersGroup, 'g.gauge-delta').attr(\n\t\t\t\t'transform',\n\t\t\t\t`translate(0, ${deltaFontSize(radius) + numberSpacing})`\n\t\t\t)\n\n\t\t\tconst deltaNumber = DOMUtils.appendOrSelect(deltaGroup, 'text.gauge-delta-number')\n\t\t\tconst gaugeSymbol = showPercentageSymbol ? '%' : ''\n\n\t\t\tdeltaNumber.data(delta === null ? [] : [delta])\n\n\t\t\tdeltaNumber\n\t\t\t\t.enter()\n\t\t\t\t.append('text')\n\t\t\t\t.classed('gauge-delta-number', true)\n\t\t\t\t.merge(deltaNumber)\n\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t.style('font-size', `${deltaFontSize(radius)}px`)\n\t\t\t\t.text((d: any) => {\n\t\t\t\t\tlet value\n\t\t\t\t\tif (d !== null && d !== undefined) {\n\t\t\t\t\t\tvalue = Number(d.toFixed(2)) % 1 !== 0 ? d.toFixed(2) : d.toFixed()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = 0\n\t\t\t\t\t}\n\t\t\t\t\tif (numberFormatter) {\n\t\t\t\t\t\treturn `${numberFormatter(value)}${gaugeSymbol}`\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn `${localeNumberFormatter(Number(value), localeCode)}${gaugeSymbol}`\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t// Add the caret for the delta number\n\t\t\tconst { width: deltaNumberWidth } = DOMUtils.getSVGElementSize(\n\t\t\t\tDOMUtils.appendOrSelect(svg, '.gauge-delta-number'),\n\t\t\t\t{ useBBox: true }\n\t\t\t)\n\n\t\t\t// check if delta arrow is disabled\n\t\t\tconst arrowEnabled = getProperty(options, 'gauge', 'deltaArrow', 'enabled')\n\n\t\t\tconst deltaArrow = deltaGroup\n\t\t\t\t.selectAll('svg.gauge-delta-arrow')\n\t\t\t\t.data(delta !== null && arrowEnabled ? [delta] : [])\n\n\t\t\tdeltaArrow\n\t\t\t\t.enter()\n\t\t\t\t.append('svg')\n\t\t\t\t.merge(deltaArrow as any)\n\t\t\t\t.attr('class', 'gauge-delta-arrow')\n\t\t\t\t.attr('x', -arrowSize(radius) - deltaNumberWidth / 2)\n\t\t\t\t.attr('y', -arrowSize(radius) / 2 - deltaFontSize(radius) * 0.35)\n\t\t\t\t.attr('width', arrowSize(radius))\n\t\t\t\t.attr('height', arrowSize(radius))\n\t\t\t\t.attr('viewBox', '0 0 16 16')\n\t\t\t\t/*\n\t\t\t\t * using .each() here to ensure that the below function runs\n\t\t\t\t * after svg.gauge-delta-arrow has been mounted onto the DOM\n\t\t\t\t */\n\t\t\t\t.each(function () {\n\t\t\t\t\tconst deltaArrowSelection = select(this)\n\n\t\t\t\t\t// Needed to correctly size SVG in Firefox\n\t\t\t\t\tDOMUtils.appendOrSelect(deltaArrowSelection, 'rect.gauge-delta-arrow-backdrop')\n\t\t\t\t\t\t.attr('width', '16')\n\t\t\t\t\t\t.attr('height', '16')\n\t\t\t\t\t\t.attr('fill', 'none')\n\n\t\t\t\t\t// Draw the arrow with status\n\t\t\t\t\tconst status = getProperty(options, 'gauge', 'status')\n\t\t\t\t\tDOMUtils.appendOrSelect(deltaArrowSelection, 'polygon.gauge-delta-arrow')\n\t\t\t\t\t\t.attr('class', status !== null ? `gauge-delta-arrow status--${status}` : '')\n\t\t\t\t\t\t.attr('points', self.getArrow(delta))\n\t\t\t\t})\n\n\t\t\tdeltaArrow.exit().remove()\n\t\t\tdeltaNumber.exit().remove()\n\t\t}\n\t}\n\n\tgetInnerRadius() {\n\t\t// Compute the outer radius needed\n\t\tconst radius = this.computeRadius()\n\t\tconst arcWidth = getProperty(this.getOptions(), 'gauge', 'arcWidth')\n\t\treturn radius - arcWidth\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('path.arc-foreground')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Gauge.ARC_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Gauge.ARC_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Gauge.ARC_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Gauge.ARC_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\t// Helper functions\n\tprotected computeRadius() {\n\t\tconst options = this.getOptions()\n\t\tconst arcType = getProperty(options, 'gauge', 'type')\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\t\tconst radius =\n\t\t\tarcType === GaugeTypes.SEMI ? Math.min(width / 2, height) : Math.min(width / 2, height / 2)\n\n\t\treturn radius\n\t}\n}\n","import { ScaleBand, scaleBand, select } from 'd3'\nimport { uniq } from 'lodash-es'\nimport { generateSVGPathString, getProperty } from '@/tools'\nimport { Bar } from './bar'\nimport { CartesianOrientations, ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class GroupedBar extends Bar {\n\ttype = 'grouped-bar'\n\trenderType = RenderTypes.SVG\n\n\tgroupScale: ScaleBand<any>\n\n\tpadding = 5\n\n\t// A factor to normalize padding between bars regardless of bar group density.\n\treadonly defaultStepFactor = 70\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\t// Chart options mixed with the internal configurations\n\t\tconst displayData = this.model.getDisplayData(this.configs.groups)\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\t// Get unique labels\n\t\tthis.setGroupScale()\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst allDataLabels = uniq(\n\t\t\tdisplayData.map((datum: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(datum)\n\n\t\t\t\treturn datum[domainIdentifier] && typeof datum[domainIdentifier].toString === 'function'\n\t\t\t\t\t? datum[domainIdentifier].toString()\n\t\t\t\t\t: datum[domainIdentifier]\n\t\t\t})\n\t\t)\n\n\t\t// Update data on bar groups\n\t\tconst barGroups = svg.selectAll('g.bars').data(allDataLabels, (label: string) => label)\n\n\t\t// Remove dot groups that need to be removed\n\t\tbarGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the bar groups that need to be introduced\n\t\tconst barGroupsEnter = barGroups\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.classed('bars', true)\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('data-name', 'bars')\n\n\t\t// Update data on all bars\n\t\tconst allBarGroups = barGroupsEnter.merge(barGroups as any)\n\n\t\tallBarGroups\n\t\t\t// Transition\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'bar-group-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('transform', (label: string) => {\n\t\t\t\tconst scaleValue = this.services.cartesianScales.getDomainValue(label)\n\t\t\t\tconst translateBy = scaleValue - this.getGroupWidth() / 2\n\n\t\t\t\tif (this.services.cartesianScales.getOrientation() === CartesianOrientations.VERTICAL) {\n\t\t\t\t\treturn `translate(${translateBy}, 0)`\n\t\t\t\t} else {\n\t\t\t\t\t// translate in the y direction for horizontal groups\n\t\t\t\t\treturn `translate(0, ${translateBy})`\n\t\t\t\t}\n\t\t\t})\n\n\t\tconst bars = allBarGroups.selectAll('path.bar').data(\n\t\t\t(label: string) => this.getDataCorrespondingToLabel(label),\n\t\t\t(d: any) => d[groupMapsTo]\n\t\t)\n\n\t\t// Remove bars that are no longer needed\n\t\tbars.exit().attr('opacity', 0).remove()\n\n\t\t// Add the bars that need to be introduced\n\t\tconst barsEnter = bars.enter().append('path').attr('opacity', 0)\n\n\t\t// code for vertical grouped bar charts\n\t\tbarsEnter\n\t\t\t.merge(bars as any)\n\t\t\t.classed('bar', true)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'bar-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\t/*\n\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t */\n\t\t\t\tconst startX = this.groupScale(d[groupMapsTo])\n\t\t\t\tconst barWidth = this.getBarWidth()\n\n\t\t\t\tconst x0 = startX\n\t\t\t\tconst x1 = startX + barWidth\n\t\t\t\tconst rangeAxis = this.services.cartesianScales.getRangeAxisPosition({ datum: d })\n\t\t\t\tconst lowerBound = this.services.cartesianScales.getDomainLowerBound(rangeAxis)\n\t\t\t\tconst y0 = this.services.cartesianScales.getValueThroughAxisPosition(rangeAxis, lowerBound)\n\t\t\t\tconst y1 = this.services.cartesianScales.getRangeValue(d)\n\n\t\t\t\t// don't show if part of bar is out of zoom domain - test zoom on bar pos, not group\n\t\t\t\tconst zoomx0 = this.services.cartesianScales.getDomainValue(d) - barWidth / 2\n\t\t\t\tconst zoomx1 = zoomx0 + barWidth\n\t\t\t\tif (this.isOutsideZoomedDomain(zoomx0, zoomx1)) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t)\n\t\t\t})\n\t\t\t.attr('opacity', 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'bar')\n\t\t\t.attr('aria-label', (d: any) => d.value)\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\t// Highlight elements that match the hovered legend item\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-hover-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\t// Un-highlight all elements\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-mouseout-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\tdata: [datum]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\tprotected getDataCorrespondingToLabel(label: string) {\n\t\tconst displayData = this.model.getDisplayData(this.configs.groups)\n\n\t\treturn displayData.filter((datum: any) => {\n\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(datum)\n\t\t\treturn datum[domainIdentifier].toString() === label\n\t\t})\n\t}\n\n\tprotected getGroupWidth() {\n\t\tconst activeData = this.model.getGroupedData(this.configs.groups)\n\t\tconst totalGroupPadding = this.getTotalGroupPadding()\n\n\t\treturn this.getBarWidth() * activeData.length + totalGroupPadding\n\t}\n\n\tprotected getDomainScaleStep() {\n\t\tconst domainScale =\n\t\t\tthis.services.cartesianScales.getDomainScale() as unknown as ScaleBand<string>\n\t\tconst activeData = this.model.getGroupedData(this.configs.groups)\n\n\t\tlet step = this.defaultStepFactor\n\t\tif (typeof (domainScale as any).step === 'function') {\n\t\t\tstep = domainScale.step()\n\t\t} else if (activeData.length > 0) {\n\t\t\t// as a fallback use distance between first bars of adjacent bar groups\n\t\t\tconst ref = activeData.find((d: any) => d.data?.length > 1)\n\t\t\tif (ref) {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(ref.data[0])\n\t\t\t\tstep = Math.abs(\n\t\t\t\t\tdomainScale(ref.data[1][domainIdentifier]) - domainScale(ref.data[0][domainIdentifier])\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\treturn step\n\t}\n\n\tprotected getTotalGroupPadding() {\n\t\tconst activeData = this.model.getGroupedData(this.configs.groups)\n\n\t\tif (activeData.length === 1) {\n\t\t\treturn 0\n\t\t}\n\n\t\tconst padding = Math.min(5, 5 * (this.getDomainScaleStep() / this.defaultStepFactor))\n\n\t\treturn padding * (activeData.length - 1)\n\t}\n\n\t// Gets the correct width for bars based on options & configurations\n\tprotected getBarWidth() {\n\t\tconst options = this.getOptions()\n\t\tconst providedWidth = getProperty(options, 'bars', 'width')\n\t\tconst providedMaxWidth = getProperty(options, 'bars', 'maxWidth')\n\n\t\t// If there's a provided width, compare with maxWidth and\n\t\t// Determine which to return\n\t\tif (providedWidth !== null) {\n\t\t\tif (providedMaxWidth === null || providedWidth <= providedMaxWidth) {\n\t\t\t\treturn providedWidth\n\t\t\t}\n\t\t}\n\n\t\tconst activeData = this.model.getGroupedData(this.configs.groups)\n\t\tconst numOfActiveDataGroups = activeData.length\n\t\tconst totalGroupPadding = this.getTotalGroupPadding()\n\n\t\treturn Math.min(\n\t\t\tprovidedMaxWidth,\n\t\t\t(this.getDomainScaleStep() - totalGroupPadding) / numOfActiveDataGroups\n\t\t)\n\t}\n\n\tprotected setGroupScale() {\n\t\tconst activeData = this.model.getActiveDataGroupNames(this.configs.groups)\n\n\t\tthis.groupScale = scaleBand().domain(activeData).rangeRound([0, this.getGroupWidth()])\n\t}\n}\n","import { min, select } from 'd3'\nimport { get } from 'lodash-es'\nimport { getProperty, getTransformOffsets } from '@/tools'\nimport { heatmap as heatmapConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { Events, RenderTypes, DividerStatus } from '@/interfaces/enums'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { HeatmapModel } from '@/model/heatmap'\n\nexport class Heatmap extends Component {\n\ttype = 'heatmap'\n\trenderType = RenderTypes.SVG\n\n\tprivate matrix: any = {}\n\tprivate xBandwidth = 0\n\tprivate yBandwidth = 0\n\tprivate translationUnits = {\n\t\tx: 0,\n\t\ty: 0\n\t}\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct cells on Axis item hovers\n\t\teventsFragment.addEventListener(Events.Axis.LABEL_MOUSEOVER, this.handleAxisOnHover)\n\n\t\t// Highlight correct cells on Axis item mouseouts\n\t\teventsFragment.addEventListener(Events.Axis.LABEL_MOUSEOUT, this.handleAxisMouseOut)\n\n\t\t// Highlight correct cells on Axis item focus\n\t\teventsFragment.addEventListener(Events.Axis.LABEL_FOCUS, this.handleAxisOnHover)\n\n\t\t// Highlight correct cells on Axis item  blur\n\t\teventsFragment.addEventListener(Events.Axis.LABEL_BLUR, this.handleAxisMouseOut)\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\t// Lower the chart so the axes are always visible\n\t\tsvg.lower()\n\n\t\tconst { cartesianScales } = this.services\n\t\tthis.matrix = (this.model as HeatmapModel).getMatrix()\n\n\t\tsvg.html('')\n\n\t\tif (getProperty(this.getOptions(), 'data', 'loading')) {\n\t\t\treturn\n\t\t}\n\n\t\t// determine x and y axis scale\n\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\tconst mainYScale = cartesianScales.getMainYScale()\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier()\n\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier()\n\n\t\t// Get unique axis values & create a matrix\n\t\tconst uniqueDomain = (this.model as HeatmapModel).getUniqueDomain()\n\t\tconst uniqueRange = (this.model as HeatmapModel).getUniqueRanges()\n\n\t\t// Get matrix in the form of an array to create a single heatmap group\n\t\tconst matrixArray = (this.model as HeatmapModel).getMatrixAsArray()\n\n\t\t// Get available chart area\n\t\tconst xRange = mainXScale.range()\n\t\tconst yRange = mainYScale.range()\n\n\t\t// Determine rectangle dimensions based on the number of unique domain and range\n\t\tthis.xBandwidth = Math.abs((xRange[1] - xRange[0]) / uniqueDomain.length)\n\t\tthis.yBandwidth = Math.abs((yRange[1] - yRange[0]) / uniqueRange.length)\n\n\t\tconst patternID = this.services.domUtils.generateElementIDString(`heatmap-pattern-stripes`)\n\n\t\t// Create a striped pattern for missing data\n\t\tsvg\n\t\t\t.append('defs')\n\t\t\t.append('pattern')\n\t\t\t.attr('id', patternID)\n\t\t\t.attr('width', 3)\n\t\t\t.attr('height', 3)\n\t\t\t.attr('patternUnits', 'userSpaceOnUse')\n\t\t\t.attr('patternTransform', 'rotate(45)')\n\t\t\t.append('rect')\n\t\t\t.classed('pattern-fill', true)\n\t\t\t.attr('width', 0.5)\n\t\t\t.attr('height', 8)\n\n\t\tconst rectangles = svg\n\t\t\t.selectAll()\n\t\t\t.data(matrixArray)\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.attr('class', (d: any) => `heat-${d.index}`)\n\t\t\t.classed('cell', true)\n\t\t\t.attr(\n\t\t\t\t'transform',\n\t\t\t\t(d: any) =>\n\t\t\t\t\t`translate(${mainXScale(d[domainIdentifier])}, ${mainYScale(d[rangeIdentifier])})`\n\t\t\t)\n\t\t\t.append('rect')\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tvalue: d.value,\n\t\t\t\t\toriginalClassName: `heat-${d.index}`\n\t\t\t\t})\n\t\t\t)\n\t\t\t.classed('heat', true)\n\t\t\t.classed('null-state', (d: any) => (d.index === -1 || d.value === null ? true : false))\n\t\t\t.attr('width', this.xBandwidth)\n\t\t\t.attr('height', this.yBandwidth)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\t// Check if a valid value exists\n\t\t\t\tif (d.index === -1 || d.value === null) {\n\t\t\t\t\treturn `url(#${patternID})`\n\t\t\t\t}\n\t\t\t\treturn this.model.getFillColor(Number(d.value), d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.attr('aria-label', (d: any) => d.value)\n\n\t\t// Cell highlight box\n\t\tthis.createOuterBox('g.cell-highlight', this.xBandwidth, this.yBandwidth)\n\t\t// Column highlight box\n\t\tthis.createOuterBox(\n\t\t\t'g.multi-cell.column-highlight',\n\t\t\tthis.xBandwidth,\n\t\t\tMath.abs(yRange[1] - yRange[0])\n\t\t)\n\t\t// Row highlight box\n\t\tthis.createOuterBox(\n\t\t\t'g.multi-cell.row-highlight',\n\t\t\tMath.abs(xRange[1] - xRange[0]),\n\t\t\tthis.yBandwidth\n\t\t)\n\n\t\tif (this.determineDividerStatus()) {\n\t\t\trectangles.style('stroke-width', '1px')\n\t\t\tthis.parent.select('g.cell-highlight').classed('cell-2', true)\n\t\t}\n\n\t\tthis.addEventListener()\n\t}\n\n\t/**\n\t * Generates a box using lines to create a hover effect\n\t * The lines have drop shadow in their respective direction\n\t * @param parentTag - tag name\n\t * @param xBandwidth - X length\n\t * @param yBandwidth - y length\n\t */\n\tprivate createOuterBox(parentTag: string, xBandwidth: number, yBandwidth: number) {\n\t\t// Create a highlighter in the parent component so the shadow and the lines do not get clipped\n\t\tconst highlight = DOMUtils.appendOrSelect(this.parent, parentTag)\n\t\t\t.classed('shadows', true)\n\t\t\t.classed('highlighter-hidden', true)\n\n\t\tDOMUtils.appendOrSelect(highlight, 'line.top')\n\t\t\t.attr('x1', -1)\n\t\t\t.attr('x2', xBandwidth + 1)\n\n\t\tDOMUtils.appendOrSelect(highlight, 'line.left')\n\t\t\t.attr('x1', 0)\n\t\t\t.attr('y1', -1)\n\t\t\t.attr('x2', 0)\n\t\t\t.attr('y2', yBandwidth + 1)\n\n\t\tDOMUtils.appendOrSelect(highlight, 'line.down')\n\t\t\t.attr('x1', -1)\n\t\t\t.attr('x2', xBandwidth + 1)\n\t\t\t.attr('y1', yBandwidth)\n\t\t\t.attr('y2', yBandwidth)\n\n\t\tDOMUtils.appendOrSelect(highlight, 'line.right')\n\t\t\t.attr('x1', xBandwidth)\n\t\t\t.attr('x2', xBandwidth)\n\t\t\t.attr('y1', -1)\n\t\t\t.attr('y2', yBandwidth + 1)\n\t}\n\n\tprivate determineDividerStatus(): boolean {\n\t\t// Add dividers if status is not off, will assume auto or on by default.\n\t\tconst dividerStatus = getProperty(this.getOptions(), 'heatmap', 'divider', 'state')\n\n\t\t// Determine if cell divider should be displayed\n\t\tif (dividerStatus !== DividerStatus.OFF) {\n\t\t\tif (\n\t\t\t\t(dividerStatus === DividerStatus.AUTO &&\n\t\t\t\t\theatmapConfigs.minCellDividerDimension <= this.xBandwidth &&\n\t\t\t\t\theatmapConfigs.minCellDividerDimension <= this.yBandwidth) ||\n\t\t\t\tdividerStatus === DividerStatus.ON\n\t\t\t) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\taddEventListener() {\n\t\tconst self = this\n\t\tconst { cartesianScales } = this.services\n\t\tconst options = this.getOptions()\n\t\tconst totalLabel =\n\t\t\tget(options, 'locale.translations.total') || get(options, 'tooltip.totalLabel') || 'Total'\n\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier()\n\t\tconst rangeIdentifier = cartesianScales.getRangeIdentifier()\n\n\t\tconst domainLabel = cartesianScales.getDomainLabel()\n\t\tconst rangeLabel = cartesianScales.getRangeLabel()\n\n\t\tthis.parent\n\t\t\t.selectAll('g.cell')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst cell = select(this)\n\t\t\t\tconst hoveredElement = cell.select('rect.heat')\n\t\t\t\tconst nullState = hoveredElement.classed('null-state')\n\n\t\t\t\t// Dispatch event and tooltip only if value exists\n\t\t\t\tif (!nullState) {\n\t\t\t\t\t// Get transformation value of node\n\t\t\t\t\tconst transform = getTransformOffsets(cell.attr('transform'))\n\n\t\t\t\t\tself.parent\n\t\t\t\t\t\t.select('g.cell-highlight')\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'transform',\n\t\t\t\t\t\t\t`translate(${transform.x + self.translationUnits.x}, ${\n\t\t\t\t\t\t\t\ttransform.y + self.translationUnits.y\n\t\t\t\t\t\t\t})`\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.classed('highlighter-hidden', false)\n\n\t\t\t\t\t// Dispatch mouse over event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Heatmap.HEATMAP_MOUSEOVER, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\t\tdatum: datum\n\t\t\t\t\t})\n\n\t\t\t\t\t// Dispatch tooltip show event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: domainLabel,\n\t\t\t\t\t\t\t\tvalue: datum[domainIdentifier]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: rangeLabel,\n\t\t\t\t\t\t\t\tvalue: datum[rangeIdentifier]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: totalLabel,\n\t\t\t\t\t\t\t\tvalue: datum['value'],\n\t\t\t\t\t\t\t\tcolor: hoveredElement.style('fill')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Heatmap.HEATMAP_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: datum\n\t\t\t\t})\n\t\t\t\t// Dispatch tooltip move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse click event\n\t\t\t\tself.services.events.dispatchEvent(Events.Heatmap.HEATMAP_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: datum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst cell = select(this)\n\t\t\t\tconst hoveredElement = cell.select('rect.heat')\n\t\t\t\tconst nullState = hoveredElement.classed('null-state')\n\n\t\t\t\tself.parent.select('g.cell-highlight').classed('highlighter-hidden', true)\n\n\t\t\t\t// Dispatch event and tooltip only if value exists\n\t\t\t\tif (!nullState) {\n\t\t\t\t\t// Dispatch mouse out event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Heatmap.HEATMAP_MOUSEOUT, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\t\tdatum: datum\n\t\t\t\t\t})\n\n\t\t\t\t\t// Dispatch hide tooltip event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\t// Highlight elements that match the hovered axis item\n\thandleAxisOnHover = (event: CustomEvent) => {\n\t\tconst { detail } = event\n\t\tconst { datum } = detail\n\t\t// Unique ranges and domains\n\t\tconst ranges = (this.model as HeatmapModel).getUniqueRanges()\n\t\tconst domains = (this.model as HeatmapModel).getUniqueDomain()\n\t\t// Labels\n\t\tconst domainLabel = this.services.cartesianScales.getDomainLabel()\n\t\tconst rangeLabel = this.services.cartesianScales.getRangeLabel()\n\t\t// Scales\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst mainYScale = this.services.cartesianScales.getMainYScale()\n\n\t\tlet label = '',\n\t\t\tsum: any = null,\n\t\t\tminimum: any = null,\n\t\t\tmaximum: any = null\n\n\t\t// Check to see where datum belongs\n\t\tif (this.matrix[datum] !== undefined) {\n\t\t\tlabel = domainLabel\n\t\t\t// Iterate through Object and get sum, min, and max\n\t\t\tranges.forEach((element: any) => {\n\t\t\t\tif (typeof this.matrix[datum][element].value === 'number') {\n\t\t\t\t\tconst value = this.matrix[datum][element].value\n\t\t\t\t\tif (sum === null) {\n\t\t\t\t\t\tsum = value\n\t\t\t\t\t\tminimum = value\n\t\t\t\t\t\tmaximum = value\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tsum += value\n\t\t\t\t\tminimum = value < minimum ? value : minimum\n\t\t\t\t\tmaximum = value > maximum ? value : maximum\n\t\t\t\t}\n\t\t\t})\n\t\t} else {\n\t\t\tlabel = rangeLabel\n\t\t\tdomains.forEach((element: any) => {\n\t\t\t\tif (typeof this.matrix[element][datum].value === 'number') {\n\t\t\t\t\tconst value = this.matrix[element][datum].value\n\t\t\t\t\tif (sum === null) {\n\t\t\t\t\t\tsum = value\n\t\t\t\t\t\tminimum = value\n\t\t\t\t\t\tmaximum = value\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tsum += value\n\t\t\t\t\tminimum = value < minimum ? value : minimum\n\t\t\t\t\tmaximum = value > maximum ? value : maximum\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (mainXScale(datum) !== undefined) {\n\t\t\tthis.parent\n\t\t\t\t.select('g.multi-cell.column-highlight')\n\t\t\t\t.classed('highlighter-hidden', false)\n\t\t\t\t.attr('transform', `translate(${mainXScale(datum)}, ${min(mainYScale.range())})`)\n\t\t} else if (mainYScale(datum) !== undefined) {\n\t\t\tthis.parent\n\t\t\t\t.select('g.multi-cell.row-highlight')\n\t\t\t\t.classed('highlighter-hidden', false)\n\t\t\t\t.attr('transform', `translate(${min(mainXScale.range())},${mainYScale(datum)})`)\n\t\t}\n\n\t\t// Dispatch tooltip show event\n\t\tthis.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\tevent: detail.event,\n\t\t\thoveredElement: select(event.detail.element),\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tlabel: label,\n\t\t\t\t\tvalue: datum,\n\t\t\t\t\tbold: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Min',\n\t\t\t\t\tvalue: minimum !== null ? minimum : '-'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Max',\n\t\t\t\t\tvalue: maximum !== null ? maximum : '-'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Average',\n\t\t\t\t\tvalue: sum !== null ? sum / domains.length : '-'\n\t\t\t\t}\n\t\t\t]\n\t\t})\n\t}\n\n\t// Un-highlight all elements\n\thandleAxisMouseOut = (event: CustomEvent) => {\n\t\t// Hide column/row\n\t\tthis.parent.selectAll('g.multi-cell').classed('highlighter-hidden', true)\n\n\t\t// Dispatch hide tooltip event\n\t\tthis.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\tevent\n\t\t})\n\t}\n\n\t// Remove event listeners\n\tdestroy() {\n\t\tthis.parent\n\t\t\t.selectAll('rect.heat')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('click', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleAxisOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleAxisMouseOut)\n\t}\n}\n","import { select } from 'd3'\nimport { get } from 'lodash-es'\nimport { generateSVGPathString, getProperty } from '@/tools'\nimport { Events, CartesianOrientations, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport { Component } from '@/components/component'\n\nexport class Histogram extends Component {\n\ttype = 'histogram'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer()\n\n\t\t// Chart options mixed with the internal configurations\n\t\tconst options = this.model.getOptions()\n\t\tconst { groupIdentifier } = options\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst binnedStackedData = this.model.getBinnedStackedData()\n\n\t\tconst x = this.services.cartesianScales.getMainXScale()\n\n\t\t// Update data on all bar groups\n\t\tconst barGroups = svg\n\t\t\t.selectAll('g.bars')\n\t\t\t.data(binnedStackedData, (d: any) => get(d, `0.${groupMapsTo}`))\n\n\t\tbarGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add bar groups that need to be introduced\n\t\tbarGroups.enter().append('g').classed('bars', true).attr('role', Roles.GROUP)\n\n\t\t// Update data on all bars\n\t\tconst bars = svg\n\t\t\t.selectAll('g.bars')\n\t\t\t.selectAll('path.bar')\n\t\t\t.data((data: any) => data)\n\n\t\t// Remove bars that need to be removed\n\t\tbars.exit().remove()\n\n\t\tbars\n\t\t\t.enter()\n\t\t\t.append('path')\n\t\t\t.merge(bars as any)\n\t\t\t.classed('bar', true)\n\t\t\t.attr(groupIdentifier, (_: any, i: number) => i)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'histogram-bar-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => this.model.getFillColor(d[groupMapsTo], null, d))\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst bin = get(d, 'data')\n\n\t\t\t\tif (!bin) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t */\n\t\t\t\tconst barWidth = x(bin.x1) - x(bin.x0) - 1\n\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(bin.x0) as number\n\t\t\t\tconst x1 = x0 + barWidth\n\n\t\t\t\tconst y0 = this.services.cartesianScales.getRangeValue(d[0]) as number\n\t\t\t\tlet y1 = this.services.cartesianScales.getRangeValue(d[1]) as number\n\n\t\t\t\t// Add the divider gap\n\t\t\t\tif (Math.abs(y1 - y0) > 0 && Math.abs(y1 - y0) > options.bars.dividerSize) {\n\t\t\t\t\tif (this.services.cartesianScales.getOrientation() === CartesianOrientations.VERTICAL) {\n\t\t\t\t\t\ty1 += 1\n\t\t\t\t\t} else {\n\t\t\t\t\t\ty1 -= 1\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t)\n\t\t\t})\n\t\t\t.attr('opacity', 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'bar')\n\t\t\t.attr('aria-label', (d: any) => getProperty(d, 'data', d[groupMapsTo]))\n\n\t\t// Add event listeners for the above elements\n\t\tthis.addEventListeners()\n\t}\n\n\t// Highlight elements that match the hovered legend item\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-hover-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\t// Un-highlight all elements\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-mouseout-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst options = this.model.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\tconst x0 = numberFormatter(parseFloat(get(datum, 'data.x0')), localeCode)\n\t\t\t\tconst x1 = numberFormatter(parseFloat(get(datum, 'data.x1')), localeCode)\n\n\t\t\t\tconst rangeAxisPosition = self.services.cartesianScales.getRangeAxisPosition()\n\t\t\t\tconst rangeScaleLabel = self.services.cartesianScales.getScaleLabel(rangeAxisPosition)\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: get(options, 'bins.rangeLabel') || 'Range',\n\t\t\t\t\t\t\tvalue: `${x0} – ${x1}`\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: options.tooltip.groupLabel || 'Group',\n\t\t\t\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\t\t\tdataGroupName: datum[groupMapsTo]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: rangeScaleLabel,\n\t\t\t\t\t\t\tvalue: get(datum, `data.${datum[groupMapsTo]}`)\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent) {\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function () {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Select all same group elements\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","import { flipDomainAndRangeBasedOnOrientation } from '@/tools'\nimport { lines as lineConfigs } from '@/configuration'\nimport { Scatter } from './scatter'\nimport { CartesianOrientations, ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\n\nexport class Lollipop extends Scatter {\n\ttype = 'lollipop'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst { events } = this.services\n\t\t// Highlight correct line legend item hovers\n\t\tevents.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\t// Un-highlight lines on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst options = this.model.getOptions()\n\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst { cartesianScales } = this.services\n\t\tconst mainXScale = cartesianScales.getMainXScale()\n\t\tconst mainYScale = cartesianScales.getMainYScale()\n\t\tconst domainIdentifier = cartesianScales.getDomainIdentifier()\n\n\t\tconst getDomainValue = (d: any) => cartesianScales.getDomainValue(d)\n\t\tconst getRangeValue = (d: any) => cartesianScales.getRangeValue(d)\n\t\tconst orientation = cartesianScales.getOrientation()\n\t\tconst [getXValue, getYValue] = flipDomainAndRangeBasedOnOrientation(\n\t\t\tgetDomainValue,\n\t\t\tgetRangeValue,\n\t\t\torientation\n\t\t)\n\n\t\t// Update data on lines\n\t\tconst lines = svg\n\t\t\t.selectAll('line.line')\n\t\t\t.data(\n\t\t\t\tthis.getScatterData(),\n\t\t\t\t(datum: any) => `${datum[groupMapsTo]}-${datum[domainIdentifier]}`\n\t\t\t)\n\n\t\t// Remove lines that are no longer needed\n\t\tlines.exit().attr('opacity', 0).remove()\n\n\t\t// Remove lines that need to be removed\n\t\tconst enteringLines = lines.enter().append('line').attr('opacity', 0)\n\n\t\tconst allLines = enteringLines\n\t\t\t.merge(lines as any)\n\t\t\t.classed('line', true)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.STROKE],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'lollipop-line-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('stroke', (d: any) => this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d))\n\t\t\t.attr('opacity', 1)\n\n\t\tif (orientation === CartesianOrientations.HORIZONTAL) {\n\t\t\tallLines\n\t\t\t\t.attr('y1', getYValue)\n\t\t\t\t.attr('y2', getYValue)\n\t\t\t\t.attr('x1', mainXScale.range()[0])\n\t\t\t\t.attr('x2', (d: any) => (getXValue(d) as any) - options.points.radius)\n\t\t} else {\n\t\t\tallLines\n\t\t\t\t.attr('x1', getXValue)\n\t\t\t\t.attr('x2', getXValue)\n\t\t\t\t.attr('y1', mainYScale.range()[0])\n\t\t\t\t.attr('y2', (d: any) => getYValue(d) + options.points.radius)\n\t\t}\n\n\t\tthis.addScatterPointEventListeners()\n\t}\n\n\t// listen for when individual datapoints are hovered\n\taddScatterPointEventListeners() {\n\t\t// Highlight correct line associated when hovering on a scatter point\n\t\tthis.services.events.addEventListener(\n\t\t\tEvents.Scatter.SCATTER_MOUSEOVER,\n\t\t\tthis.handleScatterOnHover\n\t\t)\n\n\t\t// unbolden the line when not hovered on the lollipop scatter point\n\t\tthis.services.events.addEventListener(\n\t\t\tEvents.Scatter.SCATTER_MOUSEOUT,\n\t\t\tthis.handleScatterOnMouseOut\n\t\t)\n\t}\n\n\t// on hover, bolden the line associated with the scatter\n\thandleScatterOnHover = (event: CustomEvent) => {\n\t\tconst hoveredElement = event.detail\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tthis.parent.selectAll('line.line').attr('stroke-width', (d: any) => {\n\t\t\tif (d[groupMapsTo] !== hoveredElement.datum[groupMapsTo]) {\n\t\t\t\treturn lineConfigs.weight.unselected\n\t\t\t}\n\t\t\t// apply selected weight\n\t\t\treturn lineConfigs.weight.selected\n\t\t})\n\t}\n\n\t// on mouse out remove the stroke width assertion\n\thandleScatterOnMouseOut = () => {\n\t\tthis.parent.selectAll('line.line').attr('stroke-width', lineConfigs.weight.unselected)\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tthis.parent\n\t\t\t.selectAll('line.line')\n\t\t\t.transition('legend-hover-line')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => {\n\t\t\t\tif (d[groupMapsTo] !== hoveredElement.datum()['name']) {\n\t\t\t\t\treturn lineConfigs.opacity.unselected\n\t\t\t\t}\n\n\t\t\t\treturn lineConfigs.opacity.selected\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('line.line')\n\t\t\t.transition('legend-mouseout-line')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-line'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', lineConfigs.opacity.selected)\n\t}\n\n\tdestroy() {\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\n\t\t// remove scatter listeners\n\t\teventsFragment.removeEventListener(Events.Scatter.SCATTER_MOUSEOVER, this.handleScatterOnHover)\n\t\teventsFragment.removeEventListener(\n\t\t\tEvents.Scatter.SCATTER_MOUSEOUT,\n\t\t\tthis.handleScatterOnMouseOut\n\t\t)\n\t}\n}\n","import { scaleLinear, select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { meter as meterConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { ColorClassNameTypes, Events, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport { MeterChartModel } from '@/model/meter'\n\nexport class Meter extends Component {\n\ttype = 'meter'\n\trenderType = RenderTypes.SVG\n\n\tgetStackedBounds(data: any, scale: any) {\n\t\tlet prevX = 0\n\t\tconst stackedData = data.map((d: any, i: number) => {\n\t\t\tif (i !== 0) {\n\t\t\t\tprevX += scale(d.value)\n\t\t\t\treturn {\n\t\t\t\t\t...d,\n\t\t\t\t\twidth: Math.abs(scale(d.value) - meterConfigs.dividerWidth),\n\t\t\t\t\tx: prevX - scale(d.value)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tprevX = scale(d.value)\n\t\t\t\treturn {\n\t\t\t\t\t...d,\n\t\t\t\t\twidth: Math.abs(scale(d.value) - meterConfigs.dividerWidth),\n\t\t\t\t\tx: 0\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\treturn stackedData\n\t}\n\n\trender(animate = true) {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer()\n\t\tconst options = this.getOptions()\n\t\tconst proportional = getProperty(options, 'meter', 'proportional')\n\t\tconst data = this.model.getDisplayData()\n\t\tconst status = this.model.getStatus()\n\n\t\tconst { width } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst { groupMapsTo } = options.data\n\n\t\tlet domainMax: number\n\t\tif (getProperty(options, 'meter', 'proportional') === null) {\n\t\t\tdomainMax = 100\n\t\t} else {\n\t\t\tconst total = getProperty(options, 'meter', 'proportional', 'total')\n\t\t\tdomainMax = total\n\t\t\t\t? total\n\t\t\t\t: (this.model as MeterChartModel).getMaximumDomain(this.model.getDisplayData())\n\t\t}\n\n\t\t// each meter has a scale for the value but no visual axis\n\t\tconst xScale = scaleLinear().domain([0, domainMax]).range([0, width])\n\t\tconst stackedData = this.getStackedBounds(data, xScale)\n\n\t\tconst userProvidedHeight = getProperty(options, 'meter', 'height')\n\n\t\t// draw the container to hold the value\n\t\tDOMUtils.appendOrSelect(svg, 'rect.container')\n\t\t\t.attr('x', 0)\n\t\t\t.attr('y', 0)\n\t\t\t.attr('width', width)\n\t\t\t.attr(\n\t\t\t\t'height',\n\t\t\t\tuserProvidedHeight\n\t\t\t\t\t? userProvidedHeight\n\t\t\t\t\t: proportional\n\t\t\t\t\t\t? meterConfigs.height.proportional\n\t\t\t\t\t\t: meterConfigs.height.default\n\t\t\t)\n\n\t\t// draw the container max range value indicator\n\t\tDOMUtils.appendOrSelect(svg, 'line.rangeIndicator')\n\t\t\t.attr('x1', width)\n\t\t\t.attr('x2', width)\n\t\t\t.attr('y1', 0)\n\t\t\t.attr(\n\t\t\t\t'y2',\n\t\t\t\tuserProvidedHeight\n\t\t\t\t\t? userProvidedHeight\n\t\t\t\t\t: proportional\n\t\t\t\t\t\t? meterConfigs.height.proportional\n\t\t\t\t\t\t: meterConfigs.height.default\n\t\t\t)\n\n\t\t// rect with the value binded\n\t\tconst valued = svg.selectAll('rect.value').data(stackedData)\n\n\t\t// if user provided a color for the bar, we dont want to attach a status class\n\t\tconst className =\n\t\t\tstatus != null && !self.model.isUserProvidedColorScaleValid() && !proportional\n\t\t\t\t? `value status--${status}`\n\t\t\t\t: 'value'\n\n\t\t// draw the value bar\n\t\tvalued\n\t\t\t.enter()\n\t\t\t.append('rect')\n\t\t\t.classed('value', true)\n\t\t\t.merge(valued as any)\n\t\t\t.attr('x', (d: any) => {\n\t\t\t\treturn d.x\n\t\t\t})\n\t\t\t.attr('y', 0)\n\t\t\t.attr('height', () => {\n\t\t\t\treturn userProvidedHeight\n\t\t\t\t\t? userProvidedHeight\n\t\t\t\t\t: proportional\n\t\t\t\t\t\t? meterConfigs.height.proportional\n\t\t\t\t\t\t: meterConfigs.height.default\n\t\t\t})\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: className\n\t\t\t\t})\n\t\t\t)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'meter-bar-update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('width', (d: any) => {\n\t\t\t\treturn d.value > domainMax ? xScale(domainMax) : Math.max(d.width, 2)\n\t\t\t})\n\t\t\t.style('fill', (d: any) => self.model.getFillColor(d[groupMapsTo], null, d))\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'value')\n\t\t\t.attr('aria-label', (d: any) => d.value)\n\n\t\tvalued.exit().remove()\n\n\t\t// draw the peak\n\t\tconst peakValue = getProperty(options, 'meter', 'peak')\n\n\t\tlet peakData = peakValue\n\t\tif (peakValue !== null) {\n\t\t\tif (peakValue > domainMax) {\n\t\t\t\tpeakData = domainMax\n\t\t\t} else if (peakValue < data[0].value) {\n\t\t\t\tpeakData = data[0].value > domainMax ? domainMax : data[0].value\n\t\t\t}\n\t\t}\n\n\t\t// if a peak is supplied within the domain, we want to render it\n\t\tconst peak = svg.selectAll('line.peak').data(peakData == null ? [] : [peakData])\n\n\t\tpeak\n\t\t\t.enter()\n\t\t\t.append('line')\n\t\t\t.classed('peak', true)\n\t\t\t.merge(peak as any)\n\t\t\t.attr('y1', 0)\n\t\t\t.attr('y2', () => {\n\t\t\t\treturn userProvidedHeight\n\t\t\t\t\t? userProvidedHeight\n\t\t\t\t\t: proportional\n\t\t\t\t\t\t? meterConfigs.height.proportional\n\t\t\t\t\t\t: meterConfigs.height.default\n\t\t\t})\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'peak-line-update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('x1', (d: any) => xScale(d))\n\t\t\t.attr('x2', (d: any) => xScale(d))\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'peak')\n\t\t\t.attr('aria-label', (d: any) => d)\n\n\t\tpeak.exit().remove()\n\n\t\t// this forces the meter chart to only take up as much height as needed (if no height is provided)\n\t\tthis.services.domUtils.setSVGMaxHeight()\n\n\t\t// Add event listeners to elements and legend\n\t\tthis.addEventListeners()\n\t}\n\n\t// add event listeners for tooltips on proportional meter bars\n\taddEventListeners() {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst self = this\n\t\tconst proportional = getProperty(options, 'meter', 'proportional')\n\n\t\tthis.parent\n\t\t\t.selectAll('rect.value')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Meter.METER_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (proportional) {\n\t\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\t\t// Show tooltip\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\thoveredElement,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: datum[groupMapsTo],\n\t\t\t\t\t\t\t\tvalue: datum.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Meter.METER_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (proportional) {\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\t\tevent\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Meter.METER_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Meter.METER_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tif (proportional) {\n\t\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t\t// Hide tooltip\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\t\thoveredElement\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('rect.value')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\t\t\t.on('click', null)\n\t}\n}\n","import {\n\tcurveLinearClosed,\n\textent,\n\tlineRadial,\n\tmax,\n\tmin,\n\tscaleBand,\n\tscaleLinear,\n\tselect,\n\ttype Selection as D3Selection,\n\ttype Transition\n} from 'd3'\nimport { flatMapDeep, kebabCase, merge } from 'lodash-es'\nimport { getProperty } from '@/tools'\nimport { radar as radarConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, ColorClassNameTypes, RenderTypes, Alignments } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport {\n\tPoint,\n\tAngle,\n\tradialLabelPlacement,\n\tradToDeg,\n\tpolarToCartesianCoords,\n\tdistanceBetweenPointOnCircAndVerticalDiameter\n} from '@/services/angle-utils'\n\nexport class Radar extends Component {\n\ttype = 'radar'\n\trenderType = RenderTypes.SVG\n\n\tsvg: SVGElement\n\tgroupMapsTo: string\n\tuniqueKeys: string[]\n\tuniqueGroups: string[]\n\tfullDataNormalized: any\n\tgroupedDataNormalized: any\n\n\tinit() {\n\t\tconst { events } = this.services\n\t\t// Highlight correct line legend item hovers\n\t\tevents.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\t// Un-highlight lines on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer()\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst data = this.model.getData()\n\t\tconst groupedData = this.model.getGroupedData()\n\n\t\tconst options = this.getOptions()\n\n\t\tconst groupMapsTo = getProperty(options, 'data', 'groupMapsTo')\n\t\tconst valueMapsTo = getProperty(options, 'radar', 'axes', 'value')\n\n\t\tconst { angle, value } = getProperty(options, 'radar', 'axes')\n\n\t\tconst { xLabelPadding, yLabelPadding, yTicksNumber, minRange, xAxisRectHeight } = radarConfigs\n\n\t\tthis.uniqueKeys = Array.from(new Set(data.map((d: any) => d[angle])))\n\t\tthis.uniqueGroups = Array.from(new Set(data.map((d: any) => d[groupMapsTo])))\n\t\tthis.fullDataNormalized = this.normalizeFlatData(data)\n\t\tthis.groupedDataNormalized = this.normalizeGroupedData(groupedData)\n\n\t\tconst labelHeight = this.getLabelDimensions(this.uniqueKeys[0]).height\n\t\tconst margin = 2 * (labelHeight + yLabelPadding)\n\t\tconst size = Math.min(width, height)\n\t\tconst diameter = size - margin\n\t\tconst radius = diameter / 2\n\n\t\tif (radius <= 0) {\n\t\t\treturn\n\t\t}\n\n\t\t// given a key, return the corresponding angle in radiants\n\t\t// rotated by -PI/2 because we want angle 0° at -y (12 o’clock)\n\t\tconst xScale = scaleBand<string>()\n\t\t\t.domain(this.fullDataNormalized.map((d: any) => d[angle]))\n\t\t\t.range([0, 2 * Math.PI].map((a: number) => a - Math.PI / 2) as [Angle, Angle])\n\n\t\tconst centerPointMinValue = min(this.fullDataNormalized.map((d: any) => d[value]) as number[])\n\t\tconst yScale = scaleLinear()\n\t\t\t.domain([\n\t\t\t\tcenterPointMinValue >= 0 ? 0 : centerPointMinValue,\n\t\t\t\tmax(this.fullDataNormalized.map((d: any) => d[value]) as number[])\n\t\t\t])\n\t\t\t.range([minRange, radius])\n\t\t\t.nice(yTicksNumber)\n\t\tconst yTicks = yScale.ticks(yTicksNumber)\n\n\t\tconst colorScale = (group: string, key?: any, data?: any): string =>\n\t\t\tthis.model.getFillColor(group, key, data)\n\n\t\t// constructs a new radial line generator\n\t\t// the angle accessor returns the angle in radians with 0° at -y (12 o’clock)\n\t\t// so map back the angle\n\t\tconst radialLineGenerator = lineRadial<any>()\n\t\t\t.angle((d: any) => xScale(d[angle]) + Math.PI / 2)\n\t\t\t.radius((d: any) => yScale(d[value]))\n\t\t\t.curve(curveLinearClosed)\n\n\t\t// compute the space that each x label needs\n\t\tconst horizSpaceNeededByEachXLabel = this.uniqueKeys.map((key: any) => {\n\t\t\tconst tickWidth = this.getLabelDimensions(key).width\n\t\t\t// compute the distance between the point that the label rapresents and the vertical diameter\n\t\t\tconst distanceFromDiameter = distanceBetweenPointOnCircAndVerticalDiameter(\n\t\t\t\txScale(key),\n\t\t\t\tradius\n\t\t\t)\n\t\t\t// the space each label occupies is the sum of these two values\n\t\t\treturn tickWidth + distanceFromDiameter\n\t\t})\n\t\tconst leftPadding = max(horizSpaceNeededByEachXLabel)\n\n\t\t// center coordinates\n\t\tconst c: Point = {\n\t\t\tx: leftPadding + xLabelPadding,\n\t\t\ty: height / 2\n\t\t}\n\n\t\t/////////////////////////////\n\t\t// Drawing the radar\n\t\t/////////////////////////////\n\n\t\t// y axes\n\t\tconst yAxes = DOMUtils.appendOrSelect(svg, 'g.y-axes').attr('role', Roles.GROUP)\n\t\tconst yAxisUpdate = yAxes.selectAll('path').data(yTicks, (tick: any) => tick)\n\t\t// for each tick, create array of data corresponding to the points composing the shape\n\t\tconst shapeData = (tick: number) =>\n\t\t\tthis.uniqueKeys.map((key: any) => ({ [angle]: key, [value]: tick }))\n\t\tyAxisUpdate.join(\n\t\t\t(enter: any) =>\n\t\t\t\tenter\n\t\t\t\t\t.append('path')\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr('transform', `translate(${c.x}, ${c.y})`)\n\t\t\t\t\t.attr('fill', 'none')\n\t\t\t\t\t.call((selection: D3Selection<Element, any, Element, any>) =>\n\t\t\t\t\t\tselection\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t \tBUG (D3): when \"Radar - Missing datapoints\" is displayed, the path that represents the third\n\t\t\t\t\t\t\tblob (shaded area for Water) generates a d=\"M0,-59L118.248,-38.421L29.879,41.125L-25.079,34.518LNaN,NaNZ\"\n\t\t\t\t\t\t\tvalue because of the intentionally missing datapoint for the path (other paths have 5 points, this one has 4).\n\t\t\t\t\t\t\tIn this case, D3 should generate a d=\"M0,-59L118.248,-38.421L29.879,41.125L-25.079,34.518\". Because the path ends\n\t\t\t\t\t\t\twith \"LNaN,NaNZ\", browsers render the path up to that point creating the desired look but\n\t\t\t\t\t\t\tcausing D3 to throw an error (that we cannot catch because it's async). The error fires on\n\t\t\t\t\t\t\td3-transition/src/transition/attrTween.js:5 (but it's a long call-chain).\n\t\t\t\t\t\t*/\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.call((t: Transition<Element, any, Element, any>) =>\n\t\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\t\tname: 'radar_y_axes_enter',\n\t\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t\t.attr('d', (tick: number) => radialLineGenerator(shapeData(tick)))\n\t\t\t\t\t),\n\t\t\t(update: any) =>\n\t\t\t\tupdate.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_y_axes_update',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.attr('transform', `translate(${c.x}, ${c.y})`)\n\t\t\t\t\t\t.attr('d', (tick: any) => radialLineGenerator(shapeData(tick)))\n\t\t\t\t),\n\t\t\t(exit: any) =>\n\t\t\t\texit.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_y_axes_exit',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('d', (tick: any) => radialLineGenerator(shapeData(tick)))\n\t\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t\t.remove()\n\t\t\t\t)\n\t\t)\n\n\t\t// x axes\n\t\tconst xAxes = DOMUtils.appendOrSelect(svg, 'g.x-axes').attr('role', Roles.GROUP)\n\t\tconst xAxisUpdate = xAxes.selectAll('line').data(this.uniqueKeys, (key: any) => key)\n\t\txAxisUpdate.join(\n\t\t\t(enter: any) =>\n\t\t\t\tenter\n\t\t\t\t\t.append('line')\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr('class', (key: any) => `x-axis-${kebabCase(key)}`) // replace spaces with -\n\t\t\t\t\t.attr('stroke-dasharray', '0')\n\t\t\t\t\t.attr('x1', (key: any) => polarToCartesianCoords(xScale(key), 0, c).x)\n\t\t\t\t\t.attr('y1', (key: any) => polarToCartesianCoords(xScale(key), 0, c).y)\n\t\t\t\t\t.attr('x2', (key: any) => polarToCartesianCoords(xScale(key), 0, c).x)\n\t\t\t\t\t.attr('y2', (key: any) => polarToCartesianCoords(xScale(key), 0, c).y)\n\t\t\t\t\t.call((selection: any) =>\n\t\t\t\t\t\tselection\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\t\tname: 'radar_x_axes_enter',\n\t\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t\t.attr('x1', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[0], c).x)\n\t\t\t\t\t\t\t.attr('y1', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[0], c).y)\n\t\t\t\t\t\t\t.attr('x2', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[1], c).x)\n\t\t\t\t\t\t\t.attr('y2', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[1], c).y)\n\t\t\t\t\t),\n\t\t\t(update: any) =>\n\t\t\t\tupdate.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_x_axes_update',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.attr('x1', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[0], c).x)\n\t\t\t\t\t\t.attr('y1', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[0], c).y)\n\t\t\t\t\t\t.attr('x2', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[1], c).x)\n\t\t\t\t\t\t.attr('y2', (key: any) => polarToCartesianCoords(xScale(key), yScale.range()[1], c).y)\n\t\t\t\t),\n\t\t\t(exit: any) =>\n\t\t\t\texit.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_x_axes_exit',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t\t.remove()\n\t\t\t\t)\n\t\t)\n\n\t\t// x labels\n\t\tconst xLabels = DOMUtils.appendOrSelect(svg, 'g.x-labels').attr('role', Roles.GROUP)\n\t\tconst xLabelUpdate = xLabels.selectAll('text').data(this.uniqueKeys)\n\t\txLabelUpdate.join(\n\t\t\t(enter: any) =>\n\t\t\t\tenter\n\t\t\t\t\t.append('text')\n\t\t\t\t\t.text((key: any) => key)\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'x',\n\t\t\t\t\t\t(key: any) =>\n\t\t\t\t\t\t\tpolarToCartesianCoords(xScale(key), yScale.range()[1] + xLabelPadding, c).x\n\t\t\t\t\t)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'y',\n\t\t\t\t\t\t(key: any) =>\n\t\t\t\t\t\t\tpolarToCartesianCoords(xScale(key), yScale.range()[1] + xLabelPadding, c).y\n\t\t\t\t\t)\n\t\t\t\t\t.style('text-anchor', (key: any) => radialLabelPlacement(xScale(key)).textAnchor)\n\t\t\t\t\t.style(\n\t\t\t\t\t\t'dominant-baseline',\n\t\t\t\t\t\t(key: any) => radialLabelPlacement(xScale(key)).dominantBaseline\n\t\t\t\t\t)\n\t\t\t\t\t.call((selection: any) =>\n\t\t\t\t\t\tselection\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\t\tname: 'radar_x_labels_enter',\n\t\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t),\n\t\t\t(update: any) =>\n\t\t\t\tupdate.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_x_labels_update',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'x',\n\t\t\t\t\t\t\t(key: any) =>\n\t\t\t\t\t\t\t\tpolarToCartesianCoords(xScale(key), yScale.range()[1] + xLabelPadding, c).x\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'y',\n\t\t\t\t\t\t\t(key: any) =>\n\t\t\t\t\t\t\t\tpolarToCartesianCoords(xScale(key), yScale.range()[1] + xLabelPadding, c).y\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.end()\n\t\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\t\t// Align chart horizontally after x-axies has finished rendering\n\t\t\t\t\t\t\tconst alignment = getProperty(options, 'radar', 'alignment')\n\n\t\t\t\t\t\t\tconst alignmentXOffset = this.getAlignmentXOffset(alignment, svg, this.getParent())\n\t\t\t\t\t\t\tsvg.attr('x', alignmentXOffset)\n\t\t\t\t\t\t})\n\t\t\t\t),\n\t\t\t(exit: any) =>\n\t\t\t\texit.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_x_labels_exit',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t\t.remove()\n\t\t\t\t)\n\t\t)\n\n\t\t// blobs\n\t\tconst blobs = DOMUtils.appendOrSelect(svg, 'g.blobs').attr('role', Roles.GROUP)\n\t\tconst blobUpdate = blobs\n\t\t\t.selectAll('path')\n\t\t\t.data(this.groupedDataNormalized, (group: any) => group.name)\n\n\t\tblobUpdate.join(\n\t\t\t(enter: any) =>\n\t\t\t\tenter\n\t\t\t\t\t.append('path')\n\t\t\t\t\t.attr('class', (group: any) =>\n\t\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\t\t\tdataGroupName: group.name,\n\t\t\t\t\t\t\toriginalClassName: 'blob'\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t\t\t.attr('aria-label', (d: any) => d['name'])\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'transform',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t? () => `translate(${c.x}, ${c.y}) scale(${1 + Math.random() * 0.35})`\n\t\t\t\t\t\t\t: `translate(${c.x}, ${c.y})`\n\t\t\t\t\t)\n\t\t\t\t\t.style('fill', (group: any) => colorScale(group.name, null, group.data))\n\t\t\t\t\t.style('fill-opacity', radarConfigs.opacity.selected)\n\t\t\t\t\t.style('stroke', (group: any) => colorScale(group.name, null, group.data))\n\t\t\t\t\t.call((selection: any) => {\n\t\t\t\t\t\tconst selectionUpdate = selection.transition().call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_blobs_enter',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\n\t\t\t\t\t\tif (animate) {\n\t\t\t\t\t\t\tselectionUpdate\n\t\t\t\t\t\t\t\t.delay(() => Math.random() * 30)\n\t\t\t\t\t\t\t\t.attr('transform', `translate(${c.x}, ${c.y})`)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tselectionUpdate\n\t\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t\t.attr('d', (group: any) => radialLineGenerator(group.data))\n\t\t\t\t\t}),\n\t\t\t(update: any) => {\n\t\t\t\tupdate\n\t\t\t\t\t.attr('class', (group: any) =>\n\t\t\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL, ColorClassNameTypes.STROKE],\n\t\t\t\t\t\t\tdataGroupName: group.name,\n\t\t\t\t\t\t\toriginalClassName: 'blob'\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.style('fill', (group: any) => colorScale(group.name, null, group.data))\n\t\t\t\t\t.style('stroke', (group: any) => colorScale(group.name, null, group.data))\n\t\t\t\tupdate.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_blobs_update',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.attr('transform', `translate(${c.x}, ${c.y})`)\n\t\t\t\t\t\t.attr('d', (group: any) => radialLineGenerator(group.data))\n\t\t\t\t)\n\t\t\t\treturn update\n\t\t\t},\n\t\t\t(exit: any) =>\n\t\t\t\texit.call((selection: any) => {\n\t\t\t\t\tconst selectionUpdate = selection.transition().call((t: any) =>\n\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'radar_blobs_exit',\n\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\n\t\t\t\t\tif (animate) {\n\t\t\t\t\t\tselectionUpdate\n\t\t\t\t\t\t\t.delay(() => Math.random() * 30)\n\t\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t\t'transform',\n\t\t\t\t\t\t\t\t() => `translate(${c.x}, ${c.y}) scale(${1 + Math.random() * 0.35})`\n\t\t\t\t\t\t\t)\n\t\t\t\t\t}\n\n\t\t\t\t\tselectionUpdate.attr('opacity', 0).remove()\n\t\t\t\t})\n\t\t)\n\n\t\t// data dots\n\t\tconst dots = DOMUtils.appendOrSelect(svg, 'g.dots').attr('role', Roles.GROUP)\n\n\t\tconst dotsUpdate = dots\n\t\t\t.selectAll('circle')\n\t\t\t// Filter out dots with no value so they are not rendered\n\t\t\t.data(this.fullDataNormalized.filter((d: any) => getProperty(d, value) !== null))\n\n\t\tdotsUpdate\n\t\t\t.join(\n\t\t\t\t(enter: any) =>\n\t\t\t\t\tenter\n\t\t\t\t\t\t.append('circle')\n\t\t\t\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t\t\t\t.attr('aria-label', (d: any) => d[valueMapsTo]),\n\t\t\t\t(update: any) => update,\n\t\t\t\t(exit: any) => exit.remove()\n\t\t\t)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: kebabCase(d[angle])\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('cx', (d: any) => polarToCartesianCoords(xScale(d[angle]), yScale(d[value]), c).x)\n\t\t\t.attr('cy', (d: any) => polarToCartesianCoords(xScale(d[angle]), yScale(d[value]), c).y)\n\t\t\t.attr('r', 0)\n\t\t\t.attr('opacity', 0)\n\t\t\t.style('fill', (d: any) => colorScale(d[groupMapsTo]))\n\n\t\t// rectangles\n\t\tconst xAxesRect = DOMUtils.appendOrSelect(svg, 'g.x-axes-rect').attr('role', Roles.GROUP)\n\t\tconst xAxisRectUpdate = xAxesRect.selectAll('rect').data(this.uniqueKeys)\n\t\txAxisRectUpdate\n\t\t\t.join(\n\t\t\t\t(enter: any) => enter.append('rect'),\n\t\t\t\t(update: any) => update,\n\t\t\t\t(exit: any) => exit.remove()\n\t\t\t)\n\t\t\t.attr('x', c.x)\n\t\t\t.attr('y', c.y - xAxisRectHeight / 2)\n\t\t\t.attr('width', yScale.range()[1])\n\t\t\t.attr('height', xAxisRectHeight)\n\t\t\t.style('fill', 'red')\n\t\t\t.style('fill-opacity', 0)\n\t\t\t.attr('transform', (key: any) => `rotate(${radToDeg(xScale(key))}, ${c.x}, ${c.y})`)\n\n\t\t// y labels (show only the min and the max labels)\n\t\tconst { code: localeCode, number: numberFormatter } = getProperty(options, 'locale')\n\t\tconst yLabels = DOMUtils.appendOrSelect(svg, 'g.y-labels').attr('role', Roles.GROUP)\n\t\tconst yLabelUpdate = yLabels.selectAll('text').data(extent(yTicks))\n\t\tyLabelUpdate.join(\n\t\t\t(enter: any) =>\n\t\t\t\tenter\n\t\t\t\t\t.append('text')\n\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t.text((tick: any) => numberFormatter(tick, localeCode))\n\t\t\t\t\t.attr(\n\t\t\t\t\t\t'x',\n\t\t\t\t\t\t(tick: any) => polarToCartesianCoords(-Math.PI / 2, yScale(tick), c).x + yLabelPadding\n\t\t\t\t\t)\n\t\t\t\t\t.attr('y', (tick: any) => polarToCartesianCoords(-Math.PI / 2, yScale(tick), c).y)\n\t\t\t\t\t.style('text-anchor', 'start')\n\t\t\t\t\t.style('dominant-baseline', 'middle')\n\t\t\t\t\t.call((selection: any) =>\n\t\t\t\t\t\tselection\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\t\tname: 'radar_y_labels_enter',\n\t\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t),\n\t\t\t(update: any) =>\n\t\t\t\tupdate.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_y_labels_update',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.text((tick: any) => tick)\n\t\t\t\t\t\t.attr('opacity', 1)\n\t\t\t\t\t\t.attr(\n\t\t\t\t\t\t\t'x',\n\t\t\t\t\t\t\t(tick: any) => polarToCartesianCoords(-Math.PI / 2, yScale(tick), c).x + yLabelPadding\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('y', (tick: any) => polarToCartesianCoords(-Math.PI / 2, yScale(tick), c).y)\n\t\t\t\t),\n\t\t\t(exit: any) =>\n\t\t\t\texit.call((selection: any) =>\n\t\t\t\t\tselection\n\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\t\tname: 'radar_y_labels_exit',\n\t\t\t\t\t\t\t\tanimate\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr('opacity', 0)\n\t\t\t\t\t\t.remove()\n\t\t\t\t)\n\t\t)\n\n\t\t// Add event listeners\n\t\tthis.addEventListeners()\n\t}\n\n\tgetAlignmentXOffset(alignment: any, svg: any, parent: any) {\n\t\tconst svgDimensions = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseBBox: true\n\t\t})\n\t\tconst { width } = DOMUtils.getSVGElementSize(parent, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tlet alignmentOffset = 0\n\t\tif (alignment === Alignments.CENTER) {\n\t\t\talignmentOffset = Math.floor((width - svgDimensions.width) / 2)\n\t\t} else if (alignment === Alignments.RIGHT) {\n\t\t\talignmentOffset = width - svgDimensions.width\n\t\t}\n\n\t\treturn alignmentOffset\n\t}\n\n\t// append temporarily the label to get the exact space that it occupies\n\tgetLabelDimensions = (label: string) => {\n\t\tconst tmpTick = DOMUtils.appendOrSelect(this.getComponentContainer(), `g.tmp-tick`)\n\t\tconst tmpTickText = DOMUtils.appendOrSelect(tmpTick, `text`).text(label)\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(tmpTickText.node(), { useBBox: true })\n\t\ttmpTick.remove()\n\t\treturn { width, height }\n\t}\n\n\t// Given a flat array of objects, if there are missing data on key,\n\t// creates corresponding data with value = null\n\tnormalizeFlatData = (dataset: any) => {\n\t\tconst options = this.getOptions()\n\t\tconst { angle, value } = getProperty(options, 'radar', 'axes')\n\t\tconst groupMapsTo = getProperty(options, 'data', 'groupMapsTo')\n\t\tconst completeBlankData = flatMapDeep(\n\t\t\tthis.uniqueKeys.map((key: any) => {\n\t\t\t\treturn this.uniqueGroups.map(group => ({\n\t\t\t\t\t[angle]: key,\n\t\t\t\t\t[groupMapsTo]: group,\n\t\t\t\t\t[value]: null\n\t\t\t\t}))\n\t\t\t})\n\t\t)\n\t\treturn merge(completeBlankData, dataset)\n\t}\n\n\t// Given a a grouped array of objects, if there are missing data on key,\n\t// creates corresponding data with value = null\n\tnormalizeGroupedData = (dataset: any) => {\n\t\tconst options = this.getOptions()\n\t\tconst { angle, value } = getProperty(options, 'radar', 'axes')\n\t\tconst groupMapsTo = getProperty(options, 'data', 'groupMapsTo')\n\t\treturn dataset.map(({ name, data }: { name: any; data: any }) => {\n\t\t\tconst completeBlankData = this.uniqueKeys.map((k: any) => ({\n\t\t\t\t[groupMapsTo]: name,\n\t\t\t\t[angle]: k,\n\t\t\t\t[value]: null\n\t\t\t}))\n\t\t\treturn { name, data: merge(completeBlankData, data) }\n\t\t})\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tthis.parent\n\t\t\t.selectAll('g.blobs path')\n\t\t\t.transition('legend-hover-blob')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-blob'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill-opacity', (group: any) => {\n\t\t\t\tif (group.name !== hoveredElement.datum().name) {\n\t\t\t\t\treturn radarConfigs.opacity.unselected\n\t\t\t\t}\n\t\t\t\treturn radarConfigs.opacity.selected\n\t\t\t})\n\t\t\t.style('stroke-opacity', (group: any) => {\n\t\t\t\tif (group.name !== hoveredElement.datum().name) {\n\t\t\t\t\treturn radarConfigs.opacity.unselected\n\t\t\t\t}\n\t\t\t\treturn 1\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('g.blobs path')\n\t\t\t.transition('legend-mouseout-blob')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-blob'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill-opacity', radarConfigs.opacity.selected)\n\t\t\t.style('stroke-opacity', 1)\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('.x-axes-rect > rect')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tconst {\n\t\t\taxes: { angle }\n\t\t} = getProperty(this.getOptions(), 'radar')\n\n\t\t// events on x axes rects\n\t\tthis.parent\n\t\t\t.selectAll('.x-axes-rect > rect')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Radar.X_AXIS_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tconst axisLine = self.parent.select(`.x-axes .x-axis-${kebabCase(datum)}`)\n\t\t\t\tconst dots = self.parent.selectAll(`.dots circle.${kebabCase(datum)}`)\n\n\t\t\t\tconst activeDataGroupNames = self.model.getActiveDataGroupNames()\n\n\t\t\t\tconst options = self.getOptions()\n\t\t\t\tconst { groupMapsTo } = options.data\n\t\t\t\tconst valueMapsTo = getProperty(options, 'radar', 'axes', 'value')\n\n\t\t\t\t// Change style\n\t\t\t\taxisLine.classed('hovered', true).attr('stroke-dasharray', '4 4')\n\t\t\t\tdots\n\t\t\t\t\t.classed('hovered', true)\n\t\t\t\t\t.attr('opacity', (d: any) =>\n\t\t\t\t\t\tactiveDataGroupNames.indexOf(d[groupMapsTo]) !== -1 ? 1 : 0\n\t\t\t\t\t)\n\t\t\t\t\t.attr('r', radarConfigs.dotsRadius)\n\n\t\t\t\t// get the items that should be highlighted\n\t\t\t\tconst itemsToHighlight = self.fullDataNormalized.filter(\n\t\t\t\t\t(d: any) => d[angle] === datum && activeDataGroupNames.indexOf(d[groupMapsTo]) !== -1\n\t\t\t\t)\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: itemsToHighlight\n\t\t\t\t\t\t.filter((d: any) => typeof d[valueMapsTo] === 'number')\n\t\t\t\t\t\t.map((d: any) => ({\n\t\t\t\t\t\t\tlabel: d[groupMapsTo],\n\t\t\t\t\t\t\tvalue: d[valueMapsTo],\n\t\t\t\t\t\t\tcolor: self.model.getFillColor(d[groupMapsTo], null, d),\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\t\t\tdataGroupName: d[groupMapsTo]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}))\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Radar.X_AXIS_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Radar.X_AXIS_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tconst axisLine = self.parent.select(`.x-axes .x-axis-${kebabCase(datum)}`)\n\t\t\t\tconst dots = self.parent.selectAll(`.dots circle.${kebabCase(datum)}`)\n\n\t\t\t\t// Change style\n\t\t\t\taxisLine.classed('hovered', false).attr('stroke-dasharray', '0')\n\n\t\t\t\tdots.classed('hovered', false).attr('opacity', 0).attr('r', 0)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Radar.X_AXIS_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE)\n\t\t\t})\n\t}\n}\n","import { select } from 'd3'\nimport { generateSVGPathString } from '@/tools'\nimport { Bar } from './bar'\nimport { Events, RenderTypes, ColorClassNameTypes, CartesianOrientations } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class SimpleBar extends Bar {\n\ttype = 'simple-bar'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst data = this.model.getDisplayData(this.configs.groups)\n\n\t\tconst orientation = this.services.cartesianScales.getOrientation()\n\n\t\t// Update data on all bars\n\t\tconst bars = svg.selectAll('path.bar').data(data, (datum: any) => datum[groupMapsTo])\n\n\t\t// Remove bars that are no longer needed\n\t\tbars.exit().attr('opacity', 0).remove()\n\n\t\t// Add the paths that need to be introduced\n\t\tconst barsEnter = bars.enter().append('path').attr('opacity', 0)\n\n\t\tbarsEnter\n\t\t\t.merge(bars as any)\n\t\t\t.classed('bar', true)\n\t\t\t.attr('width', this.getBarWidth.bind(this))\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'bar-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\treturn this.model.getFillColor(d[groupMapsTo], d[domainIdentifier], d)\n\t\t\t})\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\t/*\n\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t */\n\t\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier()\n\t\t\t\tconst barWidth = this.getBarWidth()\n\t\t\t\tconst value = d[rangeIdentifier]\n\n\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(d) - barWidth / 2\n\t\t\t\tconst x1 = x0 + barWidth\n\t\t\t\tlet y0: number, y1: number\n\t\t\t\tif (Array.isArray(value) && value.length === 2) {\n\t\t\t\t\ty0 = this.services.cartesianScales.getRangeValue(value[0])\n\t\t\t\t\ty1 = this.services.cartesianScales.getRangeValue(value[1])\n\t\t\t\t} else {\n\t\t\t\t\tconst rangeScale = this.services.cartesianScales.getRangeScale()\n\t\t\t\t\tconst yScaleDomainStart = rangeScale.domain()[0] as number\n\n\t\t\t\t\ty0 = this.services.cartesianScales.getRangeValue(Math.max(0, yScaleDomainStart))\n\t\t\t\t\ty1 = this.services.cartesianScales.getRangeValue(d)\n\t\t\t\t}\n\n\t\t\t\tconst difference = Math.abs(y1 - y0)\n\t\t\t\t// Set a min-2px size for the bar\n\t\t\t\tif (difference !== 0 && difference < 2) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(value > 0 && orientation === CartesianOrientations.VERTICAL) ||\n\t\t\t\t\t\t(value < 0 && orientation === CartesianOrientations.HORIZONTAL)\n\t\t\t\t\t) {\n\t\t\t\t\t\ty1 = y0 - 2\n\t\t\t\t\t} else {\n\t\t\t\t\t\ty1 = y0 + 2\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// don't show if part of bar is out of zoom domain\n\t\t\t\tif (this.isOutsideZoomedDomain(x0, x1)) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\treturn generateSVGPathString({ x0, x1, y0, y1 }, orientation)\n\t\t\t})\n\t\t\t.attr('opacity', 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'bar')\n\t\t\t.attr('aria-label', (d: any) => d.value)\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-hover-simple-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-simple-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-mouseout-simple-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-simple-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\tdata: [datum]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","import type { ScaleLinear, Selection } from 'd3'\nimport { getProperty } from '@/tools'\nimport { Skeleton } from './skeleton'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\n\nexport class SkeletonLines extends Skeleton {\n\ttype = 'skeleton-lines'\n\txScale: ScaleLinear<number, number>\n\tyScale: ScaleLinear<number, number>\n\tbackdrop: Selection<SVGElement | HTMLDivElement, unknown, Element, any>\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst isDataLoading = getProperty(this.getOptions(), 'data', 'loading')\n\n\t\tconst isSparkline =\n\t\t\t!getProperty(this.getOptions(), 'grid', 'x', 'enabled') &&\n\t\t\t!getProperty(this.getOptions(), 'grid', 'y', 'enabled') &&\n\t\t\t!getProperty(this.getOptions(), 'axes', 'bottom', 'visible') &&\n\t\t\t!getProperty(this.getOptions(), 'axes', 'left', 'visible')\n\n\t\t// display a skeleton if there is no chart data or the loading flag is set to true\n\t\tif (isDataLoading && !isSparkline) {\n\t\t\tsuper.renderGridSkeleton(isDataLoading)\n\t\t} else if (isDataLoading && isSparkline) {\n\t\t\tthis.renderSparklineSkeleton(isDataLoading)\n\t\t} else {\n\t\t\tthis.removeSkeleton()\n\t\t}\n\t}\n\n\trenderSparklineSkeleton(showShimmerEffect: boolean) {\n\t\tthis.setScales()\n\t\tthis.drawBackdrop(showShimmerEffect)\n\t\tthis.drawSparkline(showShimmerEffect)\n\t\tthis.updateBackdropStyle()\n\t\tif (showShimmerEffect) {\n\t\t\tthis.setShimmerEffect('shimmer-lines')\n\t\t}\n\t}\n\n\tdrawSparkline(showShimmerEffect: boolean) {\n\t\tconst width = this.backdrop.attr('width')\n\t\tconst ticksValues = [100]\n\t\tconst sparklineSkeleton = DOMUtils.appendOrSelect(this.backdrop, 'g.y.skeleton')\n\t\tconst update = sparklineSkeleton.selectAll('line').data(ticksValues)\n\t\tupdate\n\t\t\t.enter()\n\t\t\t.append('line')\n\t\t\t.merge(update as any)\n\t\t\t.attr('x1', 0)\n\t\t\t.attr('x2', width)\n\t\t\t.attr('y1', (d: any) => d)\n\t\t\t.attr('y2', (d: any) => d)\n\n\t\tsparklineSkeleton\n\t\t\t.selectAll('line')\n\t\t\t.classed('shimmer-effect-lines', showShimmerEffect)\n\t\t\t.classed('empty-state-lines', !showShimmerEffect)\n\t\t\t.style(\n\t\t\t\t'stroke',\n\t\t\t\tshowShimmerEffect\n\t\t\t\t\t? `url(#${this.services.domUtils.generateElementIDString(`shimmer-lines`)})`\n\t\t\t\t\t: null\n\t\t\t)\n\t}\n\n\tupdateBackdropStyle() {\n\t\tconst svg = this.parent\n\n\t\tthis.backdrop = DOMUtils.appendOrSelect(svg, 'svg.chart-skeleton.DAII')\n\t\tconst backdropRect = DOMUtils.appendOrSelect(this.backdrop, 'rect.chart-skeleton-backdrop')\n\n\t\tbackdropRect\n\t\t\t.classed('shimmer-effect-lines', false)\n\t\t\t.classed('shimmer-effect-sparkline', true)\n\t\t\t.style('stroke', null)\n\t}\n}\n","import { area } from 'd3'\nimport { getProperty } from '@/tools'\nimport { area as areaConfigs } from '@/configuration'\nimport { Component } from '@/components/component'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class StackedArea extends Component {\n\ttype = 'area-stacked'\n\trenderType = RenderTypes.SVG\n\n\tareaGenerator: any\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct area on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight area on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tconst self = this\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst percentage = Object.keys(options.axes).some(axis => options.axes[axis].percentage)\n\n\t\tconst stackedData = this.model.getStackedData({\n\t\t\tpercentage,\n\t\t\tgroups: this.configs.groups\n\t\t})\n\t\tconst datum = getProperty(stackedData, 0, 0) as number[] // firstDatum name could not be used by getDomainAxisPosition() and getRangeAxisPosition() below\n\n\t\t// area doesn't have to use the main range and domain axes - they can be mapped to the secondary (in the case of a combo chart)\n\t\t// however area _cannot_ have multiple datasets that are mapped to _different_ ranges and domains so we can use the first data item\n\t\tconst domainAxisPosition = this.services.cartesianScales.getDomainAxisPosition({ datum })\n\t\tconst rangeAxisPosition = this.services.cartesianScales.getRangeAxisPosition({ datum })\n\t\tconst mainYScale = this.services.cartesianScales.getScaleByPosition(rangeAxisPosition)\n\n\t\tconst areas = svg\n\t\t\t.selectAll('path.area')\n\t\t\t.data(stackedData, (d: any) => getProperty(d, 0, groupMapsTo))\n\n\t\t// D3 area generator function\n\t\tthis.areaGenerator = area()\n\t\t\t.x((d: any) =>\n\t\t\t\tthis.services.cartesianScales.getValueThroughAxisPosition(\n\t\t\t\t\tdomainAxisPosition,\n\t\t\t\t\td.data.sharedStackKey\n\t\t\t\t)\n\t\t\t)\n\t\t\t.y0((d: any) => mainYScale(d[0]))\n\t\t\t.y1((d: any) => mainYScale(d[1]))\n\t\t\t.curve(this.services.curves.getD3Curve())\n\n\t\tareas.exit().attr('opacity', 0).remove()\n\n\t\tconst enteringAreas = areas.enter().append('path').attr('opacity', 0)\n\n\t\tenteringAreas\n\t\t\t.merge(areas as any)\n\t\t\t.data(stackedData, (d: any) => getProperty(d, 0, groupMapsTo))\n\t\t\t.attr('class', 'area')\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: getProperty(d, 0, groupMapsTo),\n\t\t\t\t\toriginalClassName: 'area'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) => self.model.getFillColor(getProperty(d, 0, groupMapsTo), null, d))\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'area')\n\t\t\t.attr('aria-label', (d: any) => getProperty(d, 0, groupMapsTo))\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'area-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', areaConfigs.opacity.selected)\n\t\t\t.attr('d', this.areaGenerator)\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.area')\n\t\t\t.transition('legend-hover-area')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-area'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => {\n\t\t\t\tif (getProperty(d, 0, groupMapsTo) !== hoveredElement.datum().name) {\n\t\t\t\t\treturn areaConfigs.opacity.unselected\n\t\t\t\t}\n\n\t\t\t\treturn areaConfigs.opacity.selected\n\t\t\t})\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.area')\n\t\t\t.transition('legend-mouseout-area')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-area'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', areaConfigs.opacity.selected)\n\t}\n}\n","import { select } from 'd3'\nimport { generateSVGPathString, getProperty } from '@/tools'\nimport { Bar } from './bar'\nimport { Events, CartesianOrientations, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\n\nexport class StackedBar extends Bar {\n\ttype = 'stacked-bar'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct circle on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight circles on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate: boolean) {\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\t// Chart options mixed with the internal configurations\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\t// Create the data and keys that'll be used by the stack layout\n\t\tconst stackData = this.model.getStackedData({\n\t\t\tgroups: this.configs.groups,\n\t\t\tdivergent: true\n\t\t})\n\n\t\tconst activeDataGroupNames = this.model.getActiveDataGroupNames()\n\n\t\t// Update data on all bar groups\n\t\tconst barGroups = svg\n\t\t\t.selectAll('g.bars')\n\t\t\t.data(stackData, (d: any) => getProperty(d, 0, groupMapsTo))\n\n\t\t// Remove elements that need to be exited\n\t\t// We need exit at the top here to make sure that\n\t\t// Data filters are processed before entering new elements\n\t\t// Or updating existing ones\n\t\tbarGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add bar groups that need to be introduced\n\t\tbarGroups\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.classed('bars', true)\n\t\t\t.attr('role', Roles.GROUP)\n\t\t\t.attr('data-name', 'bars')\n\n\t\t// Update data on all bars\n\t\tconst bars = svg\n\t\t\t.selectAll('g.bars')\n\t\t\t.selectAll('path.bar')\n\t\t\t.data(\n\t\t\t\t(d: any) => d,\n\t\t\t\t(d: any) => d.data.sharedStackKey\n\t\t\t)\n\n\t\t// Remove bars that need to be removed\n\t\tbars.exit().remove()\n\n\t\tbars\n\t\t\t.enter()\n\t\t\t.append('path')\n\t\t\t.merge(bars as any)\n\t\t\t.classed('bar', true)\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'bar-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('class', (d: any) =>\n\t\t\t\tthis.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\toriginalClassName: 'bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.style('fill', (d: any) =>\n\t\t\t\tthis.model.getFillColor(d[groupMapsTo], d.data.sharedStackKey, d.data)\n\t\t\t)\n\t\t\t.attr('d', (d: any) => {\n\t\t\t\tconst key = d.data.sharedStackKey as string\n\n\t\t\t\t/*\n\t\t\t\t * Orientation support for horizontal/vertical bar charts\n\t\t\t\t * Determine coordinates needed for a vertical set of paths\n\t\t\t\t * to draw the bars needed, and pass those coordinates down to\n\t\t\t\t * generateSVGPathString() to decide whether it needs to flip them\n\t\t\t\t */\n\t\t\t\tconst barWidth = this.getBarWidth()\n\t\t\t\tconst x0 = this.services.cartesianScales.getDomainValue(key) - barWidth / 2\n\t\t\t\tconst x1 = x0 + barWidth\n\t\t\t\tconst y0 = this.services.cartesianScales.getRangeValue(d[0])\n\t\t\t\tlet y1 = this.services.cartesianScales.getRangeValue(d[1])\n\n\t\t\t\t// don't show if part of bar is out of zoom domain\n\t\t\t\tif (this.isOutsideZoomedDomain(x0, x1)) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// Add the divider gap\n\t\t\t\tif (Math.abs(y1 - y0) > 0 && Math.abs(y1 - y0) > options.bars.dividerSize) {\n\t\t\t\t\tconst barIsNegative = d[0] < 0 && d[1] <= 0\n\t\t\t\t\tif (barIsNegative && activeDataGroupNames.length > 1) {\n\t\t\t\t\t\tif (this.services.cartesianScales.getOrientation() === CartesianOrientations.VERTICAL) {\n\t\t\t\t\t\t\ty1 += d[1] === 0 ? 2 : 1\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ty1 -= 1\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!barIsNegative) {\n\t\t\t\t\t\tif (this.services.cartesianScales.getOrientation() === CartesianOrientations.VERTICAL) {\n\t\t\t\t\t\t\ty1 += 1\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ty1 -= 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn generateSVGPathString(\n\t\t\t\t\t{ x0, x1, y0, y1 },\n\t\t\t\t\tthis.services.cartesianScales.getOrientation()\n\t\t\t\t)\n\t\t\t})\n\t\t\t.attr('opacity', 1)\n\t\t\t// a11y\n\t\t\t.attr('role', Roles.GRAPHICS_SYMBOL)\n\t\t\t.attr('aria-roledescription', 'bar')\n\t\t\t.attr('aria-label', (d: any) => d[1] - d[0])\n\n\t\t// Add event listeners for the above elements\n\t\tthis.addEventListeners()\n\t}\n\n\t// Highlight elements that match the hovered legend item\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tconst { groupMapsTo } = this.model.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-hover-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\t// Un-highlight all elements\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.transition('legend-mouseout-bar')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-bar'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', true)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tconst displayData = self.model.getDisplayData(self.configs.groups)\n\n\t\t\t\tlet matchingDataPoint = displayData.find((d: any) => {\n\t\t\t\t\tconst domainIdentifier = self.services.cartesianScales.getDomainIdentifier(d)\n\t\t\t\t\tconst rangeIdentifier = self.services.cartesianScales.getRangeIdentifier(d)\n\t\t\t\t\treturn (\n\t\t\t\t\t\td[rangeIdentifier] === datum.data[datum[groupMapsTo]] &&\n\t\t\t\t\t\td[domainIdentifier].toString() === datum.data.sharedStackKey &&\n\t\t\t\t\t\td[groupMapsTo] === datum[groupMapsTo]\n\t\t\t\t\t)\n\t\t\t\t})\n\n\t\t\t\tif (matchingDataPoint === undefined) {\n\t\t\t\t\t// use the primary range and domain ids\n\t\t\t\t\tconst domainIdentifier = self.services.cartesianScales.getDomainIdentifier()\n\t\t\t\t\tconst rangeIdentifier = self.services.cartesianScales.getRangeIdentifier()\n\t\t\t\t\tmatchingDataPoint = {\n\t\t\t\t\t\t[domainIdentifier]: datum.data.sharedStackKey,\n\t\t\t\t\t\t[rangeIdentifier]: datum.data[datum[groupMapsTo]],\n\t\t\t\t\t\t[groupMapsTo]: datum[groupMapsTo]\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\tdata: [matchingDataPoint]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Bar.BAR_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\tprotected getBarWidth() {\n\t\tconst options = this.getOptions()\n\t\tif (getProperty(options, 'bars', 'width')) {\n\t\t\treturn options.bars.width as number\n\t\t}\n\t\tconst mainXScale = this.services.cartesianScales.getMainXScale()\n\t\tconst chartWidth = DOMUtils.getSVGElementSize((this as any).parent, {\n\t\t\tuseAttrs: true\n\t\t}).width\n\n\t\tconst numberOfDomainValues = this.model.getStackKeys().length\n\n\t\tconst spacingFactor = getProperty(options, 'bars', 'spacingFactor')\n\n\t\tif (!(mainXScale as any).step) {\n\t\t\treturn Math.min(options.bars.maxWidth, (chartWidth * spacingFactor) / numberOfDomainValues)\n\t\t}\n\t\treturn Math.min(options.bars.maxWidth, (mainXScale as any).step() / 2)\n\t}\n\n\tdestroy() {\n\t\t// Remove event listeners\n\t\tthis.parent\n\t\t\t.selectAll('path.bar')\n\t\t\t.on('mouseover', null)\n\t\t\t.on('mousemove', null)\n\t\t\t.on('mouseout', null)\n\n\t\t// Remove legend listeners\n\t\tconst eventsFragment = this.services.events\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\teventsFragment.removeEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n}\n","import { getProperty } from '@/tools'\nimport { Scatter } from './scatter'\nimport { RenderTypes } from '@/interfaces/enums'\nimport { Roles } from '@/interfaces/a11y'\n\nexport class StackedScatter extends Scatter {\n\ttype = 'scatter-stacked'\n\trenderType = RenderTypes.SVG\n\n\trender(animate: boolean) {\n\t\tconst isScatterEnabled = getProperty(this.getOptions(), 'points', 'enabled')\n\t\tif (!isScatterEnabled) {\n\t\t\treturn\n\t\t}\n\t\t// Grab container SVG\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst percentage = Object.keys(options.axes).some(axis => options.axes[axis].percentage)\n\t\tconst stackedData = this.model.getStackedData({\n\t\t\tgroups: this.configs.groups,\n\t\t\tpercentage\n\t\t})\n\n\t\t// Update data on dot groups\n\t\tconst circleGroups = svg\n\t\t\t.selectAll('g.dots')\n\t\t\t.data(stackedData, (d: any) => getProperty(d, 0, groupMapsTo))\n\n\t\t// Remove dot groups that need to be removed\n\t\tcircleGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the dot groups that need to be introduced\n\t\tconst circleGroupsEnter = circleGroups\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.classed('dots', true)\n\t\t\t.attr('role', Roles.GROUP)\n\n\t\t// Update data on all circles\n\t\tconst circles = circleGroupsEnter\n\t\t\t.merge(circleGroups as any)\n\t\t\t.selectAll('circle.dot')\n\t\t\t.data((d: any) => d)\n\n\t\t// Remove circles that need to be removed\n\t\tcircles.exit().attr('opacity', 0).remove()\n\n\t\t// Add the dot groups that need to be introduced\n\t\tconst enteringCircles = circles.enter().append('circle').classed('dot', true).attr('opacity', 0)\n\n\t\t// Apply styling & position\n\t\tconst circlesToStyle = enteringCircles.merge(circles as any).datum((d: any) => {\n\t\t\tconst group = d[groupMapsTo]\n\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(d)\n\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(d)\n\n\t\t\treturn {\n\t\t\t\t[groupMapsTo]: group,\n\t\t\t\t[domainIdentifier]: d['data']['sharedStackKey'],\n\t\t\t\t[rangeIdentifier]: d[1]\n\t\t\t}\n\t\t})\n\t\tthis.styleCircles(circlesToStyle, animate)\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\tgetTooltipData(hoveredX: number, hoveredY: number) {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst percentage = Object.keys(options.axes).some(axis => options.axes[axis].percentage)\n\t\tconst stackedData = this.model.getStackedData({\n\t\t\tgroups: this.configs.groups,\n\t\t\tpercentage\n\t\t})\n\t\tconst tooltipData: any[] = []\n\t\tstackedData.forEach((groupData: any, groupDataIndex: any) => {\n\t\t\tgroupData.forEach((datum: any, dataIndex: number) => {\n\t\t\t\tconst group = datum[groupMapsTo]\n\t\t\t\tconst domainValue = datum['data']['sharedStackKey']\n\t\t\t\tlet rangeValue = datum['data'][group]\n\t\t\t\tconst stackedRangeValue = datum[1]\n\t\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(datum)\n\t\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(datum)\n\n\t\t\t\tif (\n\t\t\t\t\trangeValue !== null &&\n\t\t\t\t\trangeValue !== undefined &&\n\t\t\t\t\thoveredX === this.services.cartesianScales.getDomainValue(domainValue) &&\n\t\t\t\t\thoveredY === this.services.cartesianScales.getRangeValue(stackedRangeValue)\n\t\t\t\t) {\n\t\t\t\t\tif (percentage) {\n\t\t\t\t\t\trangeValue = this.model.getStackedData({\n\t\t\t\t\t\t\tgroups: this.configs.groups\n\t\t\t\t\t\t})[groupDataIndex][dataIndex]['data'][group]\n\t\t\t\t\t}\n\n\t\t\t\t\tif (rangeValue !== null) {\n\t\t\t\t\t\ttooltipData.push({\n\t\t\t\t\t\t\t[groupMapsTo]: group,\n\t\t\t\t\t\t\t[domainIdentifier]: domainValue,\n\t\t\t\t\t\t\t[rangeIdentifier]: rangeValue\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\n\t\treturn this.model.getDisplayData(this.configs.groups).filter((datapoint: any) => {\n\t\t\tconst domainIdentifier = this.services.cartesianScales.getDomainIdentifier(datapoint)\n\t\t\tconst rangeIdentifier = this.services.cartesianScales.getRangeIdentifier(datapoint)\n\t\t\treturn (\n\t\t\t\ttooltipData.find(tooltipDatapoint => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\ttooltipDatapoint[groupMapsTo] == datapoint[groupMapsTo] &&\n\t\t\t\t\t\ttooltipDatapoint[domainIdentifier] == datapoint[domainIdentifier] &&\n\t\t\t\t\t\ttooltipDatapoint[rangeIdentifier] == datapoint[rangeIdentifier]\n\t\t\t\t\t)\n\t\t\t\t}) !== undefined\n\t\t\t)\n\t\t})\n\t}\n}\n","import { cluster as d3Cluster, tree as d3Tree, hierarchy, linkHorizontal, select } from 'd3'\nimport { getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, RenderTypes, TreeTypes } from '@/interfaces/enums'\nimport type { Coordinates } from '@/interfaces/layout'\n\nconst NODE_OFFSET = 6\n\nexport class Tree extends Component {\n\ttype = 'tree'\n\trenderType = RenderTypes.SVG\n\n\tgetLongestLabel(data: any) {\n\t\tlet longestLabel = ''\n\t\tdata.forEach((d: any) => {\n\t\t\tconst longestLabelInChildren = d.children ? this.getLongestLabel(d.children) : ''\n\t\t\tif (\n\t\t\t\tlongestLabelInChildren.length > longestLabel.length ||\n\t\t\t\td.name.length > longestLabel.length\n\t\t\t) {\n\t\t\t\tlongestLabel =\n\t\t\t\t\tlongestLabelInChildren.length > d.name.length ? longestLabelInChildren : d.name\n\t\t\t}\n\t\t})\n\n\t\treturn longestLabel\n\t}\n\n\tgetMockLabelWidth(svg: any, label: string) {\n\t\t// Add mock label to get dimensions\n\t\tconst mockLabel = svg\n\t\t\t.append('text')\n\t\t\t.attr('dy', '0.31em')\n\t\t\t.attr('x', 0)\n\t\t\t.attr('text-anchor', 'end')\n\t\t\t.text(label)\n\n\t\t// Get the mock label width\n\t\tconst { width: mockLabelWidth } = DOMUtils.getSVGElementSize(mockLabel.node(), {\n\t\t\tuseBBox: true\n\t\t})\n\n\t\t// Remove the mock title label\n\t\tmockLabel.remove()\n\n\t\treturn mockLabelWidth\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer()\n\n\t\t// Empty out the svg before rendering the tree\n\t\tsvg.html('')\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(this.parent as any, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tif (width < 1 || height < 1) {\n\t\t\treturn\n\t\t}\n\n\t\tconst options = this.model.getOptions()\n\t\tconst displayData = this.model.getDisplayData()\n\n\t\tconst rootTitle = getProperty(options, 'tree', 'rootTitle') || 'Tree'\n\n\t\tconst mockRootTitleWidth = this.getMockLabelWidth(svg, rootTitle)\n\n\t\tconst longestLabel = this.getLongestLabel(displayData)\n\t\tconst mockLongestLabelWidth = this.getMockLabelWidth(svg, longestLabel)\n\n\t\tconst margin = {\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: mockRootTitleWidth > 0 ? mockRootTitleWidth + NODE_OFFSET : 30 - NODE_OFFSET\n\t\t}\n\t\tconst root = hierarchy({\n\t\t\tname: rootTitle,\n\t\t\tchildren: displayData\n\t\t}) as any\n\n\t\tconst dx = 10\n\t\tconst dy = width / 6\n\n\t\tconst update = (source: Coordinates) => {\n\t\t\tconst nodes = root.descendants().reverse()\n\t\t\tconst links = root.links()\n\n\t\t\tlet left = root\n\t\t\tlet right = root\n\t\t\troot.eachBefore((node: Coordinates) => {\n\t\t\t\tif (node.x < left.x) left = node\n\t\t\t\tif (node.x > right.x) right = node\n\t\t\t})\n\n\t\t\tconst updateHeight = right.x - left.x\n\n\t\t\tconst transition = svg\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'tree-update-viewbox',\n\t\t\t\t\t\tanimate: true\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('viewBox', [-margin.left, left.x, width, updateHeight].join(' ')) // viewBox expects a delimited string\n\n\t\t\t// Update data on nodes\n\t\t\tconst nodeGroups = nodeGroup.selectAll('g').data(nodes, (d: any) => d.id)\n\n\t\t\tconst self = this\n\t\t\t// Add any entering nodes\n\t\t\tconst nodeGroupsEnter = nodeGroups\n\t\t\t\t.enter()\n\t\t\t\t.append('g')\n\t\t\t\t.attr('transform', () => `translate(${source.y0},${source.x0})`)\n\t\t\t\t.attr('class', (d: any) =>\n\t\t\t\t\td.depth !== 0 && d.children && d.children.length > 0 ? 'clickable' : null\n\t\t\t\t)\n\t\t\t\t.on('mouseover', function (event: MouseEvent, d: any) {\n\t\t\t\t\t// Dispatch mouse event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tree.NODE_MOUSEOVER, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: select(this),\n\t\t\t\t\t\tdatum: d\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('click', function (event: MouseEvent, d: any) {\n\t\t\t\t\tif (d.depth !== 0) {\n\t\t\t\t\t\td.children = d.children ? null : d._children\n\n\t\t\t\t\t\tupdate(d)\n\t\t\t\t\t}\n\n\t\t\t\t\t// Dispatch mouse event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tree.NODE_CLICK, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: select(this),\n\t\t\t\t\t\tdatum: d\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function (event: MouseEvent, d: any) {\n\t\t\t\t\t// Dispatch mouse event\n\t\t\t\t\tself.services.events.dispatchEvent(Events.Tree.NODE_MOUSEOUT, {\n\t\t\t\t\t\tevent,\n\t\t\t\t\t\telement: select(this),\n\t\t\t\t\t\tdatum: d\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\t// Add node circles to entering nodes\n\t\t\tnodeGroupsEnter\n\t\t\t\t.append('circle')\n\t\t\t\t.attr('r', 2.5)\n\t\t\t\t.attr('class', (d: any) => (d._children ? 'parent' : 'child'))\n\t\t\t\t.attr('stroke-width', 10)\n\n\t\t\t// Add node labels\n\t\t\tnodeGroupsEnter\n\t\t\t\t.append('text')\n\t\t\t\t.attr('dy', '0.31em')\n\t\t\t\t.attr('x', (d: any) => (d._children ? -NODE_OFFSET : NODE_OFFSET))\n\t\t\t\t.attr('text-anchor', (d: any) => (d._children ? 'end' : 'start'))\n\t\t\t\t.text((d: any) => d.data.name)\n\t\t\t\t.clone(true)\n\t\t\t\t.attr('class', 'text-stroke')\n\t\t\t\t.lower()\n\n\t\t\t// Reposition nodes\n\t\t\tnodeGroups\n\t\t\t\t.merge(nodeGroupsEnter)\n\t\t\t\t.transition(transition)\n\t\t\t\t.attr('transform', (d: Coordinates) => `translate(${d.y},${d.x})`)\n\t\t\t\t.attr('fill-opacity', 1)\n\t\t\t\t.attr('stroke-opacity', 1)\n\n\t\t\t// Remove exiting nodes\n\t\t\tnodeGroups\n\t\t\t\t.exit()\n\t\t\t\t.transition(transition)\n\t\t\t\t.remove()\n\t\t\t\t.attr('transform', () => `translate(${source.y},${source.x})`)\n\t\t\t\t.attr('fill-opacity', 0)\n\t\t\t\t.attr('stroke-opacity', 0)\n\n\t\t\t// Update data on links\n\t\t\tconst linkPaths = linkGroup.selectAll('path').data(links, (d: any) => d.target.id)\n\n\t\t\t// Add any entering link paths\n\t\t\tconst linkPathsEnter = linkPaths\n\t\t\t\t.enter()\n\t\t\t\t.append('path')\n\t\t\t\t.attr('d', () => {\n\t\t\t\t\tconst o = { x: source.x0, y: source.y0 }\n\t\t\t\t\treturn diagonal({ source: o, target: o })\n\t\t\t\t})\n\n\t\t\t// Reposition updating link paths\n\t\t\tlinkPaths.merge(linkPathsEnter).transition(transition).attr('d', diagonal)\n\n\t\t\t// Remove any exiting link paths\n\t\t\tlinkPaths\n\t\t\t\t.exit()\n\t\t\t\t.transition(transition)\n\t\t\t\t.remove()\n\t\t\t\t.attr('d', () => {\n\t\t\t\t\tconst o = { x: source.x, y: source.y }\n\t\t\t\t\treturn diagonal({ source: o, target: o })\n\t\t\t\t})\n\n\t\t\t// Update position data for nodes\n\t\t\troot.eachBefore((d: Coordinates) => {\n\t\t\t\td.x0 = d.x\n\t\t\t\td.y0 = d.y\n\t\t\t})\n\t\t}\n\n\t\tconst descendants = root.descendants()\n\t\tconst maxDepth = descendants[descendants.length - 1].depth\n\n\t\tconst tree =\n\t\t\tgetProperty(options, 'tree', 'type') === TreeTypes.DENDROGRAM\n\t\t\t\t? d3Cluster().size([\n\t\t\t\t\t\theight,\n\t\t\t\t\t\twidth - mockLongestLabelWidth - maxDepth * NODE_OFFSET - mockRootTitleWidth\n\t\t\t\t\t])\n\t\t\t\t: d3Tree()\n\t\t\t\t\t\t.nodeSize([dx, dy])\n\t\t\t\t\t\t.size([\n\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\twidth - mockLongestLabelWidth - maxDepth * NODE_OFFSET - mockRootTitleWidth\n\t\t\t\t\t\t])\n\n\t\tconst diagonal = linkHorizontal()\n\t\t\t.x((d: any) => d.y)\n\t\t\t.y((d: any) => d.x) as any\n\n\t\troot.x0 = dy / 2\n\t\troot.y0 = 0\n\t\troot.descendants().forEach((d: any, i: number) => {\n\t\t\td.id = i\n\t\t\td._children = d.children\n\t\t})\n\n\t\ttree(root)\n\n\t\tsvg.attr('viewBox', [-margin.left, -margin.top, width, dx]).style('user-select', 'none')\n\n\t\tconst linkGroup = svg.append('g').attr('class', 'links')\n\t\tconst nodeGroup = svg.append('g').attr('class', 'nodes')\n\n\t\tupdate(root)\n\t}\n}\n","/**\n * Copyright IBM Corp. 2018, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar black = '#000000';\nvar black100 = black;\nvar blackHover = '#212121';\nvar white = '#ffffff';\nvar white0 = white;\nvar whiteHover = '#e8e8e8';\nvar yellow10 = '#fcf4d6';\nvar yellow20 = '#fddc69';\nvar yellow30 = '#f1c21b';\nvar yellow40 = '#d2a106';\nvar yellow50 = '#b28600';\nvar yellow60 = '#8e6a00';\nvar yellow70 = '#684e00';\nvar yellow80 = '#483700';\nvar yellow90 = '#302400';\nvar yellow100 = '#1c1500';\nvar yellow = {\n  10: yellow10,\n  20: yellow20,\n  30: yellow30,\n  40: yellow40,\n  50: yellow50,\n  60: yellow60,\n  70: yellow70,\n  80: yellow80,\n  90: yellow90,\n  100: yellow100\n};\nvar yellow10Hover = '#f8e6a0';\nvar yellow20Hover = '#fccd27';\nvar yellow30Hover = '#ddb00e';\nvar yellow40Hover = '#bc9005';\nvar yellow50Hover = '#9e7700';\nvar yellow60Hover = '#755800';\nvar yellow70Hover = '#806000';\nvar yellow80Hover = '#5c4600';\nvar yellow90Hover = '#3d2e00';\nvar yellow100Hover = '#332600';\nvar yellowHover = {\n  10: yellow10Hover,\n  20: yellow20Hover,\n  30: yellow30Hover,\n  40: yellow40Hover,\n  50: yellow50Hover,\n  60: yellow60Hover,\n  70: yellow70Hover,\n  80: yellow80Hover,\n  90: yellow90Hover,\n  100: yellow100Hover\n};\nvar orange10 = '#fff2e8';\nvar orange20 = '#ffd9be';\nvar orange30 = '#ffb784';\nvar orange40 = '#ff832b';\nvar orange50 = '#eb6200';\nvar orange60 = '#ba4e00';\nvar orange70 = '#8a3800';\nvar orange80 = '#5e2900';\nvar orange90 = '#3e1a00';\nvar orange100 = '#231000';\nvar orange = {\n  10: orange10,\n  20: orange20,\n  30: orange30,\n  40: orange40,\n  50: orange50,\n  60: orange60,\n  70: orange70,\n  80: orange80,\n  90: orange90,\n  100: orange100\n};\nvar orange10Hover = '#ffe2cc';\nvar orange20Hover = '#ffc69e';\nvar orange30Hover = '#ff9d57';\nvar orange40Hover = '#fa6800';\nvar orange50Hover = '#cc5500';\nvar orange60Hover = '#9e4200';\nvar orange70Hover = '#a84400';\nvar orange80Hover = '#753300';\nvar orange90Hover = '#522200';\nvar orange100Hover = '#421e00';\nvar orangeHover = {\n  10: orange10Hover,\n  20: orange20Hover,\n  30: orange30Hover,\n  40: orange40Hover,\n  50: orange50Hover,\n  60: orange60Hover,\n  70: orange70Hover,\n  80: orange80Hover,\n  90: orange90Hover,\n  100: orange100Hover\n};\nvar red10 = '#fff1f1';\nvar red20 = '#ffd7d9';\nvar red30 = '#ffb3b8';\nvar red40 = '#ff8389';\nvar red50 = '#fa4d56';\nvar red60 = '#da1e28';\nvar red70 = '#a2191f';\nvar red80 = '#750e13';\nvar red90 = '#520408';\nvar red100 = '#2d0709';\nvar red = {\n  10: red10,\n  20: red20,\n  30: red30,\n  40: red40,\n  50: red50,\n  60: red60,\n  70: red70,\n  80: red80,\n  90: red90,\n  100: red100\n};\nvar red100Hover = '#540d11';\nvar red90Hover = '#66050a';\nvar red80Hover = '#921118';\nvar red70Hover = '#c21e25';\nvar red60Hover = '#b81922';\nvar red50Hover = '#ee0713';\nvar red40Hover = '#ff6168';\nvar red30Hover = '#ff99a0';\nvar red20Hover = '#ffc2c5';\nvar red10Hover = '#ffe0e0';\nvar redHover = {\n  100: red100Hover,\n  90: red90Hover,\n  80: red80Hover,\n  70: red70Hover,\n  60: red60Hover,\n  50: red50Hover,\n  40: red40Hover,\n  30: red30Hover,\n  20: red20Hover,\n  10: red10Hover\n};\nvar magenta10 = '#fff0f7';\nvar magenta20 = '#ffd6e8';\nvar magenta30 = '#ffafd2';\nvar magenta40 = '#ff7eb6';\nvar magenta50 = '#ee5396';\nvar magenta60 = '#d02670';\nvar magenta70 = '#9f1853';\nvar magenta80 = '#740937';\nvar magenta90 = '#510224';\nvar magenta100 = '#2a0a18';\nvar magenta = {\n  10: magenta10,\n  20: magenta20,\n  30: magenta30,\n  40: magenta40,\n  50: magenta50,\n  60: magenta60,\n  70: magenta70,\n  80: magenta80,\n  90: magenta90,\n  100: magenta100\n};\nvar magenta100Hover = '#53142f';\nvar magenta90Hover = '#68032e';\nvar magenta80Hover = '#8e0b43';\nvar magenta70Hover = '#bf1d63';\nvar magenta60Hover = '#b0215f';\nvar magenta50Hover = '#e3176f';\nvar magenta40Hover = '#ff57a0';\nvar magenta30Hover = '#ff94c3';\nvar magenta20Hover = '#ffbdda';\nvar magenta10Hover = '#ffe0ef';\nvar magentaHover = {\n  100: magenta100Hover,\n  90: magenta90Hover,\n  80: magenta80Hover,\n  70: magenta70Hover,\n  60: magenta60Hover,\n  50: magenta50Hover,\n  40: magenta40Hover,\n  30: magenta30Hover,\n  20: magenta20Hover,\n  10: magenta10Hover\n};\nvar purple10 = '#f6f2ff';\nvar purple20 = '#e8daff';\nvar purple30 = '#d4bbff';\nvar purple40 = '#be95ff';\nvar purple50 = '#a56eff';\nvar purple60 = '#8a3ffc';\nvar purple70 = '#6929c4';\nvar purple80 = '#491d8b';\nvar purple90 = '#31135e';\nvar purple100 = '#1c0f30';\nvar purple = {\n  10: purple10,\n  20: purple20,\n  30: purple30,\n  40: purple40,\n  50: purple50,\n  60: purple60,\n  70: purple70,\n  80: purple80,\n  90: purple90,\n  100: purple100\n};\nvar purple100Hover = '#341c59';\nvar purple90Hover = '#40197b';\nvar purple80Hover = '#5b24ad';\nvar purple70Hover = '#7c3dd6';\nvar purple60Hover = '#7822fb';\nvar purple50Hover = '#9352ff';\nvar purple40Hover = '#ae7aff';\nvar purple30Hover = '#c5a3ff';\nvar purple20Hover = '#dcc7ff';\nvar purple10Hover = '#ede5ff';\nvar purpleHover = {\n  100: purple100Hover,\n  90: purple90Hover,\n  80: purple80Hover,\n  70: purple70Hover,\n  60: purple60Hover,\n  50: purple50Hover,\n  40: purple40Hover,\n  30: purple30Hover,\n  20: purple20Hover,\n  10: purple10Hover\n};\nvar blue10 = '#edf5ff';\nvar blue20 = '#d0e2ff';\nvar blue30 = '#a6c8ff';\nvar blue40 = '#78a9ff';\nvar blue50 = '#4589ff';\nvar blue60 = '#0f62fe';\nvar blue70 = '#0043ce';\nvar blue80 = '#002d9c';\nvar blue90 = '#001d6c';\nvar blue100 = '#001141';\nvar blue = {\n  10: blue10,\n  20: blue20,\n  30: blue30,\n  40: blue40,\n  50: blue50,\n  60: blue60,\n  70: blue70,\n  80: blue80,\n  90: blue90,\n  100: blue100\n};\nvar blue100Hover = '#001f75';\nvar blue90Hover = '#00258a';\nvar blue80Hover = '#0039c7';\nvar blue70Hover = '#0053ff';\nvar blue60Hover = '#0050e6';\nvar blue50Hover = '#1f70ff';\nvar blue40Hover = '#5c97ff';\nvar blue30Hover = '#8ab6ff';\nvar blue20Hover = '#b8d3ff';\nvar blue10Hover = '#dbebff';\nvar blueHover = {\n  100: blue100Hover,\n  90: blue90Hover,\n  80: blue80Hover,\n  70: blue70Hover,\n  60: blue60Hover,\n  50: blue50Hover,\n  40: blue40Hover,\n  30: blue30Hover,\n  20: blue20Hover,\n  10: blue10Hover\n};\nvar cyan10 = '#e5f6ff';\nvar cyan20 = '#bae6ff';\nvar cyan30 = '#82cfff';\nvar cyan40 = '#33b1ff';\nvar cyan50 = '#1192e8';\nvar cyan60 = '#0072c3';\nvar cyan70 = '#00539a';\nvar cyan80 = '#003a6d';\nvar cyan90 = '#012749';\nvar cyan100 = '#061727';\nvar cyan = {\n  10: cyan10,\n  20: cyan20,\n  30: cyan30,\n  40: cyan40,\n  50: cyan50,\n  60: cyan60,\n  70: cyan70,\n  80: cyan80,\n  90: cyan90,\n  100: cyan100\n};\nvar cyan10Hover = '#cceeff';\nvar cyan20Hover = '#99daff';\nvar cyan30Hover = '#57beff';\nvar cyan40Hover = '#059fff';\nvar cyan50Hover = '#0f7ec8';\nvar cyan60Hover = '#005fa3';\nvar cyan70Hover = '#0066bd';\nvar cyan80Hover = '#00498a';\nvar cyan90Hover = '#013360';\nvar cyan100Hover = '#0b2947';\nvar cyanHover = {\n  10: cyan10Hover,\n  20: cyan20Hover,\n  30: cyan30Hover,\n  40: cyan40Hover,\n  50: cyan50Hover,\n  60: cyan60Hover,\n  70: cyan70Hover,\n  80: cyan80Hover,\n  90: cyan90Hover,\n  100: cyan100Hover\n};\nvar teal10 = '#d9fbfb';\nvar teal20 = '#9ef0f0';\nvar teal30 = '#3ddbd9';\nvar teal40 = '#08bdba';\nvar teal50 = '#009d9a';\nvar teal60 = '#007d79';\nvar teal70 = '#005d5d';\nvar teal80 = '#004144';\nvar teal90 = '#022b30';\nvar teal100 = '#081a1c';\nvar teal = {\n  10: teal10,\n  20: teal20,\n  30: teal30,\n  40: teal40,\n  50: teal50,\n  60: teal60,\n  70: teal70,\n  80: teal80,\n  90: teal90,\n  100: teal100\n};\nvar teal10Hover = '#acf6f6';\nvar teal20Hover = '#57e5e5';\nvar teal30Hover = '#25cac8';\nvar teal40Hover = '#07aba9';\nvar teal50Hover = '#008a87';\nvar teal60Hover = '#006b68';\nvar teal70Hover = '#007070';\nvar teal80Hover = '#005357';\nvar teal90Hover = '#033940';\nvar teal100Hover = '#0f3034';\nvar tealHover = {\n  10: teal10Hover,\n  20: teal20Hover,\n  30: teal30Hover,\n  40: teal40Hover,\n  50: teal50Hover,\n  60: teal60Hover,\n  70: teal70Hover,\n  80: teal80Hover,\n  90: teal90Hover,\n  100: teal100Hover\n};\nvar green10 = '#defbe6';\nvar green20 = '#a7f0ba';\nvar green30 = '#6fdc8c';\nvar green40 = '#42be65';\nvar green50 = '#24a148';\nvar green60 = '#198038';\nvar green70 = '#0e6027';\nvar green80 = '#044317';\nvar green90 = '#022d0d';\nvar green100 = '#071908';\nvar green = {\n  10: green10,\n  20: green20,\n  30: green30,\n  40: green40,\n  50: green50,\n  60: green60,\n  70: green70,\n  80: green80,\n  90: green90,\n  100: green100\n};\nvar green10Hover = '#b6f6c8';\nvar green20Hover = '#74e792';\nvar green30Hover = '#36ce5e';\nvar green40Hover = '#3bab5a';\nvar green50Hover = '#208e3f';\nvar green60Hover = '#166f31';\nvar green70Hover = '#11742f';\nvar green80Hover = '#05521c';\nvar green90Hover = '#033b11';\nvar green100Hover = '#0d300f';\nvar greenHover = {\n  10: green10Hover,\n  20: green20Hover,\n  30: green30Hover,\n  40: green40Hover,\n  50: green50Hover,\n  60: green60Hover,\n  70: green70Hover,\n  80: green80Hover,\n  90: green90Hover,\n  100: green100Hover\n};\nvar coolGray10 = '#f2f4f8';\nvar coolGray20 = '#dde1e6';\nvar coolGray30 = '#c1c7cd';\nvar coolGray40 = '#a2a9b0';\nvar coolGray50 = '#878d96';\nvar coolGray60 = '#697077';\nvar coolGray70 = '#4d5358';\nvar coolGray80 = '#343a3f';\nvar coolGray90 = '#21272a';\nvar coolGray100 = '#121619';\nvar coolGray = {\n  10: coolGray10,\n  20: coolGray20,\n  30: coolGray30,\n  40: coolGray40,\n  50: coolGray50,\n  60: coolGray60,\n  70: coolGray70,\n  80: coolGray80,\n  90: coolGray90,\n  100: coolGray100\n};\nvar coolGray10Hover = '#e4e9f1';\nvar coolGray20Hover = '#cdd3da';\nvar coolGray30Hover = '#adb5bd';\nvar coolGray40Hover = '#9199a1';\nvar coolGray50Hover = '#757b85';\nvar coolGray60Hover = '#585e64';\nvar coolGray70Hover = '#5d646a';\nvar coolGray80Hover = '#434a51';\nvar coolGray90Hover = '#2b3236';\nvar coolGray100Hover = '#222a2f';\nvar coolGrayHover = {\n  10: coolGray10Hover,\n  20: coolGray20Hover,\n  30: coolGray30Hover,\n  40: coolGray40Hover,\n  50: coolGray50Hover,\n  60: coolGray60Hover,\n  70: coolGray70Hover,\n  80: coolGray80Hover,\n  90: coolGray90Hover,\n  100: coolGray100Hover\n};\nvar gray10 = '#f4f4f4';\nvar gray20 = '#e0e0e0';\nvar gray30 = '#c6c6c6';\nvar gray40 = '#a8a8a8';\nvar gray50 = '#8d8d8d';\nvar gray60 = '#6f6f6f';\nvar gray70 = '#525252';\nvar gray80 = '#393939';\nvar gray90 = '#262626';\nvar gray100 = '#161616';\nvar gray = {\n  10: gray10,\n  20: gray20,\n  30: gray30,\n  40: gray40,\n  50: gray50,\n  60: gray60,\n  70: gray70,\n  80: gray80,\n  90: gray90,\n  100: gray100\n};\nvar gray10Hover = '#e8e8e8';\nvar gray20Hover = '#d1d1d1';\nvar gray30Hover = '#b5b5b5';\nvar gray40Hover = '#999999';\nvar gray50Hover = '#7a7a7a';\nvar gray60Hover = '#5e5e5e';\nvar gray70Hover = '#636363';\nvar gray80Hover = '#474747';\nvar gray90Hover = '#333333';\nvar gray100Hover = '#292929';\nvar grayHover = {\n  10: gray10Hover,\n  20: gray20Hover,\n  30: gray30Hover,\n  40: gray40Hover,\n  50: gray50Hover,\n  60: gray60Hover,\n  70: gray70Hover,\n  80: gray80Hover,\n  90: gray90Hover,\n  100: gray100Hover\n};\nvar warmGray10 = '#f7f3f2';\nvar warmGray20 = '#e5e0df';\nvar warmGray30 = '#cac5c4';\nvar warmGray40 = '#ada8a8';\nvar warmGray50 = '#8f8b8b';\nvar warmGray60 = '#726e6e';\nvar warmGray70 = '#565151';\nvar warmGray80 = '#3c3838';\nvar warmGray90 = '#272525';\nvar warmGray100 = '#171414';\nvar warmGray = {\n  10: warmGray10,\n  20: warmGray20,\n  30: warmGray30,\n  40: warmGray40,\n  50: warmGray50,\n  60: warmGray60,\n  70: warmGray70,\n  80: warmGray80,\n  90: warmGray90,\n  100: warmGray100\n};\nvar warmGray10Hover = '#f0e8e6';\nvar warmGray20Hover = '#d8d0cf';\nvar warmGray30Hover = '#b9b3b1';\nvar warmGray40Hover = '#9c9696';\nvar warmGray50Hover = '#7f7b7b';\nvar warmGray60Hover = '#605d5d';\nvar warmGray70Hover = '#696363';\nvar warmGray80Hover = '#4c4848';\nvar warmGray90Hover = '#343232';\nvar warmGray100Hover = '#2c2626';\nvar warmGrayHover = {\n  10: warmGray10Hover,\n  20: warmGray20Hover,\n  30: warmGray30Hover,\n  40: warmGray40Hover,\n  50: warmGray50Hover,\n  60: warmGray60Hover,\n  70: warmGray70Hover,\n  80: warmGray80Hover,\n  90: warmGray90Hover,\n  100: warmGray100Hover\n};\nvar colors = {\n  black: {\n    100: black\n  },\n  blue: blue,\n  coolGray: coolGray,\n  cyan: cyan,\n  gray: gray,\n  green: green,\n  magenta: magenta,\n  orange: orange,\n  purple: purple,\n  red: red,\n  teal: teal,\n  warmGray: warmGray,\n  white: {\n    0: white\n  },\n  yellow: yellow\n};\nvar hoverColors = {\n  whiteHover: whiteHover,\n  blackHover: blackHover,\n  blueHover: blueHover,\n  coolGrayHover: coolGrayHover,\n  cyanHover: cyanHover,\n  grayHover: grayHover,\n  greenHover: greenHover,\n  magentaHover: magentaHover,\n  orangeHover: orangeHover,\n  purpleHover: purpleHover,\n  redHover: redHover,\n  tealHover: tealHover,\n  warmGrayHover: warmGrayHover,\n  yellowHover: yellowHover\n};\n\n/**\n * Copyright IBM Corp. 2018, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * Parse a given hexcode string into an rgba statement with the given opacity\n * @param {string} hexcode\n * @param {number} opacity\n * @returns {string}\n */\nfunction rgba(hexcode, opacity) {\n  var values = [hexcode.substring(1, 3), hexcode.substring(3, 5), hexcode.substring(5, 7)].map(function (string) {\n    return parseInt(string, 16);\n  });\n  return \"rgba(\".concat(values[0], \", \").concat(values[1], \", \").concat(values[2], \", \").concat(opacity, \")\");\n}\n\nexport { black, black100, blackHover, blue, blue10, blue100, blue100Hover, blue10Hover, blue20, blue20Hover, blue30, blue30Hover, blue40, blue40Hover, blue50, blue50Hover, blue60, blue60Hover, blue70, blue70Hover, blue80, blue80Hover, blue90, blue90Hover, blueHover, colors, coolGray, coolGray10, coolGray100, coolGray100Hover, coolGray10Hover, coolGray20, coolGray20Hover, coolGray30, coolGray30Hover, coolGray40, coolGray40Hover, coolGray50, coolGray50Hover, coolGray60, coolGray60Hover, coolGray70, coolGray70Hover, coolGray80, coolGray80Hover, coolGray90, coolGray90Hover, coolGrayHover, cyan, cyan10, cyan100, cyan100Hover, cyan10Hover, cyan20, cyan20Hover, cyan30, cyan30Hover, cyan40, cyan40Hover, cyan50, cyan50Hover, cyan60, cyan60Hover, cyan70, cyan70Hover, cyan80, cyan80Hover, cyan90, cyan90Hover, cyanHover, gray, gray10, gray100, gray100Hover, gray10Hover, gray20, gray20Hover, gray30, gray30Hover, gray40, gray40Hover, gray50, gray50Hover, gray60, gray60Hover, gray70, gray70Hover, gray80, gray80Hover, gray90, gray90Hover, grayHover, green, green10, green100, green100Hover, green10Hover, green20, green20Hover, green30, green30Hover, green40, green40Hover, green50, green50Hover, green60, green60Hover, green70, green70Hover, green80, green80Hover, green90, green90Hover, greenHover, hoverColors, magenta, magenta10, magenta100, magenta100Hover, magenta10Hover, magenta20, magenta20Hover, magenta30, magenta30Hover, magenta40, magenta40Hover, magenta50, magenta50Hover, magenta60, magenta60Hover, magenta70, magenta70Hover, magenta80, magenta80Hover, magenta90, magenta90Hover, magentaHover, orange, orange10, orange100, orange100Hover, orange10Hover, orange20, orange20Hover, orange30, orange30Hover, orange40, orange40Hover, orange50, orange50Hover, orange60, orange60Hover, orange70, orange70Hover, orange80, orange80Hover, orange90, orange90Hover, orangeHover, purple, purple10, purple100, purple100Hover, purple10Hover, purple20, purple20Hover, purple30, purple30Hover, purple40, purple40Hover, purple50, purple50Hover, purple60, purple60Hover, purple70, purple70Hover, purple80, purple80Hover, purple90, purple90Hover, purpleHover, red, red10, red100, red100Hover, red10Hover, red20, red20Hover, red30, red30Hover, red40, red40Hover, red50, red50Hover, red60, red60Hover, red70, red70Hover, red80, red80Hover, red90, red90Hover, redHover, rgba, teal, teal10, teal100, teal100Hover, teal10Hover, teal20, teal20Hover, teal30, teal30Hover, teal40, teal40Hover, teal50, teal50Hover, teal60, teal60Hover, teal70, teal70Hover, teal80, teal80Hover, teal90, teal90Hover, tealHover, warmGray, warmGray10, warmGray100, warmGray100Hover, warmGray10Hover, warmGray20, warmGray20Hover, warmGray30, warmGray30Hover, warmGray40, warmGray40Hover, warmGray50, warmGray50Hover, warmGray60, warmGray60Hover, warmGray70, warmGray70Hover, warmGray80, warmGray80Hover, warmGray90, warmGray90Hover, warmGrayHover, white, white0, whiteHover, yellow, yellow10, yellow100, yellow100Hover, yellow10Hover, yellow20, yellow20Hover, yellow30, yellow30Hover, yellow40, yellow40Hover, yellow50, yellow50Hover, yellow60, yellow60Hover, yellow70, yellow70Hover, yellow80, yellow80Hover, yellow90, yellow90Hover, yellowHover };\n","import { color as d3Color, hierarchy as d3Hierarchy, hsl, treemap as d3Treemap, select } from 'd3'\nimport { colors } from '@carbon/colors'\nimport { getProperty } from '@/tools'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\n\nconst findColorShade = (hex: string) => {\n\tif (!hex) {\n\t\treturn null\n\t}\n\n\tfor (const colorName of Object.keys(colors)) {\n\t\tconst colorShades = colors[colorName as keyof typeof colors]\n\n\t\tfor (const colorShadeLevel of Object.keys(colorShades)) {\n\t\t\tconst colorShade = colorShades[+colorShadeLevel]\n\n\t\t\tif (colorShade === hex) {\n\t\t\t\treturn colorShadeLevel\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null\n}\n\nconst textFillColor = function () {\n\tconst correspondingLeaf = select(this.parentNode).select('rect.leaf') as any\n\tconst correspondingLeafFill = getComputedStyle(correspondingLeaf.node(), null).getPropertyValue(\n\t\t'fill'\n\t)\n\tconst cl = d3Color(correspondingLeafFill) as any\n\n\tlet colorShade: any\n\tif (cl) {\n\t\tcolorShade = findColorShade(cl ? cl.hex() : null)\n\t}\n\n\tif (colorShade === null || colorShade === undefined) {\n\t\tconst lightness = hsl(cl).l\n\t\tcolorShade = Math.abs(lightness * 100 - 100)\n\t}\n\n\treturn colorShade > 50 ? 'white' : 'black'\n}\n\nlet uidCounter = 0\nexport class Treemap extends Component {\n\ttype = 'treemap'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst { events } = this.services\n\t\t// Highlight correct circle on legend item hovers\n\t\tevents.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\t\t// Un-highlight circles on legend item mouseouts\n\t\tevents.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getComponentContainer()\n\n\t\tthis.model.getData()\n\t\tconst displayData = this.model.getDisplayData()\n\t\tconst options = this.model.getOptions()\n\n\t\tconst windowLocation = getProperty(window, 'location')\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tconst hierarchy = d3Hierarchy({\n\t\t\tname: options.title || 'Treemap',\n\t\t\tchildren: displayData\n\t\t})\n\t\t\t.sum((d: any) => d.value)\n\t\t\t.sort((a, b) => b.value - a.value)\n\n\t\tconst root = d3Treemap().size([width, height]).paddingInner(1).paddingOuter(0).round(true)(\n\t\t\thierarchy\n\t\t)\n\n\t\tconst leafGroups = svg\n\t\t\t.selectAll(\"g[data-name='leaf']\")\n\t\t\t.data(root.leaves(), (leaf: any) => leaf.data.name)\n\n\t\t// Remove leaf groups that need to be removed\n\t\tleafGroups.exit().attr('opacity', 0).remove()\n\n\t\t// Add the leaf groups that need to be introduced\n\t\tconst enteringLeafGroups = leafGroups\n\t\t\t.enter()\n\t\t\t.append('g')\n\t\t\t.attr('data-name', 'leaf')\n\t\t\t.attr('data-uid', () => uidCounter++)\n\n\t\tconst allLeafGroups = enteringLeafGroups.merge(leafGroups as any)\n\n\t\tallLeafGroups\n\t\t\t.attr('data-name', 'leaf')\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'treemap-group-update',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('transform', (d: any) => `translate(${d.x0},${d.y0})`)\n\n\t\tconst rects = allLeafGroups.selectAll('rect.leaf').data((d: any) => [d])\n\n\t\trects.exit().attr('width', 0).attr('height', 0).remove()\n\n\t\tconst enteringRects = rects.enter().append('rect').classed('leaf', true)\n\n\t\tenteringRects\n\t\t\t.merge(rects as any)\n\t\t\t.attr('width', 0)\n\t\t\t.attr('height', 0)\n\t\t\t.attr('id', function () {\n\t\t\t\tconst uid: any = select(this.parentNode as any).attr('data-uid')\n\t\t\t\treturn `${options.style.prefix}-leaf-${uid}`\n\t\t\t})\n\t\t\t.attr('class', (d: any) => {\n\t\t\t\twhile (d.depth > 1) d = d.parent\n\n\t\t\t\treturn this.model.getColorClassName({\n\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\tdataGroupName: d.data.name,\n\t\t\t\t\toriginalClassName: 'leaf'\n\t\t\t\t})\n\t\t\t})\n\t\t\t.transition()\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'treemap-leaf-update-enter',\n\t\t\t\t\tanimate\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('width', (d: any) => d.x1 - d.x0)\n\t\t\t.attr('height', (d: any) => d.y1 - d.y0)\n\t\t\t.style('fill', (d: any) => {\n\t\t\t\twhile (d.depth > 1) d = d.parent\n\t\t\t\treturn this.model.getFillColor(d.data.name, null, d.data)\n\t\t\t})\n\n\t\t// Update all clip paths\n\t\tallLeafGroups\n\t\t\t.selectAll('clipPath')\n\t\t\t.data(\n\t\t\t\t(d: any) => {\n\t\t\t\t\tif (d.data.showLabel !== true) {\n\t\t\t\t\t\treturn []\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [1]\n\t\t\t\t},\n\t\t\t\t(d: any) => d\n\t\t\t)\n\t\t\t.join(\n\t\t\t\t(enter: any) => {\n\t\t\t\t\treturn enter\n\t\t\t\t\t\t.append('clipPath')\n\t\t\t\t\t\t.attr('id', function () {\n\t\t\t\t\t\t\tconst uid = select(this.parentNode).attr('data-uid')\n\t\t\t\t\t\t\treturn `${options.style.prefix}-clip-${uid}`\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.append('use')\n\t\t\t\t\t\t.attr('xlink:href', function () {\n\t\t\t\t\t\t\tconst uid = select(this.parentNode.parentNode).attr('data-uid')\n\t\t\t\t\t\t\tconst leafID = `${options.style.prefix}-leaf-${uid}`\n\n\t\t\t\t\t\t\treturn new URL(`#${leafID}`, windowLocation) + ''\n\t\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t\t\t// @ts-ignore\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\t\t(update: any) => null as any,\n\t\t\t\t(exit: any) => exit.remove()\n\t\t\t)\n\n\t\t// Update all titles\n\t\tallLeafGroups\n\t\t\t.selectAll('text')\n\t\t\t.data(\n\t\t\t\t(d: any) => {\n\t\t\t\t\tif (d.data.showLabel !== true) {\n\t\t\t\t\t\treturn []\n\t\t\t\t\t}\n\n\t\t\t\t\tlet parent = d\n\t\t\t\t\twhile (parent.depth > 1) parent = parent.parent\n\t\t\t\t\tconst color = hsl(this.model.getFillColor(parent.data.name))\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: d.data.name,\n\t\t\t\t\t\t\tcolor: color.l < 0.5 ? 'white' : 'black'\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t(d: any) => d\n\t\t\t)\n\t\t\t.join(\n\t\t\t\t(enter: any) => {\n\t\t\t\t\tconst addedText = enter\n\t\t\t\t\t\t.append('text')\n\t\t\t\t\t\t.text((d: any) => d.text)\n\t\t\t\t\t\t.style('fill', textFillColor)\n\t\t\t\t\t\t.attr('x', 7)\n\t\t\t\t\t\t.attr('y', 18)\n\n\t\t\t\t\tif (windowLocation) {\n\t\t\t\t\t\taddedText.attr('clip-path', function () {\n\t\t\t\t\t\t\tconst uid = select(this.parentNode).attr('data-uid')\n\t\t\t\t\t\t\tconst clipPathID = `${options.style.prefix}-clip-${uid}`\n\n\t\t\t\t\t\t\treturn `url(${new URL(`#${clipPathID}`, windowLocation) + ''})`\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\treturn addedText\n\t\t\t\t},\n\t\t\t\t(update: any) => update.text((d: any) => d.text).style('fill', textFillColor),\n\t\t\t\t(exit: any) => exit.remove()\n\t\t\t)\n\n\t\t// Add event listeners to elements drawn\n\t\tthis.addEventListeners()\n\t}\n\n\taddEventListeners() {\n\t\tconst self = this\n\t\tthis.parent\n\t\t\t.selectAll('rect.leaf')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tlet fillColor = getComputedStyle(this as Element, null).getPropertyValue('fill')\n\n\t\t\t\tlet parent = datum\n\t\t\t\twhile (parent.depth > 1) parent = parent.parent\n\n\t\t\t\thoveredElement\n\t\t\t\t\t.transition('graph_element_mouseover_fill_update')\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'graph_element_mouseover_fill_update'\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.style('fill', (d: any) => {\n\t\t\t\t\t\tconst customColor = self.model.getFillColor(d.parent.data.name, null, d.data)\n\t\t\t\t\t\tif (customColor) {\n\t\t\t\t\t\t\tfillColor = customColor\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn d3Color(fillColor).darker(0.7).toString()\n\t\t\t\t\t})\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcolor: fillColor,\n\t\t\t\t\t\t\tlabel: parent.data.name,\n\t\t\t\t\t\t\tbold: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: datum.data.name,\n\t\t\t\t\t\t\tvalue: datum.data.value\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Treemap.LEAF_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Treemap.LEAF_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Treemap.LEAF_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\thoveredElement.classed('hovered', false)\n\n\t\t\t\tlet parent = datum\n\t\t\t\twhile (parent.depth > 1) parent = parent.parent\n\n\t\t\t\thoveredElement\n\t\t\t\t\t.transition()\n\t\t\t\t\t.call((t: any) =>\n\t\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\t\tname: 'graph_element_mouseout_fill_update'\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t.style('fill', (d: any) => self.model.getFillColor(d.parent.data.name, null, d.data))\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.Treemap.LEAF_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\n\t\tthis.parent\n\t\t\t.selectAll(\"g[data-name='leaf']\")\n\t\t\t.transition('legend-hover-treemap')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-treemap'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) =>\n\t\t\t\td.parent.data.name === hoveredElement.datum()['name'] ? 1 : 0.3\n\t\t\t)\n\t}\n\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll(\"g[data-name='leaf']\")\n\t\t\t.transition('legend-mouseout-treemap')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-treemap'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n}\n","import { extent, scaleLinear, select } from 'd3'\nimport cloud from 'd3-cloud'\nimport { debounce, get } from 'lodash-es'\nimport { Component } from '@/components/component'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { Events, ColorClassNameTypes, RenderTypes } from '@/interfaces/enums'\n\nexport class WordCloud extends Component {\n\ttype = 'wordcloud'\n\trenderType = RenderTypes.SVG\n\n\tinit() {\n\t\tconst eventsFragment = this.services.events\n\n\t\t// Highlight correct words on legend item hovers\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_HOVER, this.handleLegendOnHover)\n\n\t\t// Un-highlight words on legend item mouseouts\n\t\teventsFragment.addEventListener(Events.Legend.ITEM_MOUSEOUT, this.handleLegendMouseOut)\n\t}\n\n\trender(animate = true) {\n\t\tconst self = this\n\t\tconst svg = this.getComponentContainer().attr('width', '100%').attr('height', '100%')\n\n\t\tconst displayData = this.model.getDisplayData()\n\t\tconst fontSizeScale = this.getFontSizeScale(displayData)\n\n\t\tconst options = this.getOptions()\n\t\tconst { fontSizeMapsTo, wordMapsTo } = options.wordCloud\n\t\tconst { groupMapsTo } = options.data\n\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\tif (width === 0 || height === 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst layout = cloud()\n\t\t\t.size([width, height])\n\t\t\t.words(\n\t\t\t\tdisplayData.map(function (d: any) {\n\t\t\t\t\tconst value = d[fontSizeMapsTo]\n\n\t\t\t\t\tif (typeof d[fontSizeMapsTo] !== 'number') {\n\t\t\t\t\t\tthrow Error(\n\t\t\t\t\t\t\t'Badly formatted WordCloud data. `value` should only be an integer or float'\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t[groupMapsTo]: d[groupMapsTo],\n\t\t\t\t\t\ttext: d[wordMapsTo],\n\t\t\t\t\t\tsize: value,\n\t\t\t\t\t\tvalue\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t\t.padding(5)\n\t\t\t.rotate(0)\n\t\t\t.fontSize((d: any) => fontSizeScale(d.size))\n\t\t\t.on('end', draw)\n\n\t\tlayout.start()\n\n\t\tfunction draw(words: any) {\n\t\t\tconst textGroup = DOMUtils.appendOrSelect(svg, 'g.words')\n\t\t\ttextGroup.attr('transform', `translate(${layout.size()[0] / 2}, ${layout.size()[1] / 2})`)\n\n\t\t\tconst allText = textGroup\n\t\t\t\t.selectAll('text')\n\t\t\t\t.data(words, (d: any) => `${d[groupMapsTo]}-${d.text}`)\n\n\t\t\t// Remove texts that are no longer needed\n\t\t\tallText.exit().attr('opacity', 0).remove()\n\n\t\t\tconst enteringText = allText.enter().append('text').attr('opacity', 0)\n\n\t\t\tenteringText\n\t\t\t\t.merge(allText as any)\n\t\t\t\t.style('font-size', (d: any) => `${d.size}px`)\n\t\t\t\t.text(function (d: any) {\n\t\t\t\t\treturn d.text\n\t\t\t\t})\n\t\t\t\t.attr('class', (d: any) =>\n\t\t\t\t\tself.model.getColorClassName({\n\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.FILL],\n\t\t\t\t\t\tdataGroupName: d[groupMapsTo],\n\t\t\t\t\t\toriginalClassName: `word ${d.size > 32 ? 'light' : ''}`\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.style('fill', (d: any) => {\n\t\t\t\t\treturn self.model.getFillColor(d[groupMapsTo], d.text, d)\n\t\t\t\t})\n\t\t\t\t.attr('text-anchor', 'middle')\n\t\t\t\t.transition()\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'wordcloud-text-update-enter',\n\t\t\t\t\t\tanimate\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.attr('transform', (d: any) => `translate(${d.x}, ${d.y})`)\n\t\t\t\t.attr('opacity', 1)\n\t\t}\n\n\t\t// Add event listeners\n\t\tthis.addEventListeners()\n\t}\n\n\tgetFontSizeScale(data: any) {\n\t\tconst options = this.getOptions()\n\t\tconst { fontSizeMapsTo } = options.wordCloud\n\n\t\t// Filter out any null/undefined values\n\t\tconst allOccurences = data.map((d: any) => d[fontSizeMapsTo]).filter((size: any) => size)\n\t\tconst chartSize = DOMUtils.getHTMLElementSize(this.services.domUtils.getMainContainer())\n\n\t\t// We need the ternary operator here in case the user\n\t\t// doesn't provide size values in data\n\t\tconst sizeDataIsValid = allOccurences.length > 0\n\t\tconst domain = sizeDataIsValid ? extent(allOccurences) : [1, 1]\n\n\t\treturn scaleLinear()\n\t\t\t.domain(domain as any)\n\t\t\t.range(sizeDataIsValid ? options.wordCloud.fontSizeRange(chartSize, data) : [4, 4])\n\t}\n\n\t// Highlight elements that match the hovered legend item\n\thandleLegendOnHover = (event: CustomEvent) => {\n\t\tconst { hoveredElement } = event.detail\n\t\tconst { groupMapsTo } = this.getOptions().data\n\n\t\tthis.parent\n\t\t\t.selectAll('text.word')\n\t\t\t.transition('legend-hover-wordcloud')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-hover-wordcloud'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', (d: any) => (d[groupMapsTo] !== hoveredElement.datum()['name'] ? 0.3 : 1))\n\t}\n\n\t// Un-highlight all elements\n\thandleLegendMouseOut = () => {\n\t\tthis.parent\n\t\t\t.selectAll('text.word')\n\t\t\t.transition('legend-mouseout-wordcloud')\n\t\t\t.call((t: any) =>\n\t\t\t\tthis.services.transitions.setupTransition({\n\t\t\t\t\ttransition: t,\n\t\t\t\t\tname: 'legend-mouseout-wordcloud'\n\t\t\t\t})\n\t\t\t)\n\t\t\t.attr('opacity', 1)\n\t}\n\n\taddEventListeners() {\n\t\tconst options = this.getOptions()\n\t\tconst { groupMapsTo } = options.data\n\t\tconst self = this\n\n\t\t// Highlights 1 word or unhighlights all\n\t\tconst debouncedHighlight = debounce((word: any) => {\n\t\t\tconst allWords = self.parent\n\t\t\t\t.selectAll('text.word')\n\t\t\t\t.transition('wordcloud-word-mouse-highlight')\n\t\t\t\t.call((t: any) =>\n\t\t\t\t\tself.services.transitions.setupTransition({\n\t\t\t\t\t\ttransition: t,\n\t\t\t\t\t\tname: 'wordcloud-word-mouse-highlight'\n\t\t\t\t\t})\n\t\t\t\t)\n\n\t\t\tif (word === null) {\n\t\t\t\tallWords.attr('opacity', 1)\n\t\t\t} else {\n\t\t\t\tallWords.attr('opacity', function () {\n\t\t\t\t\tif (word === this) {\n\t\t\t\t\t\treturn 1\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0.3\n\t\t\t\t})\n\t\t\t}\n\t\t}, 6)\n\n\t\tthis.parent\n\t\t\t.selectAll('text.word')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = this\n\t\t\t\tdebouncedHighlight(hoveredElement)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.WordCloud.WORD_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: options.tooltip.wordLabel,\n\t\t\t\t\t\t\tvalue: datum.text\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: options.tooltip.valueLabel,\n\t\t\t\t\t\t\tvalue: datum.value\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel:\n\t\t\t\t\t\t\t\tget(options, 'locale.translations.group') ||\n\t\t\t\t\t\t\t\tget(options, 'tooltip.groupLabel') ||\n\t\t\t\t\t\t\t\t'Group',\n\t\t\t\t\t\t\tvalue: datum[groupMapsTo],\n\t\t\t\t\t\t\tclass: self.model.getColorClassName({\n\t\t\t\t\t\t\t\tclassNameTypes: [ColorClassNameTypes.TOOLTIP],\n\t\t\t\t\t\t\t\tdataGroupName: datum[groupMapsTo]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.WordCloud.WORD_MOUSEMOVE, {\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Show tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.WordCloud.WORD_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\t\t\t\tdebouncedHighlight(null)\n\n\t\t\t\t// Dispatch mouse event\n\t\t\t\tself.services.events.dispatchEvent(Events.WordCloud.WORD_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum\n\t\t\t\t})\n\n\t\t\t\t// Hide tooltip\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n}\n","import {\n\tgeoPath,\n\tline,\n\t// Azimuthal Projections - project the sphere directly on to the plane\n\tgeoEqualEarth,\n\t// Conic projections - project the sphere onto a cone & unroll into the plane\n\tgeoAlbers,\n\tgeoConicEqualArea,\n\tgeoConicEquidistant,\n\t// Cylindrical projections - project the sphere onto a containing cylinder & unroll onto the plane\n\tgeoEquirectangular,\n\tgeoMercator,\n\tgeoNaturalEarth1\n} from 'd3'\nimport { feature, merge } from 'topojson-client'\nimport type { GeometryObject } from 'topojson-specification'\nimport { Component } from '@/components'\nimport { DOMUtils } from '@/services/essentials/dom-utils'\nimport { getProperty } from '@/tools'\nimport { RenderTypes, Projection } from '@/interfaces/enums'\nimport { ChoroplethModel } from '@/model'\n\nexport class GeoProjection extends Component {\n\ttype = 'geo'\n\trenderType = RenderTypes.SVG\n\n\trender() {\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\t\tconst { width, height } = DOMUtils.getSVGElementSize(svg, {\n\t\t\tuseAttrs: true\n\t\t})\n\n\t\t// Because of a Firefox bug with regard to sizing & d3 packs,\n\t\t// rather than checking if height or width aren't 0,\n\t\t// we have to make sure they're not smaller than 1\n\t\tif (width < 1 || height < 1) {\n\t\t\treturn\n\t\t}\n\n\t\t// Get users projection\n\t\tconst projection = this.getProjection()\n\n\t\tconst geoData = getProperty(this.getOptions(), 'geoData')\n\n\t\tconst data = (this.model as ChoroplethModel).getCombinedData()\n\n\t\t// Separate countries that have data & countries with missing data\n\t\tconst withData = {}\n\t\tconst withoutData = {}\n\t\tObject.keys(data).forEach(element => {\n\t\t\tif (typeof data[element].value === 'number') {\n\t\t\t\twithData[element] = data[element]\n\t\t\t} else {\n\t\t\t\twithoutData[element] = data[element]\n\t\t\t}\n\t\t})\n\n\t\t// Merge all without data\n\t\tconst withoutDataMerge = merge(geoData, Object.values(withoutData))\n\n\t\t/**\n\t\t * @todo - Currently only topojson is supported\n\t\t *\n\t\t * Unlike geojson, topojson does not have a standard format\n\t\t * So data must be nested in the following format:\n\t\t * options : {\n\t\t * \tgeoData: {\n\t\t *  \tobjects: {\n\t\t * \t\t\t...\n\t\t * \t\t}\n\t\t *  }\n\t\t * }\n\t\t */\n\t\t// Convert from topojson to geojson\n\t\tconst json = feature(geoData, {\n\t\t\t// We need to specify that we are converting geometry collections\n\t\t\ttype: 'GeometryCollection',\n\t\t\tgeometries: Object.values(withData) as GeometryObject<{ [name: string]: any }>[]\n\t\t})\n\n\t\t// Depending on the projection selected, we will need to scale/translate accordingly\n\t\tconst projectionScale = projection.fitSize([width, height], json)\n\t\tconst geo = geoPath().projection(projectionScale)\n\n\t\tconst borders = DOMUtils.appendOrSelect(svg, 'g.geo')\n\t\tborders.selectAll('path').data(json.features).join('path').attr('d', geo)\n\n\t\tconst patternID = this.services.domUtils.generateElementIDString(`geo-pattern-stripes`)\n\n\t\t// Create a striped pattern for missing data\n\t\tconst defs = DOMUtils.appendOrSelect(svg, 'defs')\n\t\tDOMUtils.appendOrSelect(defs, 'pattern')\n\t\t\t.attr('id', patternID)\n\t\t\t.attr('width', 5)\n\t\t\t.attr('height', 10)\n\t\t\t.attr('patternUnits', 'userSpaceOnUse')\n\t\t\t.attr('patternTransform', 'rotate(45)')\n\t\t\t.append('path')\n\t\t\t.classed('pattern-fill', true)\n\t\t\t.attr(\n\t\t\t\t'd',\n\t\t\t\tline()([\n\t\t\t\t\t[0, 0],\n\t\t\t\t\t[0, 10]\n\t\t\t\t])\n\t\t\t)\n\n\t\tconst missingBorders = DOMUtils.appendOrSelect(svg, 'g.missing-data')\n\t\tDOMUtils.appendOrSelect(missingBorders, 'path')\n\t\t\t.datum(withoutDataMerge)\n\t\t\t.attr('d', geo)\n\t\t\t.style('fill', `url(#${patternID})`)\n\t}\n\n\t/**\n\t * @info\n\t * Depending on projection, we may need to provide additional configuration\n\t * e.g. sizing\n\t *\n\t * In such case, function can be refactored so that\n\t * projection should return an object with the configuraiton & function\n\t */\n\tgetProjection() {\n\t\tlet projection = null\n\t\tconst projectionSelected = getProperty(this.getOptions(), 'thematic', 'projection')\n\n\t\tswitch (projectionSelected) {\n\t\t\t// Azimuthal Projections\n\t\t\tcase Projection.geoEqualEarth:\n\t\t\t\tprojection = geoEqualEarth()\n\t\t\t\tbreak\n\t\t\t// Conic Projections\n\t\t\tcase Projection.geoAlbers:\n\t\t\t\tprojection = geoAlbers()\n\t\t\t\tbreak\n\t\t\tcase Projection.geoConicEqualArea:\n\t\t\t\tprojection = geoConicEqualArea()\n\t\t\t\tbreak\n\t\t\tcase Projection.geoConicEquidistant:\n\t\t\t\tprojection = geoConicEquidistant()\n\t\t\t\tbreak\n\t\t\t// Cyndrical projections\n\t\t\tcase Projection.geoEquirectangular:\n\t\t\t\tprojection = geoEquirectangular()\n\t\t\t\tbreak\n\t\t\tcase Projection.geoMercator:\n\t\t\t\tprojection = geoMercator()\n\t\t\t\tbreak\n\t\t\tcase Projection.geoNaturalEarth1:\n\t\t\t\tprojection = geoNaturalEarth1()\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\t// Projection is missing or an unsupported projection value is passed\n\t\t\t\tthrow new Error('Projection is not supported.')\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn projection\n\t}\n}\n","import { select } from 'd3'\nimport * as Events from '@/interfaces/events'\nimport { GeoProjection } from '@/components/essentials/geo-projection'\nimport { ChoroplethModel } from '@/model'\n\nexport class Choropleth extends GeoProjection {\n\ttype = 'choropleth'\n\n\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t// @ts-ignore\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\trender(animate = true) {\n\t\tsuper.render()\n\t\tconst data = (this.model as ChoroplethModel).getCombinedData()\n\t\tconst svg = this.getComponentContainer({ withinChartClip: true })\n\n\t\tconst geo = svg.select('g.geo')\n\t\tgeo\n\t\t\t.selectAll('path')\n\t\t\t.classed('border', true)\n\t\t\t.attr('class', (d: any) => {\n\t\t\t\treturn this.model.getColorClassName({\n\t\t\t\t\tvalue: data[d.properties.NAME].value,\n\t\t\t\t\toriginalClassName: `border`\n\t\t\t\t})\n\t\t\t})\n\n\t\tthis.addCountryAreaEventListener()\n\t}\n\n\taddCountryAreaEventListener() {\n\t\tconst self = this\n\t\tconst data = (this.model as ChoroplethModel).getCombinedData()\n\n\t\tthis.parent\n\t\t\t.selectAll('path.border')\n\t\t\t.on('mouseover', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse over event\n\t\t\t\tself.services.events.dispatchEvent(Events.Choropleth.CHOROPLETH_MOUSEOVER, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum: data[datum.properties.NAME]\n\t\t\t\t})\n\n\t\t\t\t// Dispatch tooltip show event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.SHOW, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: datum.properties.NAME,\n\t\t\t\t\t\t\tvalue: data[datum.properties.NAME].value\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mousemove', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Choropleth.CHOROPLETH_MOUSEMOVE, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: data[datum.properties.NAME]\n\t\t\t\t})\n\t\t\t\t// Dispatch tooltip move event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.MOVE, {\n\t\t\t\t\tevent\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('click', function (event: MouseEvent, datum: any) {\n\t\t\t\t// Dispatch mouse click event\n\t\t\t\tself.services.events.dispatchEvent(Events.Choropleth.CHOROPLETH_CLICK, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: select(this),\n\t\t\t\t\tdatum: data[datum.properties.NAME]\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on('mouseout', function (event: MouseEvent, datum: any) {\n\t\t\t\tconst hoveredElement = select(this)\n\n\t\t\t\t// Dispatch mouse out event\n\t\t\t\tself.services.events.dispatchEvent(Events.Choropleth.CHOROPLETH_MOUSEOUT, {\n\t\t\t\t\tevent,\n\t\t\t\t\telement: hoveredElement,\n\t\t\t\t\tdatum: data[datum.properties.NAME]\n\t\t\t\t})\n\n\t\t\t\t// Dispatch hide tooltip event\n\t\t\t\tself.services.events.dispatchEvent(Events.Tooltip.HIDE, {\n\t\t\t\t\tevent,\n\t\t\t\t\thoveredElement\n\t\t\t\t})\n\t\t\t})\n\t}\n}\n"],"names":["arrayReduce","array","iteratee","accumulator","initAccum","index","length","basePropertyOf","object","key","deburredLetters","deburrLetter","deburrLetter$1","reLatin","rsComboMarksRange","reComboHalfMarksRange","rsComboSymbolsRange","rsComboRange","rsCombo","reComboMark","deburr","string","toString","reAsciiWord","asciiWords","reHasUnicodeWord","hasUnicodeWord","rsAstralRange","rsDingbatRange","rsLowerRange","rsMathOpRange","rsNonCharRange","rsPunctuationRange","rsSpaceRange","rsUpperRange","rsVarRange","rsBreakRange","rsApos","rsBreak","rsDigits","rsDingbat","rsLower","rsMisc","rsFitz","rsModifier","rsNonAstral","rsRegional","rsSurrPair","rsUpper","rsZWJ","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsOptVar","rsOptJoin","rsOrdLower","rsOrdUpper","rsSeq","rsEmoji","reUnicodeWord","unicodeWords","words","pattern","guard","reApos","createCompounder","callback","baseClamp","number","lower","upper","clamp","toNumber","FUNC_ERROR_TEXT","baseDelay","func","wait","args","delay","baseRest","baseMap","collection","result","isArrayLike","baseEach","value","map","isArray","arrayMap","baseIteratee","INFINITY","flatMapDeep","baseFlatten","isEqual","other","baseIsEqual","kebabCase","word","baseSome","predicate","some","arraySome","isIterateeCall","Component","model","services","configs","RenderTypes","chartprefix","getProperty","select","animate","newObj","parent","oldParent","_a","carbonPrefix","idSelector","container","DOMUtils","chartClipId","chartClipRectSelection","merge","entries","setPrototypeOf","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","freeze","seal","create","apply","construct","x","fun","thisValue","Func","arrayForEach","unapply","arrayPop","arrayPush","stringToLowerCase","stringToString","stringMatch","stringReplace","stringIndexOf","stringTrim","objectHasOwnProperty","regExpTest","typeErrorCreate","unconstruct","thisArg","_len","_key","_len2","_key2","addToSet","set","transformCaseFunc","l","element","lcElement","cleanArray","clone","newObject","property","lookupGetter","prop","desc","fallbackValue","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","text","html","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","CUSTOM_ELEMENT","EXPRESSIONS","getGlobal","_createTrustedTypesPolicy","trustedTypes","purifyHostElement","suffix","ATTR_NAME","policyName","scriptUrl","createDOMPurify","window","DOMPurify","root","document","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","NamedNodeMap","HTMLFormElement","DOMParser","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","trustedTypesPolicy","emptyHTML","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","SAFE_FOR_XML","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","SANITIZE_NAMED_PROPS_PREFIX","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","DEFAULT_PARSER_MEDIA_TYPE","CONFIG","formElement","isRegexOrFunction","testValue","_parseConfig","cfg","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","ALL_SVG_TAGS","ALL_MATHML_TAGS","_checkValidNamespace","tagName","parentTagName","_forceRemove","node","_removeAttribute","name","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","body","_createNodeIterator","_isClobbered","elm","_isNode","_executeHook","entryPoint","currentNode","data","hook","_sanitizeElements","content","_isBasicCustomElement","parentNode","childNodes","childCount","i","expr","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","attributes","hookEvent","attr","namespaceURI","attrValue","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","importedNode","returnNode","nodeIterator","serializedHTML","tag","hookFunction","purify","sanitizeHtml","sanitizeSVG","svgContent","sanitizeText","_Toolbar","bodyOnClickHandler","Events","buttonList","overflowMenuItemList","toolbarControls","button","enteringToolbarControls","self","d","event","hoveredElement","overflowMenuControls","enteringOverflowMenuControls","show","currentItemIndex","previousItemIndex","previousItemNode","nextItemIndex","nextItemNode","overflowMenuItems","menuItem","keyEvent","control","numberOfIcons","controls","overflowSpecificControls","overflowList","controlConfig","ToolbarControlTypes","isFullScreenMode","moreOptions","controlType","isZoomBarEnabled","displayData","options","exportAsCSV","exportAsJPG","exportAsPNG","zoomIn","zoomOut","resetZoom","makeFullScreen","exitFullScreen","showAsTable","Toolbar","_LayoutComponent","children","child","component","sum","growth","LayoutGrowth","width","height","horizontal","LayoutDirection","updatedBoxes","LayoutAlignItems","itemComponent","selection","isRenderingSVG","matchingElementDimensions","matchingElementWidth","elementWidth","allUpdatedBoxes","LayoutComponent","Spacer","spacerConfigs","settings","settings_1","_defineProperties","target","props","descriptor","_createClass","Constructor","protoProps","staticProps","_classCallCheck","instance","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","minLen","_arrayLikeToArray","n","iter","len","arr2","flatten","a","item","mixin","mixinfns","Class","mixinfn","_class","_typeof","obj","_inherits","subClass","superClass","_setPrototypeOf","p","o","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","Super","_getPrototypeOf","NewTarget","_possibleConstructorReturn","call","_assertThisInitialized","createComponent","ToMix","CreateComponent","_ToMix","_super","_this","_get","receiver","base","_superPropBase","handles","Handles","handle","_this2","on","eventedState","EventedState","state","detail","eventNameSuffix","eventStart","fireOnNode","canceled","error","changeStateArgs","eventMatches","selector","currentTarget","closest","getLaunchingDetails","evt","launchingElement","launchingEvent","eventedShowHideState","EventedShowHideState","evtOrElem","exports","eventedShowHideState$1","warning","condition","format","argIndex","message","browser","initComponentByLauncher","InitComponentByLauncher","effectiveOptions","launcher","elements","Modal","_mixin","focusWrapNode","handleTransitionEnd","transitionEnd","focusableItem","hasFocusin","focusinEventName","_this3","closeButton","prefix","id","CarbonModalComponent","title","downloadAsCSV","tableArray","get","heading","row","column","holder","Title","maxWidth","untruncatedTitle","tspanLength","titleString","substringIndex","start","end","mid","Legend","legendOptions","alignment","legendOrientation","dataGroups","DISABLED","legendConfigs","hasDeactivatedItems","dataGroup","userProvidedOrder","Alignments","Roles","legendItems","addedLegendItems","legendClickable","checkboxRadius","addedCheckboxes","allCheckboxes","_","status","ColorClassNameTypes","additionalItemsOption","additionalItems","addedAdditionalItems","previousType","indexOfItem","additionalItem","legendOrder","dataA","dataB","definedOrderIndex","itemConfig","LegendItemType","iconData","fill","stroke","lineConfig","color","zoomEnter","truncationOptions","truncationType","truncationThreshold","truncationNumCharacter","addedLegendItemsText","TruncationTypes","_sanitizedLabel","truncateLabel","truncation","hoveredItem","hoveredItemData","clickedItemData","ChartClip","cartesianScales","mainXScale","mainYScale","xScaleStart","xScaleEnd","yScaleEnd","yScaleStart","clipRect","CanvasChartClip","PLACEMENTS","defaultPositions","referenceOffset","referenceRect","windowRef","Position","positions","offsets","margins","computed","targetRect","relativeRect","reference","placement","offsetFunction","offset","position","targetBottom","targetRight","top","left","placements","containerFunction","positionFunction","weightedPlacements","pos","box","hiddenHeight","hiddenWidth","area","hiddenArea","visibleArea","visiblePercent","b","positionAt","Tooltip","e","defaultHTML","formattedItems","tooltipTextContainer","labelHTML","items","labelIconSize","label","valueFormatter","localeCode","numberFormatter","dateFormatter","newDate","isTooltipEnabled","newOffset","holderWidth","holderHeight","isTopZoomBarEnabled","noWrap","hasCustomPlacements","bestPlacementOption","horizontalOffset","defaultOffset","tooltipConfigs","hoveredPos","bestPos","mouseRelativePos","pointer","zoombarType","zoombarHeight","zoomBarConfigs","_ChartBrush","frontSelectionArea","backdrop","brushArea","d3Selection","mainXScaleType","frontSelection","ScaleTypes","zoomDomain","updateSelectionDash","selectionWidth","dashArray","dashCount","totalRightDash","brushEventHandler","updateZoomDomain","startPoint","endPoint","xScale","scaleTime","newDomain","brush","brushed","brushX","zoomRatio","clickedX","leftPoint","rightPoint","ChartBrush","ZoomBar","definedZoomBarData","AxisPositions","isTopZoomBarLoading","isTopZoomBarLocked","highlight","axesLeftMargin","axesMargins","ZoomBarTypes","zoomBarData","isEmpty","defaultDomain","oldInitialZoomDomain","newInitialZoomDomain","extent","startHighlight","endHighlight","labelMapTo","selected","domain","brushEventListener","scale","zoomBarEventType","handleWidth","handleHeight","handleXDiff","handleBarWidth","handleBarHeight","handleBarXDiff","handleYBarDiff","handleBars","querySelector","clipId","mainXAxisPosition","mainYAxisPosition","mainYScaleType","accessorFunction","scaleType","axisPosition","xAccessor","yAccessor","areaGenerator","areaGraph","y","zoomBarClipPath","cloneDeep","domainIdentifier","rangeIdentifier","newDatum","startX","endX","skeletonClass","baselineGenerator","line","Threshold","axesOptions","thresholdData","axisOptions","thresholdAxisGroups","thresholdAxisGroupsMerge","thresholdGroups","threshold","thresholdGroupsEnter","yScale","isScaleTypeLabels","orientation","getDomainValue","getRangeValue","getXValue","getYValue","flipDomainAndRangeBasedOnOrientation","group","t","datum","fillColor","isVertical","timeScaleOptions","timeInterval","computeTimeIntervalName","formatTick","formattedValue","Highlight","highlightData","highlightAxisGroups","highlightAxisGroupsMerge","highlightGroups","highlightGroupsEnter","highlightStartMapsTo","highlightEndMapsTo","labelMapsTo","AxisChartsTooltip","dualAxes","groupMapsTo","domainLabel","rangeLabel","domainValue","Alluvial","isGradientAllowed","nodePadding","alluvialConfigs","nodeAlignment","sankeyJustify","sankeyLeft","sankeyRight","sankey","d3Sankey","nodeCoordinates","point","elementID","textWidth","links","gradient","sankeyLinkHorizontal","textNode","debouncedLineHighlight","debounce","link","allLinks","strokeColor","paths","nodeMatrix","getTransformOffsets","titleContainer","titleMatrix","direction","visited","Grid","isXGridEnabled","isYGridEnabled","xGrid","axisBottom","mainXPosition","customDomain","numberOfTicks","g","yGrid","axisLeft","mainYPosition","mousePos","gridlinesX","getTranslationValues","floor","ceiling","line1","line2","lineSpacing","gridElement","userSpecifiedThreshold","translations","bounds","backdropRect","Area","areaConfigs","eventsFragment","groupedData","boundsEnabled","upperBoundRangeValue","includeZeroInRangeValue","_domain","upperBound","lowerBound","CartesianOrientations","isGradientEnabled","areas","chartMainContainer","strokePathElement","colorValue","sparklineColorObject","sparklineColorObjectKeys","GradientUtils","enteringAreas","Line","lineConfigs","events","curves","lineGenerator","percentage","axis","lines","groupData","THRESHOLD","pointIsWithinThreshold","dx","Ruler","isRulerEnabled","tooltipData","rangeScale","mouseCoordinate","ruler","rulerLine","dataPointElements","pointsWithinLine","dataPointsMatchingRulerLine","accum","currentValue","sampleAccumValue","distanceToCurrentValue","distanceToAccumValue","domainValuesMatchingRulerLine","elementsToHighlight","sampleMatch","mouseMoveCallback","debounceThreshold","debounceWithD3MousePosition","mousePosition","Scatter","fadeInOnChartHolderMouseover","stacked","scatterData","circles","circlesToStyle","handleThresholds","xThreshold","yThreshold","xValue","yValue","filled","fillOpacity","classNamesNeeded","_b","isFilled","_c","Axis","isAxisVisible","startPosition","endPosition","axisFunction","axisRight","axisTop","axisRefExists","axisRef","invisibleAxisRef","isTimeScaleType","isVerticalAxis","axisScaleType","isDataLoading","numberOfTicksProvided","userProvidedTickValues","isNumberOfTicksProvided","fakeTick","fakeTickText","tickHeight","axisConfigs","addSpaceOnEdges","tempScale","tickValues","formatter","userProvidedFormatter","defaultFormattedValue","validTicks","userProvidedTickValue","tick","tickTimestamp","discreteDomain","isDataEmpty","axisTitleRef","titleOrientation","titleHeight","AxisTitleOrientations","showDayName","axisRefSelection","isTickPrimary","shouldRotateTicks","tickRotation","TickRotations","mockTextPiece","averageLetterWidth","lastStartPosition","xTransformation","axisTickLabels","tick_html","size","tickSize","spaceRatio","numberOfTicksFit","HoverAxis","rectangle","coordinates","boundingRect","TwoDimensionalAxes","axes","axisPositions","axisPositionKey","axisComponent","AxisFlavor","childKey","marginKey","Skeleton","showShimmerEffect","Skeletons","outerRadius","innerRadius","xRange","yRange","scaleLinear","ticksNumber","ticksValues","xGridG","update","yGridG","shimmer","optionName","arcPathGenerator","arc","tcx","pieConfigs","tcy","skeletonAreaShape","translateX","translateY","gradientId","stopBgShimmerClass","stopShimmerClass","defs","linearGradient","stops","repeat","easeLinear","Boxplot","dataGroupNames","isInVerticalOrientation","gridSize","boxWidth","boxplotData","boxGroups","boxGroupsEnter","allBoxGroups","boxplotConfigs","x0","x1","y0","y1","generateSVGPathString","outlier","circlesEnter","ZeroLine","minDomainValue","maxDomainValue","drawZeroLine","yPosition","lineCoordinates","flipSVGCoordinatesBasedOnOrientation","Bubble","radiusMapsTo","allRadii","radius","chartSize","radiusDataIsValid","radiusScale","bubbleOptions","Bullet","rangeScaleStart","rangeScaleEnd","rangeScaleDomainMax","renderRangeBoxes","rangeBoxData","range","rangeBoxes","renderBars","bars","renderTargetLines","renderTargetQuartiles","quartilesData","barValue","lineHeight","performanceAreaTitles","matchingRangeIndex","identity","transform","kx","ky","dy","input","j","output","reverse","feature","topology","bbox","properties","geometry","transformPoint","arcs","points","k","ring","polygon","type","stitch","stitchedArcs","fragmentByStart","fragmentByEnd","fragments","emptyIndex","ends","f","fg","gf","p0","p1","dp","flush","planarRingArea","mergeArcs","objects","polygonsByArc","polygons","groups","extract","neighbors","ki","BinnedRuler","domainScale","correspondingDomainValue","sampleMatchData","activeDataGroupNames","tooltipDataGroups","dataGroupName","rulerPosition","StackedRuler","buildStraightPathString","source","sx","sy","tx","ty","path","d3Path","buildElbowPathString","percent","buildBezierPathString","cpx1","cpy1","cpx2","cpy2","arrowLeft","arrowRight","circle","diamond","square","tee","ColorScaleLegend","xDimensions","availableSpace","customColors","colorScaleType","colorPairingOption","customColorsEnabled","getDomain","useDefaultBarWidth","barWidth","legendGroupElement","axisElement","legendTitleGroup","colorScheme","colorPairing","colorGroupingLength","ColorLegendType","interpolator","interpolateNumber","quant","quantize","linearScale","legendAxis","rangeStart","stopLengthPercentage","colorScaleBand","scaleBand","MeterTitle","dataset","meterTitle","titleElement","datasetsTotal","total","unit","difference","breakdownFormatter","totalValue","totalFormatter","totalString","containerWidth","meterConfigs","statusGroup","icon","innerIcon","dataValue","tspan","proportional","totalWidth","percentageWidth","statusWidth","Statuses","Bar","numberOfDatapoints","chartWidth","spacingFactor","CirclePack","circlePackConfigs","hierarchyLevel","canvasZoomEnabled","d3Hierarchy","nodeData","D3Pack","enteringCircles","originalClass","canvasZoomSettings","childData","chartSvg","canvasSelection","disabled","zoomable","childrenData","parentValue","arcTween","arcFunc","interpolate","Pie","valueMapsTo","pieLayoutData","pie","convertValueToPercentage","renderLabels","labelData","labels","enteringLabels","calloutData","marginedRadius","theta","deg","textLength","totalSlices","sliceAngleDeg","labelTranslateX","labelTranslateY","CalloutDirections","xOffset","yOffset","pieTranslateX","pieTranslateY","callouts","enteringCallouts","xPosition","Donut","donutTitle","d3Ref","donutCenterFigure","interpolateFunction","interpolateRound","localeNumberFormatter","ARROW_UP_PATH_STRING","ARROW_DOWN_PATH_STRING","Gauge","GaugeTypes","arcSize","delta","ArrowDirections","valueRatio","startAngle","rotationAngle","currentAngle","endAngle","arcValue","gaugeTranslateX","arcType","valueFontSize","deltaFontSize","numberSpacing","showPercentageSymbol","numbersYPosition","numbersGroup","fontSize","valueNumberGroup","valueNumber","valueNumberWidth","symbolFontSize","gaugeSymbol","symbol","symbolWidth","symbolHeight","arrowSize","deltaGroup","deltaNumber","deltaNumberWidth","arrowEnabled","deltaArrow","deltaArrowSelection","arcWidth","GroupedBar","allDataLabels","uniq","barGroups","allBarGroups","translateBy","rangeAxis","zoomx0","zoomx1","activeData","totalGroupPadding","step","ref","providedWidth","providedMaxWidth","numOfActiveDataGroups","Heatmap","ranges","domains","minimum","maximum","min","uniqueDomain","uniqueRange","matrixArray","patternID","rectangles","parentTag","xBandwidth","yBandwidth","dividerStatus","DividerStatus","heatmapConfigs","totalLabel","cell","nullState","Histogram","groupIdentifier","binnedStackedData","bin","rangeAxisPosition","rangeScaleLabel","Lollipop","allLines","Meter","prevX","domainMax","stackedData","userProvidedHeight","valued","className","peakValue","peakData","peak","Radar","tmpTick","tmpTickText","angle","completeBlankData","radarConfigs","xLabelPadding","yLabelPadding","yTicksNumber","minRange","xAxisRectHeight","margin","centerPointMinValue","max","yTicks","colorScale","radialLineGenerator","lineRadial","curveLinearClosed","horizSpaceNeededByEachXLabel","tickWidth","distanceFromDiameter","distanceBetweenPointOnCircAndVerticalDiameter","c","yAxisUpdate","shapeData","enter","exit","polarToCartesianCoords","radialLabelPlacement","alignmentXOffset","selectionUpdate","radToDeg","svgDimensions","alignmentOffset","axisLine","dots","itemsToHighlight","SimpleBar","yScaleDomainStart","SkeletonLines","isSparkline","sparklineSkeleton","StackedArea","domainAxisPosition","StackedBar","stackData","barIsNegative","matchingDataPoint","numberOfDomainValues","StackedScatter","circleGroups","hoveredX","hoveredY","groupDataIndex","dataIndex","rangeValue","stackedRangeValue","datapoint","tooltipDatapoint","NODE_OFFSET","Tree","longestLabel","longestLabelInChildren","mockLabel","mockLabelWidth","rootTitle","mockRootTitleWidth","mockLongestLabelWidth","hierarchy","nodes","right","updateHeight","transition","nodeGroups","nodeGroup","nodeGroupsEnter","linkPaths","linkGroup","linkPathsEnter","diagonal","descendants","maxDepth","tree","TreeTypes","d3Cluster","d3Tree","linkHorizontal","black","white","yellow10","yellow20","yellow30","yellow40","yellow50","yellow60","yellow70","yellow80","yellow90","yellow100","yellow","orange10","orange20","orange30","orange40","orange50","orange60","orange70","orange80","orange90","orange100","orange","red10","red20","red30","red40","red50","red60","red70","red80","red90","red100","red","magenta10","magenta20","magenta30","magenta40","magenta50","magenta60","magenta70","magenta80","magenta90","magenta100","magenta","purple10","purple20","purple30","purple40","purple50","purple60","purple70","purple80","purple90","purple100","purple","blue10","blue20","blue30","blue40","blue50","blue60","blue70","blue80","blue90","blue100","blue","cyan10","cyan20","cyan30","cyan40","cyan50","cyan60","cyan70","cyan80","cyan90","cyan100","cyan","teal10","teal20","teal30","teal40","teal50","teal60","teal70","teal80","teal90","teal100","teal","green10","green20","green30","green40","green50","green60","green70","green80","green90","green100","green","coolGray10","coolGray20","coolGray30","coolGray40","coolGray50","coolGray60","coolGray70","coolGray80","coolGray90","coolGray100","coolGray","gray10","gray20","gray30","gray40","gray50","gray60","gray70","gray80","gray90","gray100","gray","warmGray10","warmGray20","warmGray30","warmGray40","warmGray50","warmGray60","warmGray70","warmGray80","warmGray90","warmGray100","warmGray","colors","findColorShade","hex","colorName","colorShades","colorShadeLevel","textFillColor","correspondingLeaf","correspondingLeafFill","cl","d3Color","colorShade","lightness","hsl","uidCounter","Treemap","windowLocation","d3Treemap","leafGroups","leaf","allLeafGroups","rects","uid","leafID","addedText","clipPathID","customColor","WordCloud","fontSizeScale","fontSizeMapsTo","wordMapsTo","layout","cloud","draw","textGroup","allText","allOccurences","sizeDataIsValid","debouncedHighlight","allWords","GeoProjection","projection","geoData","withData","withoutData","withoutDataMerge","json","projectionScale","geo","geoPath","missingBorders","Projection","geoEqualEarth","geoAlbers","geoConicEqualArea","geoConicEquidistant","geoEquirectangular","geoMercator","geoNaturalEarth1","Choropleth","Events.Choropleth","Events.Tooltip"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21,26,27,28,29,30,31,32,33,34,35,36,37,43,64,65,66,67,68,69,93]}